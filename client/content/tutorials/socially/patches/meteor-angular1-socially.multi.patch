From 522d88091b33497a47c969b7a82027dbdd9fffe6 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 09:15:57 +0200
Subject: [PATCH 001/204] Step 0.2: Remove project files

---
 client/main.css  |  1 -
 client/main.html | 25 -------------------------
 client/main.js   | 22 ----------------------
 server/main.js   |  5 -----
 4 files changed, 53 deletions(-)
 delete mode 100644 client/main.css
 delete mode 100644 client/main.html
 delete mode 100644 client/main.js
 delete mode 100644 server/main.js

diff --git a/client/main.css b/client/main.css
deleted file mode 100644
index b6b4052..0000000
--- a/client/main.css
+++ /dev/null
@@ -1 +0,0 @@
-/* CSS declarations go here */
diff --git a/client/main.html b/client/main.html
deleted file mode 100644
index 203539b..0000000
--- a/client/main.html
+++ /dev/null
@@ -1,25 +0,0 @@
-<head>
-  <title>simple</title>
-</head>
-
-<body>
-  <h1>Welcome to Meteor!</h1>
-
-  {{> hello}}
-  {{> info}}
-</body>
-
-<template name="hello">
-  <button>Click Me</button>
-  <p>You've pressed the button {{counter}} times.</p>
-</template>
-
-<template name="info">
-  <h2>Learn Meteor!</h2>
-  <ul>
-    <li><a href="https://www.meteor.com/try">Do the Tutorial</a></li>
-    <li><a href="http://guide.meteor.com">Follow the Guide</a></li>
-    <li><a href="https://docs.meteor.com">Read the Docs</a></li>
-    <li><a href="https://forums.meteor.com">Discussions</a></li>
-  </ul>
-</template>
\ No newline at end of file
diff --git a/client/main.js b/client/main.js
deleted file mode 100644
index ecb3282..0000000
--- a/client/main.js
+++ /dev/null
@@ -1,22 +0,0 @@
-import { Template } from 'meteor/templating';
-import { ReactiveVar } from 'meteor/reactive-var';
-
-import './main.html';
-
-Template.hello.onCreated(function helloOnCreated() {
-  // counter starts at 0
-  this.counter = new ReactiveVar(0);
-});
-
-Template.hello.helpers({
-  counter() {
-    return Template.instance().counter.get();
-  },
-});
-
-Template.hello.events({
-  'click button'(event, instance) {
-    // increment the counter when button is clicked
-    instance.counter.set(instance.counter.get() + 1);
-  },
-});
diff --git a/server/main.js b/server/main.js
deleted file mode 100644
index 31a9e0e..0000000
--- a/server/main.js
+++ /dev/null
@@ -1,5 +0,0 @@
-import { Meteor } from 'meteor/meteor';
-
-Meteor.startup(() => {
-  // code to run on server at startup
-});
-- 
2.5.0


From 86ef8ff6f30975248cea9137d2081f2b12294f0d Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 09:29:56 +0200
Subject: [PATCH 002/204] Step 0.3: Create an empty html file

---
 client/index.html | 3 +++
 1 file changed, 3 insertions(+)
 create mode 100644 client/index.html

diff --git a/client/index.html b/client/index.html
new file mode 100644
index 0000000..ef412ef
--- /dev/null
+++ b/client/index.html
@@ -0,0 +1,3 @@
+<body>
+  <p>Nothing here</p>
+</body>
-- 
2.5.0


From 164fc5da12c5761b8bd926e4637ba012f73fd6ec Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 09:33:17 +0200
Subject: [PATCH 003/204] Step 0.4: Remove `blaze-html-templates` and
 `ecmascript`

---
 .meteor/packages | 2 --
 .meteor/versions | 5 -----
 2 files changed, 7 deletions(-)

diff --git a/.meteor/packages b/.meteor/packages
index d4c8001..c370be2 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -7,7 +7,6 @@
 meteor-base             # Packages every Meteor app needs to have
 mobile-experience       # Packages for a great mobile UX
 mongo                   # The database Meteor supports right now
-blaze-html-templates    # Compile .html files into Meteor Blaze views
 reactive-var            # Reactive variable for tracker
 jquery                  # Helpful client-side library
 tracker                 # Meteor's client-side reactive programming library
@@ -15,7 +14,6 @@ tracker                 # Meteor's client-side reactive programming library
 standard-minifier-css   # CSS minifier run for production mode
 standard-minifier-js    # JS minifier run for production mode
 es5-shim                # ECMAScript 5 compatibility for older browsers.
-ecmascript              # Enable ECMAScript2015+ syntax in app code
 
 autopublish             # Publish all data to the clients (for prototyping)
 insecure                # Allow all DB writes from clients (for prototyping)
diff --git a/.meteor/versions b/.meteor/versions
index 1430419..a6fa57c 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -6,11 +6,8 @@ babel-runtime@0.1.6
 base64@1.0.6
 binary-heap@1.0.6
 blaze@2.1.5
-blaze-html-templates@1.0.2
 blaze-tools@1.0.6
 boilerplate-generator@1.0.6
-caching-compiler@1.0.2
-caching-html-compiler@1.0.4
 callback-hook@1.0.6
 check@1.1.2
 ddp@1.2.3
@@ -59,8 +56,6 @@ spacebars@1.0.9
 spacebars-compiler@1.0.9
 standard-minifier-css@1.0.4
 standard-minifier-js@1.0.4
-templating@1.1.7
-templating-tools@1.0.2
 tracker@1.0.11
 ui@1.0.9
 underscore@1.0.6
-- 
2.5.0


From 009498f9b0399871c2a32e653ac80eb32085a310 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 09:35:22 +0200
Subject: [PATCH 004/204] Step 0.5: Add `angular-templates` and
 `pbastowski:angular-babel`

---
 .meteor/packages | 2 ++
 .meteor/versions | 5 +++++
 2 files changed, 7 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index c370be2..d74ee49 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -17,3 +17,5 @@ es5-shim                # ECMAScript 5 compatibility for older browsers.
 
 autopublish             # Publish all data to the clients (for prototyping)
 insecure                # Allow all DB writes from clients (for prototyping)
+pbastowski:angular-babel
+angular-templates
diff --git a/.meteor/versions b/.meteor/versions
index a6fa57c..a82d518 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -1,4 +1,5 @@
 allow-deny@1.0.2
+angular-templates@1.0.2
 autopublish@1.0.5
 autoupdate@1.2.6
 babel-compiler@6.5.2
@@ -8,6 +9,8 @@ binary-heap@1.0.6
 blaze@2.1.5
 blaze-tools@1.0.6
 boilerplate-generator@1.0.6
+caching-compiler@1.0.2
+caching-html-compiler@1.0.4
 callback-hook@1.0.6
 check@1.1.2
 ddp@1.2.3
@@ -46,6 +49,7 @@ mongo-id@1.0.2
 npm-mongo@1.4.41
 observe-sequence@1.0.9
 ordered-dict@1.0.5
+pbastowski:angular-babel@1.3.2
 promise@0.6.5
 random@1.0.7
 reactive-var@1.0.7
@@ -56,6 +60,7 @@ spacebars@1.0.9
 spacebars-compiler@1.0.9
 standard-minifier-css@1.0.4
 standard-minifier-js@1.0.4
+templating-tools@1.0.2
 tracker@1.0.11
 ui@1.0.9
 underscore@1.0.6
-- 
2.5.0


From fbd4e547a064bd6c60fb1fad3b1d2ca73f5fe458 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 09:36:09 +0200
Subject: [PATCH 005/204] Step 0.6: Add `angular` and `angular-meteor`

---
 package.json | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/package.json b/package.json
index 196e6e1..1fdb919 100644
--- a/package.json
+++ b/package.json
@@ -5,6 +5,8 @@
     "start": "meteor run"
   },
   "dependencies": {
+    "angular": "^1.5.3",
+    "angular-meteor": "^1.3.9",
     "meteor-node-stubs": "~0.2.0"
   }
 }
-- 
2.5.0


From 7048c8aff2c0aa2b95a992c8ceb106085b7d8616 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 09:38:27 +0200
Subject: [PATCH 006/204] Step 0.7: Move the main content to a new file

---
 client/main.html | 1 +
 1 file changed, 1 insertion(+)
 create mode 100644 client/main.html

diff --git a/client/main.html b/client/main.html
new file mode 100644
index 0000000..79ed426
--- /dev/null
+++ b/client/main.html
@@ -0,0 +1 @@
+<p>Nothing here</p>
-- 
2.5.0


From 0da5aeaf919095c5b0bc7807ab4f9e44f360394b Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 09:39:02 +0200
Subject: [PATCH 007/204] Step 0.8: Add `ng-include` that loads the main.html
 file

---
 client/index.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/index.html b/client/index.html
index ef412ef..6378317 100644
--- a/client/index.html
+++ b/client/index.html
@@ -1,3 +1,3 @@
 <body>
-  <p>Nothing here</p>
+  <div ng-include src="'client/main.html'"></div>
 </body>
-- 
2.5.0


From 2a073bd32ddc7b2816a7783694dd00ff97f8db6a Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 09:41:54 +0200
Subject: [PATCH 008/204] Step 0.9: Add main.js with angular module

---
 client/main.js | 6 ++++++
 1 file changed, 6 insertions(+)
 create mode 100644 client/main.js

diff --git a/client/main.js b/client/main.js
new file mode 100644
index 0000000..558ad57
--- /dev/null
+++ b/client/main.js
@@ -0,0 +1,6 @@
+import angular from 'angular';
+import angularMeteor from 'angular-meteor';
+
+angular.module('socially', [
+  angularMeteor
+]);
-- 
2.5.0


From 1678de9ee518391815245514ac29cc82999c3d11 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 09:42:29 +0200
Subject: [PATCH 009/204] Step 0.10: Add usage of `ng-app` in our app

---
 client/index.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/index.html b/client/index.html
index 6378317..f6b9ac4 100644
--- a/client/index.html
+++ b/client/index.html
@@ -1,3 +1,3 @@
-<body>
+<body ng-app="socially">
   <div ng-include src="'client/main.html'"></div>
 </body>
-- 
2.5.0


From 49bd40bc8b62f0dd78e1d98443b5da9c2b79d222 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 09:47:16 +0200
Subject: [PATCH 010/204] Step 0.11: Add some AngularJS code !

---
 client/main.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/main.html b/client/main.html
index 79ed426..a9c8ddc 100644
--- a/client/main.html
+++ b/client/main.html
@@ -1 +1 @@
-<p>Nothing here</p>
+<p>Nothing here {{ 'yet' + '!' }}</p>
-- 
2.5.0


From 58311374e0e627dfb5a1f26b23f9fc7df7f927e8 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 09:48:04 +0200
Subject: [PATCH 011/204] Step 1.1: Add some static HTML the to main page

---
 client/main.html | 15 ++++++++++++++-
 1 file changed, 14 insertions(+), 1 deletion(-)

diff --git a/client/main.html b/client/main.html
index a9c8ddc..dd1ef68 100644
--- a/client/main.html
+++ b/client/main.html
@@ -1 +1,14 @@
-<p>Nothing here {{ 'yet' + '!' }}</p>
+<ul>
+  <li>
+    <span>Dubstep-Free Zone</span>
+    <p>
+      Can we please just for an evening not listen to dubstep.
+    </p>
+  </li>
+  <li>
+    <span>All dubstep all the time</span>
+    <p>
+      Get it on!
+    </p>
+  </li>
+</ul>
-- 
2.5.0


From 1286400ffcc593b3917ab6ddeda5cf0a08423b1f Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 09:49:31 +0200
Subject: [PATCH 012/204] Step 2.1: Use dynamic template instead of static

---
 client/main.html | 22 ++++++++--------------
 1 file changed, 8 insertions(+), 14 deletions(-)

diff --git a/client/main.html b/client/main.html
index dd1ef68..7f8c6d9 100644
--- a/client/main.html
+++ b/client/main.html
@@ -1,14 +1,8 @@
-<ul>
-  <li>
-    <span>Dubstep-Free Zone</span>
-    <p>
-      Can we please just for an evening not listen to dubstep.
-    </p>
-  </li>
-  <li>
-    <span>All dubstep all the time</span>
-    <p>
-      Get it on!
-    </p>
-  </li>
-</ul>
+<div ng-controller="PartiesListCtrl">
+  <ul>
+    <li ng-repeat="party in parties">
+      {{party.name}}
+      <p>{{party.description}}</p>
+    </li>
+  </ul>
+</div>
-- 
2.5.0


From 8f9d191d6fe362780d0dffd3ccfe1c18d4350029 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 09:50:30 +0200
Subject: [PATCH 013/204] Step 2.2: Add the parties controller

---
 client/main.js | 16 ++++++++++++++--
 1 file changed, 14 insertions(+), 2 deletions(-)

diff --git a/client/main.js b/client/main.js
index 558ad57..abc441c 100644
--- a/client/main.js
+++ b/client/main.js
@@ -2,5 +2,17 @@ import angular from 'angular';
 import angularMeteor from 'angular-meteor';
 
 angular.module('socially', [
-  angularMeteor
-]);
+    angularMeteor
+  ])
+  .controller('PartiesListCtrl', ['$scope', function($scope) {
+    $scope.parties = [{
+      'name': 'Dubstep-Free Zone',
+      'description': 'Can we please just for an evening not listen to dubstep.'
+    }, {
+      'name': 'All dubstep all the time',
+      'description': 'Get it on!'
+    }, {
+      'name': 'Savage lounging',
+      'description': 'Leisure suit required. And only fiercest manners.'
+    }];
+  }]);
-- 
2.5.0


From a43c6b874af1bb45b103f7c34451f260c8e32680 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 09:51:13 +0200
Subject: [PATCH 014/204] Step 2.3: Remove the DI manual decleration

---
 client/main.js | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

diff --git a/client/main.js b/client/main.js
index abc441c..feb14f8 100644
--- a/client/main.js
+++ b/client/main.js
@@ -4,7 +4,9 @@ import angularMeteor from 'angular-meteor';
 angular.module('socially', [
     angularMeteor
   ])
-  .controller('PartiesListCtrl', ['$scope', function($scope) {
+  .controller('PartiesListCtrl', function($scope) {
+    'ngInject';
+    
     $scope.parties = [{
       'name': 'Dubstep-Free Zone',
       'description': 'Can we please just for an evening not listen to dubstep.'
@@ -15,4 +17,4 @@ angular.module('socially', [
       'name': 'Savage lounging',
       'description': 'Leisure suit required. And only fiercest manners.'
     }];
-  }]);
+  });
-- 
2.5.0


From 1a83444bdbde2027d9c8df188aca5c89aba6f8cb Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 09:51:56 +0200
Subject: [PATCH 015/204] Step 2.4: Add ng-strict-di directive to the app

---
 client/index.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/index.html b/client/index.html
index f6b9ac4..48c2d09 100644
--- a/client/index.html
+++ b/client/index.html
@@ -1,3 +1,3 @@
-<body ng-app="socially">
+<body ng-app="socially" ng-strict-di="">
   <div ng-include src="'client/main.html'"></div>
 </body>
-- 
2.5.0


From ed017d02fd1be6074192b57587114239e6556dae Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 09:56:08 +0200
Subject: [PATCH 016/204] Step 3.1: Add the parties collection

---
 collections/parties.js | 1 +
 1 file changed, 1 insertion(+)
 create mode 100644 collections/parties.js

diff --git a/collections/parties.js b/collections/parties.js
new file mode 100644
index 0000000..f78fa2c
--- /dev/null
+++ b/collections/parties.js
@@ -0,0 +1 @@
+Parties = new Mongo.Collection('parties');
-- 
2.5.0


From fceaa387c3d27c92b06fa0fccbe9b231a0f50d38 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 09:56:46 +0200
Subject: [PATCH 017/204] Step 3.2: Add the parties collection helper

---
 client/main.js | 17 ++++++-----------
 1 file changed, 6 insertions(+), 11 deletions(-)

diff --git a/client/main.js b/client/main.js
index feb14f8..1b17ade 100644
--- a/client/main.js
+++ b/client/main.js
@@ -6,15 +6,10 @@ angular.module('socially', [
   ])
   .controller('PartiesListCtrl', function($scope) {
     'ngInject';
-    
-    $scope.parties = [{
-      'name': 'Dubstep-Free Zone',
-      'description': 'Can we please just for an evening not listen to dubstep.'
-    }, {
-      'name': 'All dubstep all the time',
-      'description': 'Get it on!'
-    }, {
-      'name': 'Savage lounging',
-      'description': 'Leisure suit required. And only fiercest manners.'
-    }];
+
+    $scope.helpers({
+      parties() {
+        return Parties.find({});
+      }
+    });
   });
-- 
2.5.0


From 42404fd5dd02a88ccbdce6a2359d14e5064f762c Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 10:00:24 +0200
Subject: [PATCH 018/204] Step 3.3: Add some data to the parties collection

---
 server/startup.js | 18 ++++++++++++++++++
 1 file changed, 18 insertions(+)
 create mode 100644 server/startup.js

diff --git a/server/startup.js b/server/startup.js
new file mode 100644
index 0000000..ad3fd85
--- /dev/null
+++ b/server/startup.js
@@ -0,0 +1,18 @@
+Meteor.startup(() => {
+  if (Parties.find().count() === 0) {
+    const parties = [{
+      'name': 'Dubstep-Free Zone',
+      'description': 'Fast just got faster with Nexus S.'
+    }, {
+      'name': 'All dubstep all the time',
+      'description': 'Get it on!'
+    }, {
+      'name': 'Savage lounging',
+      'description': 'Leisure suit required. And only fiercest manners.'
+    }];
+
+    parties.forEach((party) => {
+      Parties.insert(party)
+    });
+  }
+});
-- 
2.5.0


From 429122579f023951369f214957496fa2104276b6 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 10:00:58 +0200
Subject: [PATCH 019/204] Step 3.4: Change to use controllerAs syntax

---
 client/main.html | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/client/main.html b/client/main.html
index 7f8c6d9..62eca58 100644
--- a/client/main.html
+++ b/client/main.html
@@ -1,6 +1,6 @@
-<div ng-controller="PartiesListCtrl">
+<div ng-controller="PartiesListCtrl as vm">
   <ul>
-    <li ng-repeat="party in parties">
+    <li ng-repeat="party in vm.parties">
       {{party.name}}
       <p>{{party.description}}</p>
     </li>
-- 
2.5.0


From 499f28cac9a85b53777acd4c1ae78bf33bd66155 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 10:07:22 +0200
Subject: [PATCH 020/204] Step 3.5: Change the parties controller to use
 $reactive and `this` instead of `$scope`

---
 client/main.js | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

diff --git a/client/main.js b/client/main.js
index 1b17ade..58efe3e 100644
--- a/client/main.js
+++ b/client/main.js
@@ -4,10 +4,12 @@ import angularMeteor from 'angular-meteor';
 angular.module('socially', [
     angularMeteor
   ])
-  .controller('PartiesListCtrl', function($scope) {
+  .controller('PartiesListCtrl', function($scope, $reactive) {
     'ngInject';
 
-    $scope.helpers({
+    $reactive(this).attach($scope);
+
+    this.helpers({
       parties() {
         return Parties.find({});
       }
-- 
2.5.0


From ac3a1ed3c1728bb8a3de255f36f7b88d1cd592e1 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 10:12:43 +0200
Subject: [PATCH 021/204] Step 3.6: Refactor PartiesListCtrl to be a component

---
 client/main.js | 20 ++++++++++++--------
 1 file changed, 12 insertions(+), 8 deletions(-)

diff --git a/client/main.js b/client/main.js
index 58efe3e..a898321 100644
--- a/client/main.js
+++ b/client/main.js
@@ -4,14 +4,18 @@ import angularMeteor from 'angular-meteor';
 angular.module('socially', [
     angularMeteor
   ])
-  .controller('PartiesListCtrl', function($scope, $reactive) {
-    'ngInject';
+  .component('partiesList', {
+    templateUrl: 'client/partiesList.html',
+    controllerAs: 'partiesList',
+    controller($scope, $reactive) {
+      'ngInject';
 
-    $reactive(this).attach($scope);
+      $reactive(this).attach($scope);
 
-    this.helpers({
-      parties() {
-        return Parties.find({});
-      }
-    });
+      this.helpers({
+        parties() {
+          return Parties.find({});
+        }
+      });
+    }
   });
-- 
2.5.0


From 2f71142a0c0afd4b756b037cb6601146f8b7b87c Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 10:13:37 +0200
Subject: [PATCH 022/204] Step 3.7: Change usage from controllerAs to
 components code-style - view

---
 client/index.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/index.html b/client/index.html
index 48c2d09..84f0ef3 100644
--- a/client/index.html
+++ b/client/index.html
@@ -1,3 +1,3 @@
 <body ng-app="socially" ng-strict-di="">
-  <div ng-include src="'client/main.html'"></div>
+  <parties-list></parties-list>
 </body>
-- 
2.5.0


From c408870c63055ed706f4a497bf52ada32f158bba Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 10:14:22 +0200
Subject: [PATCH 023/204] Step 3.8: Move the parties list to a different HTML
 file

---
 client/partiesList.html | 6 ++++++
 1 file changed, 6 insertions(+)
 create mode 100644 client/partiesList.html

diff --git a/client/partiesList.html b/client/partiesList.html
new file mode 100644
index 0000000..64ac441
--- /dev/null
+++ b/client/partiesList.html
@@ -0,0 +1,6 @@
+<ul>
+  <li ng-repeat="party in partiesList.parties">
+    {{party.name}}
+    <p>{{party.description}}</p>
+  </li>
+</ul>
-- 
2.5.0


From 81f509602e38b2ce46a03c04710f8668625f2892 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 10:25:52 +0200
Subject: [PATCH 024/204] Step 3.9: Move PartiesList to imports

---
 imports/ui/components/partiesList/partiesList.js | 27 ++++++++++++++++++++++++
 1 file changed, 27 insertions(+)
 create mode 100644 imports/ui/components/partiesList/partiesList.js

diff --git a/imports/ui/components/partiesList/partiesList.js b/imports/ui/components/partiesList/partiesList.js
new file mode 100644
index 0000000..a5a8a27
--- /dev/null
+++ b/imports/ui/components/partiesList/partiesList.js
@@ -0,0 +1,27 @@
+import angular from 'angular';
+import angularMeteor from 'angular-meteor';
+
+class PartiesList {
+  constructor($scope, $reactive) {
+    'ngInject';
+
+    $reactive(this).attach($scope);
+
+    this.helpers({
+      parties() {
+        return Parties.find({});
+      }
+    });
+  }
+}
+
+const name = 'partiesList';
+
+// create a module
+export default angular.module(name, [
+  angularMeteor
+]).component(name, {
+  templateUrl: `imports/ui/components/${name}/${name}.html`,
+  controllerAs: name,
+  controller: PartiesList
+});
-- 
2.5.0


From f8f948a31ed6235591891a69e309a0df434a53dc Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 10:26:25 +0200
Subject: [PATCH 025/204] Step 3.10: Move PartiesList view to imports

---
 imports/ui/components/partiesList/partiesList.html | 6 ++++++
 1 file changed, 6 insertions(+)
 create mode 100644 imports/ui/components/partiesList/partiesList.html

diff --git a/imports/ui/components/partiesList/partiesList.html b/imports/ui/components/partiesList/partiesList.html
new file mode 100644
index 0000000..64ac441
--- /dev/null
+++ b/imports/ui/components/partiesList/partiesList.html
@@ -0,0 +1,6 @@
+<ul>
+  <li ng-repeat="party in partiesList.parties">
+    {{party.name}}
+    <p>{{party.description}}</p>
+  </li>
+</ul>
-- 
2.5.0


From 216ad8296b6e8e23e8681f7f5c4107b523d2afdd Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 10:27:59 +0200
Subject: [PATCH 026/204] Step 3.11: Use PartiesList from imports

---
 client/main.js | 22 +++++-----------------
 1 file changed, 5 insertions(+), 17 deletions(-)

diff --git a/client/main.js b/client/main.js
index a898321..d643c33 100644
--- a/client/main.js
+++ b/client/main.js
@@ -1,21 +1,9 @@
 import angular from 'angular';
 import angularMeteor from 'angular-meteor';
 
-angular.module('socially', [
-    angularMeteor
-  ])
-  .component('partiesList', {
-    templateUrl: 'client/partiesList.html',
-    controllerAs: 'partiesList',
-    controller($scope, $reactive) {
-      'ngInject';
-
-      $reactive(this).attach($scope);
+import { name as PartiesList } from '../imports/ui/components/partiesList/partiesList';
 
-      this.helpers({
-        parties() {
-          return Parties.find({});
-        }
-      });
-    }
-  });
+angular.module('socially', [
+    angularMeteor,
+    PartiesList
+  ]);
-- 
2.5.0


From 38df50f3630cfb3e711062760526c3178cc4447c Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 10:28:46 +0200
Subject: [PATCH 027/204] Step 3.12: Remove old partiesList.html

---
 client/partiesList.html | 6 ------
 1 file changed, 6 deletions(-)
 delete mode 100644 client/partiesList.html

diff --git a/client/partiesList.html b/client/partiesList.html
deleted file mode 100644
index 64ac441..0000000
--- a/client/partiesList.html
+++ /dev/null
@@ -1,6 +0,0 @@
-<ul>
-  <li ng-repeat="party in partiesList.parties">
-    {{party.name}}
-    <p>{{party.description}}</p>
-  </li>
-</ul>
-- 
2.5.0


From a114cf88664fb61ceea57fad84699592ee58d950 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 10:29:23 +0200
Subject: [PATCH 028/204] Step 3.13: Remove unused main.html

---
 client/main.html | 8 --------
 1 file changed, 8 deletions(-)
 delete mode 100644 client/main.html

diff --git a/client/main.html b/client/main.html
deleted file mode 100644
index 62eca58..0000000
--- a/client/main.html
+++ /dev/null
@@ -1,8 +0,0 @@
-<div ng-controller="PartiesListCtrl as vm">
-  <ul>
-    <li ng-repeat="party in vm.parties">
-      {{party.name}}
-      <p>{{party.description}}</p>
-    </li>
-  </ul>
-</div>
-- 
2.5.0


From a6ccec247231761fa0c7d87b9f7bafcd60b73eb0 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 10:29:59 +0200
Subject: [PATCH 029/204] Step 3.14: Import template

---
 imports/ui/components/partiesList/partiesList.js | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/imports/ui/components/partiesList/partiesList.js b/imports/ui/components/partiesList/partiesList.js
index a5a8a27..2a87f91 100644
--- a/imports/ui/components/partiesList/partiesList.js
+++ b/imports/ui/components/partiesList/partiesList.js
@@ -1,6 +1,8 @@
 import angular from 'angular';
 import angularMeteor from 'angular-meteor';
 
+import './partiesList.html';
+
 class PartiesList {
   constructor($scope, $reactive) {
     'ngInject';
-- 
2.5.0


From 0e1b4db5c946c94b6b6c39a46d9e3b7515bfb550 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 10:31:27 +0200
Subject: [PATCH 030/204] Step 3.15: Create view for Socially component

---
 imports/ui/components/socially/socially.html | 1 +
 1 file changed, 1 insertion(+)
 create mode 100644 imports/ui/components/socially/socially.html

diff --git a/imports/ui/components/socially/socially.html b/imports/ui/components/socially/socially.html
new file mode 100644
index 0000000..5e9673b
--- /dev/null
+++ b/imports/ui/components/socially/socially.html
@@ -0,0 +1 @@
+<parties-list></parties-list>
-- 
2.5.0


From ca04f484e2d50a6fe65a7ae1232fe19673bddbd3 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 10:32:56 +0200
Subject: [PATCH 031/204] Step 3.16: Create Socially component

---
 imports/ui/components/socially/socially.js | 19 +++++++++++++++++++
 1 file changed, 19 insertions(+)
 create mode 100644 imports/ui/components/socially/socially.js

diff --git a/imports/ui/components/socially/socially.js b/imports/ui/components/socially/socially.js
new file mode 100644
index 0000000..e436684
--- /dev/null
+++ b/imports/ui/components/socially/socially.js
@@ -0,0 +1,19 @@
+import angular from 'angular';
+import angularMeteor from 'angular-meteor';
+
+import './socially.html';
+import { name as PartiesList } from '../partiesList/partiesList';
+
+class Socially {}
+
+const name = 'socially';
+
+// create a module
+export default angular.module(name, [
+  angularMeteor,
+  PartiesList
+]).component(name, {
+  templateUrl: `imports/ui/components/${name}/${name}.html`,
+  controllerAs: name,
+  controller: Socially
+});
-- 
2.5.0


From c67aa4bef37d2e9ad3942cfec32addc08f19e61e Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 10:33:26 +0200
Subject: [PATCH 032/204] Step 3.17: Replace parties-list with socially

---
 client/index.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/index.html b/client/index.html
index 84f0ef3..e6d21ea 100644
--- a/client/index.html
+++ b/client/index.html
@@ -1,3 +1,3 @@
 <body ng-app="socially" ng-strict-di="">
-  <parties-list></parties-list>
+  <socially></socially>
 </body>
-- 
2.5.0


From 1de40712624702a7155c785a686c37756584926f Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 10:34:53 +0200
Subject: [PATCH 033/204] Step 3.18: Import Socially in main.js

---
 client/main.js | 7 +------
 1 file changed, 1 insertion(+), 6 deletions(-)

diff --git a/client/main.js b/client/main.js
index d643c33..212f992 100644
--- a/client/main.js
+++ b/client/main.js
@@ -1,9 +1,4 @@
 import angular from 'angular';
 import angularMeteor from 'angular-meteor';
 
-import { name as PartiesList } from '../imports/ui/components/partiesList/partiesList';
-
-angular.module('socially', [
-    angularMeteor,
-    PartiesList
-  ]);
+import { name as Socially } from '../imports/ui/components/socially/socially';
-- 
2.5.0


From 635a3820a8a89274c3128039be15545815f5dd33 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 10:35:46 +0200
Subject: [PATCH 034/204] Step 4.1: Create template for PartyAdd component

---
 imports/ui/components/partyAdd/partyAdd.html | 11 +++++++++++
 1 file changed, 11 insertions(+)
 create mode 100644 imports/ui/components/partyAdd/partyAdd.html

diff --git a/imports/ui/components/partyAdd/partyAdd.html b/imports/ui/components/partyAdd/partyAdd.html
new file mode 100644
index 0000000..a61cf04
--- /dev/null
+++ b/imports/ui/components/partyAdd/partyAdd.html
@@ -0,0 +1,11 @@
+<form>
+  <label>
+    Party Name:
+  </label>
+  <input type="text"/>
+  <label>
+    Description:
+  </label>
+  <input type="text"/>
+  <button>Add Party!</button>
+</form>
-- 
2.5.0


From 0496d187f518daa7c5349e790f1fd8116d1c9850 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 10:36:39 +0200
Subject: [PATCH 035/204] Step 4.2: Create PartyAdd component

---
 imports/ui/components/partyAdd/partyAdd.js | 17 +++++++++++++++++
 1 file changed, 17 insertions(+)
 create mode 100644 imports/ui/components/partyAdd/partyAdd.js

diff --git a/imports/ui/components/partyAdd/partyAdd.js b/imports/ui/components/partyAdd/partyAdd.js
new file mode 100644
index 0000000..440dec8
--- /dev/null
+++ b/imports/ui/components/partyAdd/partyAdd.js
@@ -0,0 +1,17 @@
+import angular from 'angular';
+import angularMeteor from 'angular-meteor';
+
+import './partyAdd.html';
+
+class PartyAdd {}
+
+const name = 'partyAdd';
+
+// create a module
+export default angular.module(name, [
+  angularMeteor
+]).component(name, {
+  templateUrl: `imports/ui/components/${name}/${name}.html`,
+  controllerAs: name,
+  controller: PartyAdd
+});
-- 
2.5.0


From b89a25eee701638c68c6fbd806bf8785446b2ca0 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 10:37:19 +0200
Subject: [PATCH 036/204] Step 4.3: Implement PartyAdd to the view

---
 imports/ui/components/partiesList/partiesList.html | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/imports/ui/components/partiesList/partiesList.html b/imports/ui/components/partiesList/partiesList.html
index 64ac441..229908b 100644
--- a/imports/ui/components/partiesList/partiesList.html
+++ b/imports/ui/components/partiesList/partiesList.html
@@ -1,3 +1,5 @@
+<party-add></party-add>
+
 <ul>
   <li ng-repeat="party in partiesList.parties">
     {{party.name}}
-- 
2.5.0


From 2571c37a279e8be143984db3c91432433a31c1c1 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 10:42:22 +0200
Subject: [PATCH 037/204] Step 4.4: Add PartyAdd to PartiesList

---
 imports/ui/components/partiesList/partiesList.js | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/partiesList/partiesList.js b/imports/ui/components/partiesList/partiesList.js
index 2a87f91..e72d93e 100644
--- a/imports/ui/components/partiesList/partiesList.js
+++ b/imports/ui/components/partiesList/partiesList.js
@@ -2,6 +2,7 @@ import angular from 'angular';
 import angularMeteor from 'angular-meteor';
 
 import './partiesList.html';
+import { name as PartyAdd } from '../partyAdd/partyAdd';
 
 class PartiesList {
   constructor($scope, $reactive) {
@@ -21,7 +22,8 @@ const name = 'partiesList';
 
 // create a module
 export default angular.module(name, [
-  angularMeteor
+  angularMeteor,
+  PartyAdd
 ]).component(name, {
   templateUrl: `imports/ui/components/${name}/${name}.html`,
   controllerAs: name,
-- 
2.5.0


From f9520c9f6686e26a2794d078dcc877ae38fdbc81 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 10:43:11 +0200
Subject: [PATCH 038/204] Step 4.5: Add ng-model to the form inputs

---
 imports/ui/components/partyAdd/partyAdd.html | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/imports/ui/components/partyAdd/partyAdd.html b/imports/ui/components/partyAdd/partyAdd.html
index a61cf04..f035ecd 100644
--- a/imports/ui/components/partyAdd/partyAdd.html
+++ b/imports/ui/components/partyAdd/partyAdd.html
@@ -2,10 +2,10 @@
   <label>
     Party Name:
   </label>
-  <input type="text"/>
+  <input type="text" ng-model="partyAdd.party.name" />
   <label>
     Description:
   </label>
-  <input type="text"/>
+  <input type="text" ng-model="partyAdd.party.description" />
   <button>Add Party!</button>
 </form>
-- 
2.5.0


From 99dc0cffb984e13d55d3e2d41e7ca990b3a3b066 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 10:46:01 +0200
Subject: [PATCH 039/204] Step 4.6: Add submit method to the button

---
 imports/ui/components/partyAdd/partyAdd.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/imports/ui/components/partyAdd/partyAdd.html b/imports/ui/components/partyAdd/partyAdd.html
index f035ecd..3508bef 100644
--- a/imports/ui/components/partyAdd/partyAdd.html
+++ b/imports/ui/components/partyAdd/partyAdd.html
@@ -7,5 +7,5 @@
     Description:
   </label>
   <input type="text" ng-model="partyAdd.party.description" />
-  <button>Add Party!</button>
+  <button ng-click="partyAdd.submit()">Add Party!</button>
 </form>
-- 
2.5.0


From dfe9ed3c40e5306a5ee379262d21d5bef998230d Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 10:47:30 +0200
Subject: [PATCH 040/204] Step 4.7: Add submit method

---
 imports/ui/components/partyAdd/partyAdd.js | 10 +++++++++-
 1 file changed, 9 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/partyAdd/partyAdd.js b/imports/ui/components/partyAdd/partyAdd.js
index 440dec8..3ab5c47 100644
--- a/imports/ui/components/partyAdd/partyAdd.js
+++ b/imports/ui/components/partyAdd/partyAdd.js
@@ -3,7 +3,15 @@ import angularMeteor from 'angular-meteor';
 
 import './partyAdd.html';
 
-class PartyAdd {}
+class PartyAdd {
+  constructor() {
+    this.party = {};
+  }
+
+  submit() {
+    console.log('submit:', this.party);
+  }
+}
 
 const name = 'partyAdd';
 
-- 
2.5.0


From ac152aea0a00e197cc5afba74779fea20a846ad6 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 10:52:00 +0200
Subject: [PATCH 041/204] Step 4.8: Move Parties to imports

---
 imports/api/parties.js | 3 +++
 1 file changed, 3 insertions(+)
 create mode 100644 imports/api/parties.js

diff --git a/imports/api/parties.js b/imports/api/parties.js
new file mode 100644
index 0000000..e308632
--- /dev/null
+++ b/imports/api/parties.js
@@ -0,0 +1,3 @@
+import { Mongo } from 'meteor/mongo';
+
+export const Parties = new Mongo.Collection('parties');
-- 
2.5.0


From eed13254a3bd016ed692713d8b511dee220c2e89 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 10:52:33 +0200
Subject: [PATCH 042/204] Step 4.9: Remove old collection

---
 collections/parties.js | 1 -
 1 file changed, 1 deletion(-)
 delete mode 100644 collections/parties.js

diff --git a/collections/parties.js b/collections/parties.js
deleted file mode 100644
index f78fa2c..0000000
--- a/collections/parties.js
+++ /dev/null
@@ -1 +0,0 @@
-Parties = new Mongo.Collection('parties');
-- 
2.5.0


From 9e5a6f1a688c0c67af90de40dcf69e35e6e1fb1b Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 10:56:28 +0200
Subject: [PATCH 043/204] Step 4.10: Import new module with Parties collection

---
 server/startup.js | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/server/startup.js b/server/startup.js
index ad3fd85..6ce39cd 100644
--- a/server/startup.js
+++ b/server/startup.js
@@ -1,3 +1,6 @@
+import { Meteor } from 'meteor/meteor';
+import { Parties } from '../imports/api/parties';
+
 Meteor.startup(() => {
   if (Parties.find().count() === 0) {
     const parties = [{
-- 
2.5.0


From 554846d166b807ebb2d4a168490e53f804c19283 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 10:57:41 +0200
Subject: [PATCH 044/204] Step 4.11: Import new module with Parties to
 PartiesList

---
 imports/ui/components/partiesList/partiesList.js | 1 +
 1 file changed, 1 insertion(+)

diff --git a/imports/ui/components/partiesList/partiesList.js b/imports/ui/components/partiesList/partiesList.js
index e72d93e..eba585f 100644
--- a/imports/ui/components/partiesList/partiesList.js
+++ b/imports/ui/components/partiesList/partiesList.js
@@ -2,6 +2,7 @@ import angular from 'angular';
 import angularMeteor from 'angular-meteor';
 
 import './partiesList.html';
+import { Parties } from '../../../api/parties';
 import { name as PartyAdd } from '../partyAdd/partyAdd';
 
 class PartiesList {
-- 
2.5.0


From f087d2c2f9ec80330ff04584a81de536a709a131 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 11:00:20 +0200
Subject: [PATCH 045/204] Step 4.12: Insert new party

---
 imports/ui/components/partyAdd/partyAdd.js | 8 +++++++-
 1 file changed, 7 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/partyAdd/partyAdd.js b/imports/ui/components/partyAdd/partyAdd.js
index 3ab5c47..f51f219 100644
--- a/imports/ui/components/partyAdd/partyAdd.js
+++ b/imports/ui/components/partyAdd/partyAdd.js
@@ -2,6 +2,7 @@ import angular from 'angular';
 import angularMeteor from 'angular-meteor';
 
 import './partyAdd.html';
+import { Parties } from '../../../api/parties';
 
 class PartyAdd {
   constructor() {
@@ -9,7 +10,12 @@ class PartyAdd {
   }
 
   submit() {
-    console.log('submit:', this.party);
+    Parties.insert(this.party);
+    this.reset();
+  }
+
+  reset() {
+    this.party = {};
   }
 }
 
-- 
2.5.0


From 78f7954e2b22c28abcc72d03e4981c89dbb513de Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 11:01:18 +0200
Subject: [PATCH 046/204] Step 4.13: Create view for PartyRemove component

---
 imports/ui/components/partyRemove/partyRemove.html | 1 +
 1 file changed, 1 insertion(+)
 create mode 100644 imports/ui/components/partyRemove/partyRemove.html

diff --git a/imports/ui/components/partyRemove/partyRemove.html b/imports/ui/components/partyRemove/partyRemove.html
new file mode 100644
index 0000000..1295105
--- /dev/null
+++ b/imports/ui/components/partyRemove/partyRemove.html
@@ -0,0 +1 @@
+<button ng-click="partyRemove.remove()">X</button>
-- 
2.5.0


From 7896b96f4fe79243e162c144f6946ce298bc136c Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 11:04:08 +0200
Subject: [PATCH 047/204] Step 4.14: Create PartyRemove component

---
 imports/ui/components/partyRemove/partyRemove.js | 21 +++++++++++++++++++++
 1 file changed, 21 insertions(+)
 create mode 100644 imports/ui/components/partyRemove/partyRemove.js

diff --git a/imports/ui/components/partyRemove/partyRemove.js b/imports/ui/components/partyRemove/partyRemove.js
new file mode 100644
index 0000000..2689076
--- /dev/null
+++ b/imports/ui/components/partyRemove/partyRemove.js
@@ -0,0 +1,21 @@
+import angular from 'angular';
+import angularMeteor from 'angular-meteor';
+
+import './partyRemove.html';
+
+class PartyRemove {
+  remove() {
+    console.log('remove party');
+  }
+}
+
+const name = 'partyRemove';
+
+// create a module
+export default angular.module(name, [
+  angularMeteor
+]).component(name, {
+  templateUrl: `imports/ui/components/${name}/${name}.html`,
+  controllerAs: name,
+  controller: PartyRemove
+});
-- 
2.5.0


From 050a6d829de8f9f8dcb38acfefac6948eeeb4ed2 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 11:05:10 +0200
Subject: [PATCH 048/204] Step 4.15: Add party binding

---
 imports/ui/components/partyRemove/partyRemove.js | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/imports/ui/components/partyRemove/partyRemove.js b/imports/ui/components/partyRemove/partyRemove.js
index 2689076..50f5ca8 100644
--- a/imports/ui/components/partyRemove/partyRemove.js
+++ b/imports/ui/components/partyRemove/partyRemove.js
@@ -16,6 +16,9 @@ export default angular.module(name, [
   angularMeteor
 ]).component(name, {
   templateUrl: `imports/ui/components/${name}/${name}.html`,
+  bindings: {
+    party: '<'
+  },
   controllerAs: name,
   controller: PartyRemove
 });
-- 
2.5.0


From 4102f2462e6f19447a83bdb964d66ffbba39ba95 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 11:06:30 +0200
Subject: [PATCH 049/204] Step 4.16: Remove party from collection

---
 imports/ui/components/partyRemove/partyRemove.js | 5 ++++-
 1 file changed, 4 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/partyRemove/partyRemove.js b/imports/ui/components/partyRemove/partyRemove.js
index 50f5ca8..14c5861 100644
--- a/imports/ui/components/partyRemove/partyRemove.js
+++ b/imports/ui/components/partyRemove/partyRemove.js
@@ -2,10 +2,13 @@ import angular from 'angular';
 import angularMeteor from 'angular-meteor';
 
 import './partyRemove.html';
+import { Parties } from '../../../api/parties';
 
 class PartyRemove {
   remove() {
-    console.log('remove party');
+    if (this.party) {
+      Parties.remove(this.party._id);
+    }
   }
 }
 
-- 
2.5.0


From c82fdd95d9dd8e25aff056582b08c0d4eea61bfe Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 11:07:06 +0200
Subject: [PATCH 050/204] Step 4.17: Add PartyRemove

---
 imports/ui/components/partiesList/partiesList.js | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/partiesList/partiesList.js b/imports/ui/components/partiesList/partiesList.js
index eba585f..1218977 100644
--- a/imports/ui/components/partiesList/partiesList.js
+++ b/imports/ui/components/partiesList/partiesList.js
@@ -4,6 +4,7 @@ import angularMeteor from 'angular-meteor';
 import './partiesList.html';
 import { Parties } from '../../../api/parties';
 import { name as PartyAdd } from '../partyAdd/partyAdd';
+import { name as PartyRemove } from '../partyRemove/partyRemove';
 
 class PartiesList {
   constructor($scope, $reactive) {
@@ -24,7 +25,8 @@ const name = 'partiesList';
 // create a module
 export default angular.module(name, [
   angularMeteor,
-  PartyAdd
+  PartyAdd,
+  PartyRemove
 ]).component(name, {
   templateUrl: `imports/ui/components/${name}/${name}.html`,
   controllerAs: name,
-- 
2.5.0


From 8f8a504bc184e69be51c6af5cf46c7047ece5561 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 11:08:02 +0200
Subject: [PATCH 051/204] Step 4.18: Implement component

---
 imports/ui/components/partiesList/partiesList.html | 1 +
 1 file changed, 1 insertion(+)

diff --git a/imports/ui/components/partiesList/partiesList.html b/imports/ui/components/partiesList/partiesList.html
index 229908b..24dedb1 100644
--- a/imports/ui/components/partiesList/partiesList.html
+++ b/imports/ui/components/partiesList/partiesList.html
@@ -4,5 +4,6 @@
   <li ng-repeat="party in partiesList.parties">
     {{party.name}}
     <p>{{party.description}}</p>
+    <party-remove party="party"></party-remove>
   </li>
 </ul>
-- 
2.5.0


From 1820d9bfdaaa3d4c4f3ff638bf6262deb6d13ed3 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 14:21:49 +0200
Subject: [PATCH 052/204] Step 4.19: Add `sanjo:jasmine` and reporters

---
 .meteor/packages | 3 +++
 .meteor/versions | 9 +++++++++
 2 files changed, 12 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index d74ee49..03a4feb 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -19,3 +19,6 @@ autopublish             # Publish all data to the clients (for prototyping)
 insecure                # Allow all DB writes from clients (for prototyping)
 pbastowski:angular-babel
 angular-templates
+sanjo:jasmine
+velocity:html-reporter
+velocity:console-reporter
diff --git a/.meteor/versions b/.meteor/versions
index a82d518..9f4aab2 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -1,4 +1,5 @@
 allow-deny@1.0.2
+amplify@1.0.0
 angular-templates@1.0.2
 autopublish@1.0.5
 autoupdate@1.2.6
@@ -33,6 +34,7 @@ id-map@1.0.5
 insecure@1.0.5
 jquery@1.11.6
 launch-screen@1.0.8
+less@2.5.6
 livedata@1.0.16
 logging@1.0.10
 meteor@1.1.12
@@ -52,18 +54,25 @@ ordered-dict@1.0.5
 pbastowski:angular-babel@1.3.2
 promise@0.6.5
 random@1.0.7
+reactive-dict@1.1.5
 reactive-var@1.0.7
 reload@1.1.6
 retry@1.0.5
 routepolicy@1.0.8
+sanjo:jasmine@1.0.0
+session@1.1.3
 spacebars@1.0.9
 spacebars-compiler@1.0.9
 standard-minifier-css@1.0.4
 standard-minifier-js@1.0.4
+templating@1.1.7
 templating-tools@1.0.2
 tracker@1.0.11
 ui@1.0.9
 underscore@1.0.6
 url@1.0.7
+velocity:console-reporter@0.2.1
+velocity:html-reporter@0.10.0
+velocity:reports@1.0.0
 webapp@1.2.6
 webapp-hashing@1.0.7
-- 
2.5.0


From 1f950fb44783d4c0e8b2ebfb49eb4de0725a9267 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 14:23:16 +0200
Subject: [PATCH 053/204] Step 4.20: Add `test:watch` npm script

---
 package.json | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/package.json b/package.json
index 1fdb919..af9f43d 100644
--- a/package.json
+++ b/package.json
@@ -2,7 +2,8 @@
   "name": "socially",
   "private": true,
   "scripts": {
-    "start": "meteor run"
+    "start": "meteor run",
+    "test:watch": "meteor test --driver-package sanjo:jasmine"
   },
   "dependencies": {
     "angular": "^1.5.3",
-- 
2.5.0


From 7c1a335abb70fd7cad63760aa386a2098718cfd1 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 14:24:39 +0200
Subject: [PATCH 054/204] Step 4.21: Install `angular-mocks`

---
 package.json | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/package.json b/package.json
index af9f43d..1555b86 100644
--- a/package.json
+++ b/package.json
@@ -9,5 +9,8 @@
     "angular": "^1.5.3",
     "angular-meteor": "^1.3.9",
     "meteor-node-stubs": "~0.2.0"
+  },
+  "devDependencies": {
+    "angular-mocks": "^1.5.3"
   }
 }
-- 
2.5.0


From 2f3e0fe98b516be318a0f78c1455df701e871e1f Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 14:45:42 +0200
Subject: [PATCH 055/204] Step 4.22: Tests of PartyAdd

---
 .../components/partyAdd/client/partyAdd.tests.js   | 53 ++++++++++++++++++++++
 1 file changed, 53 insertions(+)
 create mode 100644 imports/ui/components/partyAdd/client/partyAdd.tests.js

diff --git a/imports/ui/components/partyAdd/client/partyAdd.tests.js b/imports/ui/components/partyAdd/client/partyAdd.tests.js
new file mode 100644
index 0000000..cc1d35e
--- /dev/null
+++ b/imports/ui/components/partyAdd/client/partyAdd.tests.js
@@ -0,0 +1,53 @@
+import { name as PartyAdd } from '../partyAdd';
+import { Parties } from '../../../../api/parties';
+import 'angular-mocks';
+
+describe('PartyAdd', () => {
+  beforeEach(() => {
+    window.module(PartyAdd);
+  });
+
+  describe('controller', () => {
+    let controller;
+    const party = {
+      name: 'Foo',
+      description: 'Birthday of Foo'
+    };
+
+    beforeEach(() => {
+      inject(($rootScope, $componentController) => {
+        controller = $componentController(PartyAdd, {
+          $scope: $rootScope.$new(true)
+        });
+      });
+    });
+
+    describe('reset()', () => {
+      it('should clean up party object', () => {
+        controller.party = party;
+        controller.reset();
+
+        expect(controller.party).toEqual({});
+      });
+    });
+
+    describe('submit()', () => {
+      beforeEach(() => {
+        spyOn(Parties, 'insert');
+        spyOn(controller, 'reset').and.callThrough();
+
+        controller.party = party;
+
+        controller.submit();
+      });
+
+      it('should insert a new party', () => {
+        expect(Parties.insert).toHaveBeenCalledWith(party);
+      });
+
+      it('should call reset()', () => {
+        expect(controller.reset).toHaveBeenCalled();
+      });
+    });
+  });
+});
-- 
2.5.0


From 562d09f43a183e0427a22ebcb8b7657f3449cb31 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 14:50:11 +0200
Subject: [PATCH 056/204] Step 4.23: Tests of PartyRemove

---
 .../partyRemove/client/partyRemove.tests.js        | 37 ++++++++++++++++++++++
 1 file changed, 37 insertions(+)
 create mode 100644 imports/ui/components/partyRemove/client/partyRemove.tests.js

diff --git a/imports/ui/components/partyRemove/client/partyRemove.tests.js b/imports/ui/components/partyRemove/client/partyRemove.tests.js
new file mode 100644
index 0000000..e8b6e97
--- /dev/null
+++ b/imports/ui/components/partyRemove/client/partyRemove.tests.js
@@ -0,0 +1,37 @@
+import { name as PartyRemove } from '../partyRemove';
+import { Parties } from '../../../../api/parties';
+import 'angular-mocks';
+
+describe('PartyRemove', () => {
+  beforeEach(() => {
+    window.module(PartyRemove);
+  });
+
+  describe('controller', () => {
+    let controller;
+    const party = {
+      _id: 'partyId'
+    };
+
+    beforeEach(() => {
+      inject(($rootScope, $componentController) => {
+        controller = $componentController(PartyRemove, {
+          $scope: $rootScope.$new(true)
+        }, {
+          party
+        });
+      });
+    });
+
+    describe('remove()', () => {
+      beforeEach(() => {
+        spyOn(Parties, 'remove');
+        controller.remove();
+      });
+
+      it('should remove a party', () => {
+        expect(Parties.remove).toHaveBeenCalledWith(party._id);
+      });
+    });
+  });
+});
-- 
2.5.0


From bc8938c56066f39f313669ec0681e095108c4cca Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 11:09:16 +0200
Subject: [PATCH 057/204] Step 5.1: Add ui-router

---
 package.json | 1 +
 1 file changed, 1 insertion(+)

diff --git a/package.json b/package.json
index 1555b86..a9636f0 100644
--- a/package.json
+++ b/package.json
@@ -8,6 +8,7 @@
   "dependencies": {
     "angular": "^1.5.3",
     "angular-meteor": "^1.3.9",
+    "angular-ui-router": "^1.0.0-alpha.4",
     "meteor-node-stubs": "~0.2.0"
   },
   "devDependencies": {
-- 
2.5.0


From cafe8d650a5cab00d8cb7682e5a03af10330f2f1 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 11:10:34 +0200
Subject: [PATCH 058/204] Step 5.2: Add uiRouter to Socially

---
 imports/ui/components/socially/socially.js | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/imports/ui/components/socially/socially.js b/imports/ui/components/socially/socially.js
index e436684..3de6e3c 100644
--- a/imports/ui/components/socially/socially.js
+++ b/imports/ui/components/socially/socially.js
@@ -1,5 +1,6 @@
 import angular from 'angular';
 import angularMeteor from 'angular-meteor';
+import uiRouter from 'angular-ui-router';
 
 import './socially.html';
 import { name as PartiesList } from '../partiesList/partiesList';
@@ -11,6 +12,7 @@ const name = 'socially';
 // create a module
 export default angular.module(name, [
   angularMeteor,
+  uiRouter,
   PartiesList
 ]).component(name, {
   templateUrl: `imports/ui/components/${name}/${name}.html`,
-- 
2.5.0


From 7689552aa55584daf31edd97986230a3853f2194 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 11:11:08 +0200
Subject: [PATCH 059/204] Step 5.3: Add base tag to main template

---
 client/index.html | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/client/index.html b/client/index.html
index e6d21ea..806f6ab 100644
--- a/client/index.html
+++ b/client/index.html
@@ -1,3 +1,6 @@
+<head>
+  <base href="/">
+</head>
 <body ng-app="socially" ng-strict-di="">
   <socially></socially>
 </body>
-- 
2.5.0


From 39be2f78a1073884ea82cf9c91b6437fd3e61fc8 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 11:11:52 +0200
Subject: [PATCH 060/204] Step 5.4: Add uiView to Socially view

---
 imports/ui/components/socially/socially.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/imports/ui/components/socially/socially.html b/imports/ui/components/socially/socially.html
index 5e9673b..19b303a 100644
--- a/imports/ui/components/socially/socially.html
+++ b/imports/ui/components/socially/socially.html
@@ -1 +1 @@
-<parties-list></parties-list>
+<div ui-view=""></div>
-- 
2.5.0


From b811ea90443d3a593e8df41ea70a5e2aec3f1a9a Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 11:13:54 +0200
Subject: [PATCH 061/204] Step 5.5: Define `parties` route

---
 imports/ui/components/partiesList/partiesList.js | 14 +++++++++++++-
 1 file changed, 13 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/partiesList/partiesList.js b/imports/ui/components/partiesList/partiesList.js
index 1218977..bc00317 100644
--- a/imports/ui/components/partiesList/partiesList.js
+++ b/imports/ui/components/partiesList/partiesList.js
@@ -1,5 +1,6 @@
 import angular from 'angular';
 import angularMeteor from 'angular-meteor';
+import uiRouter from 'angular-ui-router';
 
 import './partiesList.html';
 import { Parties } from '../../../api/parties';
@@ -25,10 +26,21 @@ const name = 'partiesList';
 // create a module
 export default angular.module(name, [
   angularMeteor,
+  uiRouter,
   PartyAdd,
   PartyRemove
 ]).component(name, {
   templateUrl: `imports/ui/components/${name}/${name}.html`,
   controllerAs: name,
   controller: PartiesList
-});
+})
+  .config(config);
+
+function config($stateProvider) {
+  'ngInject';
+  $stateProvider
+    .state('parties', {
+      url: '/parties',
+      template: '<parties-list></parties-list>'
+    });
+}
-- 
2.5.0


From 00bb57640c7d69b271a106472177dfc431493aee Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 11:15:19 +0200
Subject: [PATCH 062/204] Step 5.6: Set html5Mode and `parties` as default
 route

---
 imports/ui/components/socially/socially.js | 11 ++++++++++-
 1 file changed, 10 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/socially/socially.js b/imports/ui/components/socially/socially.js
index 3de6e3c..f902505 100644
--- a/imports/ui/components/socially/socially.js
+++ b/imports/ui/components/socially/socially.js
@@ -18,4 +18,13 @@ export default angular.module(name, [
   templateUrl: `imports/ui/components/${name}/${name}.html`,
   controllerAs: name,
   controller: Socially
-});
+})
+  .config(config);
+
+function config($locationProvider, $urlRouterProvider) {
+  'ngInject';
+
+  $locationProvider.html5Mode(true);
+
+  $urlRouterProvider.otherwise('/parties');
+}
-- 
2.5.0


From 9a333ef9d8441f8a0179637cb0baf164c47881ba Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 11:16:09 +0200
Subject: [PATCH 063/204] Step 5.7: Create view for Navigation component

---
 imports/ui/components/navigation/navigation.html | 3 +++
 1 file changed, 3 insertions(+)
 create mode 100644 imports/ui/components/navigation/navigation.html

diff --git a/imports/ui/components/navigation/navigation.html b/imports/ui/components/navigation/navigation.html
new file mode 100644
index 0000000..def2640
--- /dev/null
+++ b/imports/ui/components/navigation/navigation.html
@@ -0,0 +1,3 @@
+<h1>
+  <a href="/parties">Home</a>
+</h1>
-- 
2.5.0


From 42868375857918acdb9d78bd142c4b421584d057 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 11:17:01 +0200
Subject: [PATCH 064/204] Step 5.8: Create Navigation component

---
 imports/ui/components/navigation/navigation.js | 14 ++++++++++++++
 1 file changed, 14 insertions(+)
 create mode 100644 imports/ui/components/navigation/navigation.js

diff --git a/imports/ui/components/navigation/navigation.js b/imports/ui/components/navigation/navigation.js
new file mode 100644
index 0000000..a79d5ec
--- /dev/null
+++ b/imports/ui/components/navigation/navigation.js
@@ -0,0 +1,14 @@
+import angular from 'angular';
+import angularMeteor from 'angular-meteor';
+
+import './navigation.html';
+
+const name = 'navigation';
+
+// create a module
+export default angular.module(name, [
+  angularMeteor
+]).component(name, {
+  templateUrl: `imports/ui/components/${name}/${name}.html`,
+  controllerAs: name
+});
-- 
2.5.0


From f332f3cd080fe47f5faa532efb7ad81c51d1aaa8 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 11:17:37 +0200
Subject: [PATCH 065/204] Step 5.9: Implement Navigation in the view

---
 imports/ui/components/socially/socially.html | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/imports/ui/components/socially/socially.html b/imports/ui/components/socially/socially.html
index 19b303a..7fdb2de 100644
--- a/imports/ui/components/socially/socially.html
+++ b/imports/ui/components/socially/socially.html
@@ -1 +1,3 @@
+<navigation></navigation>
+
 <div ui-view=""></div>
-- 
2.5.0


From b98f3b64a8fb8e1a32ea2885718bb1f26bc8b8e6 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 11:18:12 +0200
Subject: [PATCH 066/204] Step 5.10: Add Navigation to Socially

---
 imports/ui/components/socially/socially.js | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/socially/socially.js b/imports/ui/components/socially/socially.js
index f902505..7ef0d74 100644
--- a/imports/ui/components/socially/socially.js
+++ b/imports/ui/components/socially/socially.js
@@ -4,6 +4,7 @@ import uiRouter from 'angular-ui-router';
 
 import './socially.html';
 import { name as PartiesList } from '../partiesList/partiesList';
+import { name as Navigation } from '../navigation/navigation';
 
 class Socially {}
 
@@ -13,7 +14,8 @@ const name = 'socially';
 export default angular.module(name, [
   angularMeteor,
   uiRouter,
-  PartiesList
+  PartiesList,
+  Navigation
 ]).component(name, {
   templateUrl: `imports/ui/components/${name}/${name}.html`,
   controllerAs: name,
-- 
2.5.0


From 4a2468187ae4de03e181fa4e7bb64ccda7463aa4 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 11:19:42 +0200
Subject: [PATCH 067/204] Step 5.11: Create view for the PartyDetails

---
 imports/ui/components/partyDetails/partyDetails.html | 1 +
 1 file changed, 1 insertion(+)
 create mode 100644 imports/ui/components/partyDetails/partyDetails.html

diff --git a/imports/ui/components/partyDetails/partyDetails.html b/imports/ui/components/partyDetails/partyDetails.html
new file mode 100644
index 0000000..3ea8425
--- /dev/null
+++ b/imports/ui/components/partyDetails/partyDetails.html
@@ -0,0 +1 @@
+The party your selected is: {{ partyDetails.partyId }}
-- 
2.5.0


From 75e36b1ce874b8662f6d1dc43cb2276bceea5071 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 11:21:42 +0200
Subject: [PATCH 068/204] Step 5.12: Create PartyDetails

---
 imports/ui/components/partyDetails/partyDetails.js | 24 ++++++++++++++++++++++
 1 file changed, 24 insertions(+)
 create mode 100644 imports/ui/components/partyDetails/partyDetails.js

diff --git a/imports/ui/components/partyDetails/partyDetails.js b/imports/ui/components/partyDetails/partyDetails.js
new file mode 100644
index 0000000..555c7c6
--- /dev/null
+++ b/imports/ui/components/partyDetails/partyDetails.js
@@ -0,0 +1,24 @@
+import angular from 'angular';
+import angularMeteor from 'angular-meteor';
+import uiRouter from 'angular-ui-router';
+
+import './partyDetails.html';
+
+class PartyDetails {
+  constructor($stateParams) {
+    'ngInject';
+    
+    this.partyId = $stateParams.partyId;
+  }
+}
+
+const name = 'partyDetails';
+
+// create a module
+export default angular.module(name, [
+  angularMeteor
+]).component(name, {
+  templateUrl: `imports/ui/components/${name}/${name}.html`,
+  controllerAs: name,
+  controller: PartyDetails
+});
-- 
2.5.0


From 26ecd002fcfd1c33da6f095f46f2028614696b3c Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 11:22:56 +0200
Subject: [PATCH 069/204] Step 5.13: Set partyDetails state

---
 imports/ui/components/partyDetails/partyDetails.js | 17 ++++++++++++++---
 1 file changed, 14 insertions(+), 3 deletions(-)

diff --git a/imports/ui/components/partyDetails/partyDetails.js b/imports/ui/components/partyDetails/partyDetails.js
index 555c7c6..41dfe6b 100644
--- a/imports/ui/components/partyDetails/partyDetails.js
+++ b/imports/ui/components/partyDetails/partyDetails.js
@@ -7,7 +7,7 @@ import './partyDetails.html';
 class PartyDetails {
   constructor($stateParams) {
     'ngInject';
-    
+
     this.partyId = $stateParams.partyId;
   }
 }
@@ -16,9 +16,20 @@ const name = 'partyDetails';
 
 // create a module
 export default angular.module(name, [
-  angularMeteor
+  angularMeteor,
+  uiRouter
 ]).component(name, {
   templateUrl: `imports/ui/components/${name}/${name}.html`,
   controllerAs: name,
   controller: PartyDetails
-});
+})
+  .config(config);
+
+function config($stateProvider) {
+  'ngInject';
+
+  $stateProvider.state('partyDetails', {
+    url: '/parties/:partyId',
+    template: '<party-details></party-details>'
+  });
+}
-- 
2.5.0


From 884d96c3aaa2e8f0f23d02a2973184c95ab0654c Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 11:23:41 +0200
Subject: [PATCH 070/204] Step 5.14: Add PartyDetails to Socially

---
 imports/ui/components/socially/socially.js | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/imports/ui/components/socially/socially.js b/imports/ui/components/socially/socially.js
index 7ef0d74..2a2c103 100644
--- a/imports/ui/components/socially/socially.js
+++ b/imports/ui/components/socially/socially.js
@@ -4,6 +4,7 @@ import uiRouter from 'angular-ui-router';
 
 import './socially.html';
 import { name as PartiesList } from '../partiesList/partiesList';
+import { name as PartyDetails } from '../partyDetails/partyDetails';
 import { name as Navigation } from '../navigation/navigation';
 
 class Socially {}
@@ -15,6 +16,7 @@ export default angular.module(name, [
   angularMeteor,
   uiRouter,
   PartiesList,
+  PartyDetails,
   Navigation
 ]).component(name, {
   templateUrl: `imports/ui/components/${name}/${name}.html`,
-- 
2.5.0


From 664825da8b1cc171b1690992e47e2f4d25cc653a Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 11:25:15 +0200
Subject: [PATCH 071/204] Step 5.15: Add link

---
 imports/ui/components/partiesList/partiesList.html | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/partiesList/partiesList.html b/imports/ui/components/partiesList/partiesList.html
index 24dedb1..c1b07e2 100644
--- a/imports/ui/components/partiesList/partiesList.html
+++ b/imports/ui/components/partiesList/partiesList.html
@@ -2,7 +2,9 @@
 
 <ul>
   <li ng-repeat="party in partiesList.parties">
-    {{party.name}}
+    <a ui-sref="partyDetails({ partyId: party._id })">
+      {{party.name}}
+    </a>
     <p>{{party.description}}</p>
     <party-remove party="party"></party-remove>
   </li>
-- 
2.5.0


From 980c0025d8ae557874341937350a6034755fa4b7 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 11:30:15 +0200
Subject: [PATCH 072/204] Step 6.1: Add party helper

---
 imports/ui/components/partyDetails/partyDetails.js | 13 ++++++++++++-
 1 file changed, 12 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/partyDetails/partyDetails.js b/imports/ui/components/partyDetails/partyDetails.js
index 41dfe6b..75ad55a 100644
--- a/imports/ui/components/partyDetails/partyDetails.js
+++ b/imports/ui/components/partyDetails/partyDetails.js
@@ -3,12 +3,23 @@ import angularMeteor from 'angular-meteor';
 import uiRouter from 'angular-ui-router';
 
 import './partyDetails.html';
+import { Parties } from '../../../api/parties';
 
 class PartyDetails {
-  constructor($stateParams) {
+  constructor($stateParams, $scope, $reactive) {
     'ngInject';
 
+    $reactive(this).attach($scope);
+
     this.partyId = $stateParams.partyId;
+
+    this.helpers({
+      party() {
+        return Parties.findOne({
+          _id: $stateParams.partyId
+        });
+      }
+    });
   }
 }
 
-- 
2.5.0


From 8d1fa2d0bc3aabfd0a77e3a8fa14e77926963da4 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 11:33:34 +0200
Subject: [PATCH 073/204] Step 6.2: Add form with the party details to the
 party details page

---
 imports/ui/components/partyDetails/partyDetails.html | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/partyDetails/partyDetails.html b/imports/ui/components/partyDetails/partyDetails.html
index 3ea8425..8c1201f 100644
--- a/imports/ui/components/partyDetails/partyDetails.html
+++ b/imports/ui/components/partyDetails/partyDetails.html
@@ -1 +1,5 @@
-The party your selected is: {{ partyDetails.partyId }}
+The party your selected is:
+<form>
+  Party name: <input type="text" ng-model="partyDetails.party.name" />
+  Description: <input type="text" ng-model="partyDetails.party.description" />
+</form>
-- 
2.5.0


From 6fde87ef3b6416660ec3ad04bf0af47bbec5a313 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 11:34:10 +0200
Subject: [PATCH 074/204] Step 6.3: Add save and back buttons to the view

---
 imports/ui/components/partyDetails/partyDetails.html | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/imports/ui/components/partyDetails/partyDetails.html b/imports/ui/components/partyDetails/partyDetails.html
index 8c1201f..b5c939b 100644
--- a/imports/ui/components/partyDetails/partyDetails.html
+++ b/imports/ui/components/partyDetails/partyDetails.html
@@ -2,4 +2,7 @@ The party your selected is:
 <form>
   Party name: <input type="text" ng-model="partyDetails.party.name" />
   Description: <input type="text" ng-model="partyDetails.party.description" />
+  <button ng-click="partyDetails.save()">Save</button>
 </form>
+
+<button ui-sref="parties">Back</button>
-- 
2.5.0


From 04dbcb764e1009a4fe023e3657d04508fc5a8593 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 11:35:38 +0200
Subject: [PATCH 075/204] Step 6.4: Implement save button on the component
 logic

---
 imports/ui/components/partyDetails/partyDetails.js | 11 +++++++++++
 1 file changed, 11 insertions(+)

diff --git a/imports/ui/components/partyDetails/partyDetails.js b/imports/ui/components/partyDetails/partyDetails.js
index 75ad55a..9e5092e 100644
--- a/imports/ui/components/partyDetails/partyDetails.js
+++ b/imports/ui/components/partyDetails/partyDetails.js
@@ -21,6 +21,17 @@ class PartyDetails {
       }
     });
   }
+
+  save() {
+    Parties.update({
+      _id: this.party._id
+    }, {
+      $set: {
+        name: this.party.name,
+        description: this.party.description
+      }
+    });
+  }
 }
 
 const name = 'partyDetails';
-- 
2.5.0


From 826b42bc5f91bd0c33643daa442b87e320c23169 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 11:36:24 +0200
Subject: [PATCH 076/204] Step 6.5: Handle success and fail for data actions

---
 imports/ui/components/partyDetails/partyDetails.js | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/imports/ui/components/partyDetails/partyDetails.js b/imports/ui/components/partyDetails/partyDetails.js
index 9e5092e..0916e06 100644
--- a/imports/ui/components/partyDetails/partyDetails.js
+++ b/imports/ui/components/partyDetails/partyDetails.js
@@ -30,6 +30,12 @@ class PartyDetails {
         name: this.party.name,
         description: this.party.description
       }
+    }, (error) => {
+      if (error) {
+        console.log('Oops, unable to update the party...');
+      } else {
+        console.log('Done!');
+      }
     });
   }
 }
-- 
2.5.0


From 09a43208ff2624ed81294678539d15944543732c Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 15:11:57 +0200
Subject: [PATCH 077/204] Step 6.6: Tests of PartyDetails

---
 .../partyDetails/client/partyDetails.tests.js      | 49 ++++++++++++++++++++++
 1 file changed, 49 insertions(+)
 create mode 100644 imports/ui/components/partyDetails/client/partyDetails.tests.js

diff --git a/imports/ui/components/partyDetails/client/partyDetails.tests.js b/imports/ui/components/partyDetails/client/partyDetails.tests.js
new file mode 100644
index 0000000..997304e
--- /dev/null
+++ b/imports/ui/components/partyDetails/client/partyDetails.tests.js
@@ -0,0 +1,49 @@
+import { name as PartyDetails } from '../partyDetails';
+import { Parties } from '../../../../api/parties';
+import 'angular-mocks';
+
+describe('PartyDetails', () => {
+  beforeEach(() => {
+    window.module(PartyDetails);
+  });
+
+  describe('controller', () => {
+    let controller;
+    const party = {
+      _id: 'partyId',
+      name: 'Foo',
+      description: 'Birthday of Foo'
+    };
+
+    beforeEach(() => {
+      inject(($rootScope, $componentController) => {
+        controller = $componentController(PartyDetails, {
+          $scope: $rootScope.$new(true)
+        });
+      });
+    });
+
+    describe('save()', () => {
+      beforeEach(() => {
+        spyOn(Parties, 'update');
+        controller.party = party;
+        controller.save();
+      });
+
+      it('should update a proper party', () => {
+        expect(Parties.update.calls.mostRecent().args[0]).toEqual({
+          _id: party._id
+        });
+      });
+
+      it('should update with proper modifier', () => {
+        expect(Parties.update.calls.mostRecent().args[1]).toEqual({
+          $set: {
+            name: party.name,
+            description: party.description
+          }
+        });
+      });
+    });
+  });
+});
-- 
2.5.0


From 5d9cf87da3d197dcbb3d61d634dee0fef17ca7d8 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 11:38:12 +0200
Subject: [PATCH 078/204] Step 7.1: Move startup to imports

---
 imports/startup/fixtures.js | 21 +++++++++++++++++++++
 1 file changed, 21 insertions(+)
 create mode 100644 imports/startup/fixtures.js

diff --git a/imports/startup/fixtures.js b/imports/startup/fixtures.js
new file mode 100644
index 0000000..d92fb48
--- /dev/null
+++ b/imports/startup/fixtures.js
@@ -0,0 +1,21 @@
+import { Meteor } from 'meteor/meteor';
+import { Parties } from '../api/parties';
+
+Meteor.startup(() => {
+  if (Parties.find().count() === 0) {
+    const parties = [{
+      'name': 'Dubstep-Free Zone',
+      'description': 'Fast just got faster with Nexus S.'
+    }, {
+      'name': 'All dubstep all the time',
+      'description': 'Get it on!'
+    }, {
+      'name': 'Savage lounging',
+      'description': 'Leisure suit required. And only fiercest manners.'
+    }];
+
+    parties.forEach((party) => {
+      Parties.insert(party)
+    });
+  }
+});
-- 
2.5.0


From 5404e8ef54f9721e038e5a943168b6f8cfe84ca9 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 11:39:27 +0200
Subject: [PATCH 079/204] Step 7.2: Create main entry point on server-side

---
 server/main.js | 1 +
 1 file changed, 1 insertion(+)
 create mode 100644 server/main.js

diff --git a/server/main.js b/server/main.js
new file mode 100644
index 0000000..40efcd1
--- /dev/null
+++ b/server/main.js
@@ -0,0 +1 @@
+import '../imports/startup/fixtures';
-- 
2.5.0


From 8cdb757897f088b77c1c1876e87cc33e8546bbc7 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 11:40:16 +0200
Subject: [PATCH 080/204] Step 7.3: Import Parties on server-side to be
 synchronized

---
 server/main.js | 1 +
 1 file changed, 1 insertion(+)

diff --git a/server/main.js b/server/main.js
index 40efcd1..d4c97f0 100644
--- a/server/main.js
+++ b/server/main.js
@@ -1 +1,2 @@
 import '../imports/startup/fixtures';
+import '../imports/api/parties';
-- 
2.5.0


From 8400bc416693ae747222c6367f61652fabfd4645 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 11:40:34 +0200
Subject: [PATCH 081/204] Step 7.4: Remove old startup.js

---
 server/startup.js | 21 ---------------------
 1 file changed, 21 deletions(-)
 delete mode 100644 server/startup.js

diff --git a/server/startup.js b/server/startup.js
deleted file mode 100644
index 6ce39cd..0000000
--- a/server/startup.js
+++ /dev/null
@@ -1,21 +0,0 @@
-import { Meteor } from 'meteor/meteor';
-import { Parties } from '../imports/api/parties';
-
-Meteor.startup(() => {
-  if (Parties.find().count() === 0) {
-    const parties = [{
-      'name': 'Dubstep-Free Zone',
-      'description': 'Fast just got faster with Nexus S.'
-    }, {
-      'name': 'All dubstep all the time',
-      'description': 'Get it on!'
-    }, {
-      'name': 'Savage lounging',
-      'description': 'Leisure suit required. And only fiercest manners.'
-    }];
-
-    parties.forEach((party) => {
-      Parties.insert(party)
-    });
-  }
-});
-- 
2.5.0


From 11644be5ac4a3ceb9cec2529b63cafe2941dfacc Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 11:41:57 +0200
Subject: [PATCH 082/204] Step 8.1: Remove `insecure` package

---
 .meteor/packages | 1 -
 .meteor/versions | 1 -
 2 files changed, 2 deletions(-)

diff --git a/.meteor/packages b/.meteor/packages
index 03a4feb..7368104 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -16,7 +16,6 @@ standard-minifier-js    # JS minifier run for production mode
 es5-shim                # ECMAScript 5 compatibility for older browsers.
 
 autopublish             # Publish all data to the clients (for prototyping)
-insecure                # Allow all DB writes from clients (for prototyping)
 pbastowski:angular-babel
 angular-templates
 sanjo:jasmine
diff --git a/.meteor/versions b/.meteor/versions
index 9f4aab2..dc09abe 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -31,7 +31,6 @@ html-tools@1.0.7
 htmljs@1.0.7
 http@1.1.3
 id-map@1.0.5
-insecure@1.0.5
 jquery@1.11.6
 launch-screen@1.0.8
 less@2.5.6
-- 
2.5.0


From cdcd13b3f272586c4b24e0197a6e1ed13ed45b6a Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 11:42:53 +0200
Subject: [PATCH 083/204] Step 8.2: Add `accounts-password`

---
 .meteor/packages |  1 +
 .meteor/versions | 10 ++++++++++
 2 files changed, 11 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index 7368104..f402f80 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -21,3 +21,4 @@ angular-templates
 sanjo:jasmine
 velocity:html-reporter
 velocity:console-reporter
+accounts-password
diff --git a/.meteor/versions b/.meteor/versions
index dc09abe..5d9416a 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -1,3 +1,5 @@
+accounts-base@1.2.4
+accounts-password@1.1.6
 allow-deny@1.0.2
 amplify@1.0.0
 angular-templates@1.0.2
@@ -17,12 +19,14 @@ check@1.1.2
 ddp@1.2.3
 ddp-client@1.2.3
 ddp-common@1.2.3
+ddp-rate-limiter@1.0.2
 ddp-server@1.2.4
 deps@1.0.10
 diff-sequence@1.0.3
 ecmascript@0.4.1
 ecmascript-runtime@0.2.8
 ejson@1.0.9
+email@1.0.10
 es5-shim@4.5.8
 fastclick@1.0.9
 geojson-utils@1.0.6
@@ -35,6 +39,7 @@ jquery@1.11.6
 launch-screen@1.0.8
 less@2.5.6
 livedata@1.0.16
+localstorage@1.0.7
 logging@1.0.10
 meteor@1.1.12
 meteor-base@1.0.2
@@ -47,6 +52,7 @@ modules@0.5.1
 modules-runtime@0.6.1
 mongo@1.1.5
 mongo-id@1.0.2
+npm-bcrypt@0.7.8_2
 npm-mongo@1.4.41
 observe-sequence@1.0.9
 ordered-dict@1.0.5
@@ -54,14 +60,18 @@ pbastowski:angular-babel@1.3.2
 promise@0.6.5
 random@1.0.7
 reactive-dict@1.1.5
+rate-limit@1.0.2
 reactive-var@1.0.7
 reload@1.1.6
 retry@1.0.5
 routepolicy@1.0.8
 sanjo:jasmine@1.0.0
 session@1.1.3
+service-configuration@1.0.7
+sha@1.0.5
 spacebars@1.0.9
 spacebars-compiler@1.0.9
+srp@1.0.6
 standard-minifier-css@1.0.4
 standard-minifier-js@1.0.4
 templating@1.1.7
-- 
2.5.0


From aea175bf7c1e73f1662fb6f0156c8b34a645801f Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 11:44:10 +0200
Subject: [PATCH 084/204] Step 8.3: Add `dotansimha:accounts-ui-angular`

---
 .meteor/packages | 1 +
 .meteor/versions | 7 +++++++
 2 files changed, 8 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index f402f80..cc4586d 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -22,3 +22,4 @@ sanjo:jasmine
 velocity:html-reporter
 velocity:console-reporter
 accounts-password
+dotansimha:accounts-ui-angular
diff --git a/.meteor/versions b/.meteor/versions
index 5d9416a..f4511e6 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -1,5 +1,7 @@
 accounts-base@1.2.4
 accounts-password@1.1.6
+accounts-ui@1.1.7
+accounts-ui-unstyled@1.1.10
 allow-deny@1.0.2
 amplify@1.0.0
 angular-templates@1.0.2
@@ -10,6 +12,7 @@ babel-runtime@0.1.6
 base64@1.0.6
 binary-heap@1.0.6
 blaze@2.1.5
+blaze-html-templates@1.0.2
 blaze-tools@1.0.6
 boilerplate-generator@1.0.6
 caching-compiler@1.0.2
@@ -23,6 +26,7 @@ ddp-rate-limiter@1.0.2
 ddp-server@1.2.4
 deps@1.0.10
 diff-sequence@1.0.3
+dotansimha:accounts-ui-angular@0.0.4
 ecmascript@0.4.1
 ecmascript-runtime@0.2.8
 ejson@1.0.9
@@ -61,6 +65,7 @@ promise@0.6.5
 random@1.0.7
 reactive-dict@1.1.5
 rate-limit@1.0.2
+reactive-dict@1.1.5
 reactive-var@1.0.7
 reload@1.1.6
 retry@1.0.5
@@ -68,6 +73,7 @@ routepolicy@1.0.8
 sanjo:jasmine@1.0.0
 session@1.1.3
 service-configuration@1.0.7
+session@1.1.3
 sha@1.0.5
 spacebars@1.0.9
 spacebars-compiler@1.0.9
@@ -76,6 +82,7 @@ standard-minifier-css@1.0.4
 standard-minifier-js@1.0.4
 templating@1.1.7
 templating-tools@1.0.2
+tmeasday:check-npm-versions@0.1.1
 tracker@1.0.11
 ui@1.0.9
 underscore@1.0.6
-- 
2.5.0


From 5443b3f8f8baf805f0c899c8798091cbd107ab51 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 11:44:45 +0200
Subject: [PATCH 085/204] Step 8.4: Add a dependecy for accounts-ui package

---
 imports/ui/components/socially/socially.js | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/socially/socially.js b/imports/ui/components/socially/socially.js
index 2a2c103..2cc775f 100644
--- a/imports/ui/components/socially/socially.js
+++ b/imports/ui/components/socially/socially.js
@@ -17,7 +17,8 @@ export default angular.module(name, [
   uiRouter,
   PartiesList,
   PartyDetails,
-  Navigation
+  Navigation,
+  'accounts.ui'
 ]).component(name, {
   templateUrl: `imports/ui/components/${name}/${name}.html`,
   controllerAs: name,
-- 
2.5.0


From 94f79f1c6ca2d71f073c979601bb2a71e18f1be1 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 11:45:52 +0200
Subject: [PATCH 086/204] Step 8.5: Add usage for login-buttons directive

---
 imports/ui/components/socially/socially.html | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/imports/ui/components/socially/socially.html b/imports/ui/components/socially/socially.html
index 7fdb2de..83c40e7 100644
--- a/imports/ui/components/socially/socially.html
+++ b/imports/ui/components/socially/socially.html
@@ -1,3 +1,5 @@
+<login-buttons></login-buttons>
+
 <navigation></navigation>
 
 <div ui-view=""></div>
-- 
2.5.0


From 35e5c594ee2f569a3886d4f67cfe74353ac5450a Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:01:43 +0200
Subject: [PATCH 087/204] Step 8.6: Add allow logic to the model

---
 imports/api/parties.js | 12 ++++++++++++
 1 file changed, 12 insertions(+)

diff --git a/imports/api/parties.js b/imports/api/parties.js
index e308632..3e283c1 100644
--- a/imports/api/parties.js
+++ b/imports/api/parties.js
@@ -1,3 +1,15 @@
 import { Mongo } from 'meteor/mongo';
 
 export const Parties = new Mongo.Collection('parties');
+
+Parties.allow({
+  insert(userId, party) {
+    return userId && party.owner === userId;
+  },
+  update(userId, party, fields, modifier) {
+    return userId && party.owner === userId;
+  },
+  remove(userId, party) {
+    return userId && party.owner === userId;
+  }
+});
-- 
2.5.0


From 8bf25065247c492fbd77e9cfdc7a2f0032e741e1 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:02:37 +0200
Subject: [PATCH 088/204] Step 8.7: Add current user to the new party

---
 imports/ui/components/partyAdd/partyAdd.js | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/imports/ui/components/partyAdd/partyAdd.js b/imports/ui/components/partyAdd/partyAdd.js
index f51f219..5b1ead3 100644
--- a/imports/ui/components/partyAdd/partyAdd.js
+++ b/imports/ui/components/partyAdd/partyAdd.js
@@ -1,6 +1,8 @@
 import angular from 'angular';
 import angularMeteor from 'angular-meteor';
 
+import { Meteor } from 'meteor/meteor';
+
 import './partyAdd.html';
 import { Parties } from '../../../api/parties';
 
@@ -10,6 +12,7 @@ class PartyAdd {
   }
 
   submit() {
+    this.party.owner = Meteor.user()._id;
     Parties.insert(this.party);
     this.reset();
   }
-- 
2.5.0


From 85078080e84c8099a85614f46e13ae09b2f2e3bf Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:03:33 +0200
Subject: [PATCH 089/204] Step 8.8: Add facebook and twitter

---
 .meteor/packages | 2 ++
 .meteor/versions | 8 ++++++++
 2 files changed, 10 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index cc4586d..0af80ec 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -23,3 +23,5 @@ velocity:html-reporter
 velocity:console-reporter
 accounts-password
 dotansimha:accounts-ui-angular
+accounts-facebook
+accounts-twitter
diff --git a/.meteor/versions b/.meteor/versions
index f4511e6..39637f1 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -1,5 +1,8 @@
 accounts-base@1.2.4
+accounts-facebook@1.0.7
+accounts-oauth@1.1.10
 accounts-password@1.1.6
+accounts-twitter@1.0.7
 accounts-ui@1.1.7
 accounts-ui-unstyled@1.1.10
 allow-deny@1.0.2
@@ -32,6 +35,7 @@ ecmascript-runtime@0.2.8
 ejson@1.0.9
 email@1.0.10
 es5-shim@4.5.8
+facebook@1.2.4
 fastclick@1.0.9
 geojson-utils@1.0.6
 hot-code-push@1.0.2
@@ -58,6 +62,9 @@ mongo@1.1.5
 mongo-id@1.0.2
 npm-bcrypt@0.7.8_2
 npm-mongo@1.4.41
+oauth@1.1.8
+oauth1@1.1.7
+oauth2@1.1.7
 observe-sequence@1.0.9
 ordered-dict@1.0.5
 pbastowski:angular-babel@1.3.2
@@ -84,6 +91,7 @@ templating@1.1.7
 templating-tools@1.0.2
 tmeasday:check-npm-versions@0.1.1
 tracker@1.0.11
+twitter@1.1.7
 ui@1.0.9
 underscore@1.0.6
 url@1.0.7
-- 
2.5.0


From 7e27b2a8d6972971533091d5ba9ad9d9c353ddeb Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:05:29 +0200
Subject: [PATCH 090/204] Step 8.9: Add permissions limit to the party details
 page

---
 imports/ui/components/partyDetails/partyDetails.js | 13 ++++++++++++-
 1 file changed, 12 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/partyDetails/partyDetails.js b/imports/ui/components/partyDetails/partyDetails.js
index 0916e06..bd71782 100644
--- a/imports/ui/components/partyDetails/partyDetails.js
+++ b/imports/ui/components/partyDetails/partyDetails.js
@@ -2,6 +2,8 @@ import angular from 'angular';
 import angularMeteor from 'angular-meteor';
 import uiRouter from 'angular-ui-router';
 
+import { Meteor } from 'meteor/meteor';
+
 import './partyDetails.html';
 import { Parties } from '../../../api/parties';
 
@@ -58,6 +60,15 @@ function config($stateProvider) {
 
   $stateProvider.state('partyDetails', {
     url: '/parties/:partyId',
-    template: '<party-details></party-details>'
+    template: '<party-details></party-details>',
+    resolve: {
+      currentUser($q) {
+        if (Meteor.userId() === null) {
+          return $q.reject();
+        } else {
+          return $q.resolve();
+        }
+      }
+    }
   });
 }
-- 
2.5.0


From 596f62df54c629260c7c8b3ccef95ca8eac1d41a Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:05:59 +0200
Subject: [PATCH 091/204] Step 8.10: Add the reason of rejection

---
 imports/ui/components/partyDetails/partyDetails.js | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/imports/ui/components/partyDetails/partyDetails.js b/imports/ui/components/partyDetails/partyDetails.js
index bd71782..12c05aa 100644
--- a/imports/ui/components/partyDetails/partyDetails.js
+++ b/imports/ui/components/partyDetails/partyDetails.js
@@ -64,7 +64,7 @@ function config($stateProvider) {
     resolve: {
       currentUser($q) {
         if (Meteor.userId() === null) {
-          return $q.reject();
+          return $q.reject('AUTH_REQUIRED');
         } else {
           return $q.resolve();
         }
-- 
2.5.0


From 45572be984a55dd2f8410d7c57e388a0a77ce4c9 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:07:34 +0200
Subject: [PATCH 092/204] Step 8.11: Handle `AUTH_REQUIRED`

---
 imports/ui/components/socially/socially.js | 15 ++++++++++++++-
 1 file changed, 14 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/socially/socially.js b/imports/ui/components/socially/socially.js
index 2cc775f..61c86d1 100644
--- a/imports/ui/components/socially/socially.js
+++ b/imports/ui/components/socially/socially.js
@@ -24,7 +24,8 @@ export default angular.module(name, [
   controllerAs: name,
   controller: Socially
 })
-  .config(config);
+  .config(config)
+  .run(run);
 
 function config($locationProvider, $urlRouterProvider) {
   'ngInject';
@@ -33,3 +34,15 @@ function config($locationProvider, $urlRouterProvider) {
 
   $urlRouterProvider.otherwise('/parties');
 }
+
+function run($rootScope, $state) {
+  'ngInject';
+  
+  $rootScope.$on('$stateChangeError',
+    (event, toState, toParams, fromState, fromParams, error) => {
+      if (error === 'AUTH_REQUIRED') {
+        $state.go('parties');
+      }
+    }
+  );
+}
-- 
2.5.0


From 4c70b8461b420fcfde7777e36f4af14e1d6c39e1 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:08:59 +0200
Subject: [PATCH 093/204] Step 9.1: Remove `autopublish`

---
 .meteor/packages | 1 -
 .meteor/versions | 1 -
 2 files changed, 2 deletions(-)

diff --git a/.meteor/packages b/.meteor/packages
index 0af80ec..110dde9 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -15,7 +15,6 @@ standard-minifier-css   # CSS minifier run for production mode
 standard-minifier-js    # JS minifier run for production mode
 es5-shim                # ECMAScript 5 compatibility for older browsers.
 
-autopublish             # Publish all data to the clients (for prototyping)
 pbastowski:angular-babel
 angular-templates
 sanjo:jasmine
diff --git a/.meteor/versions b/.meteor/versions
index 39637f1..2d7c2e7 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -8,7 +8,6 @@ accounts-ui-unstyled@1.1.10
 allow-deny@1.0.2
 amplify@1.0.0
 angular-templates@1.0.2
-autopublish@1.0.5
 autoupdate@1.2.6
 babel-compiler@6.5.2
 babel-runtime@0.1.6
-- 
2.5.0


From 9da699c9fe5ee4bd30f454676593cd8406d84b54 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:14:30 +0200
Subject: [PATCH 094/204] Step 9.2: Add the `parties` publication to the server

---
 imports/api/parties/publish.js | 31 +++++++++++++++++++++++++++++++
 1 file changed, 31 insertions(+)
 create mode 100644 imports/api/parties/publish.js

diff --git a/imports/api/parties/publish.js b/imports/api/parties/publish.js
new file mode 100644
index 0000000..590f23b
--- /dev/null
+++ b/imports/api/parties/publish.js
@@ -0,0 +1,31 @@
+import { Meteor } from 'meteor/meteor';
+
+import { Parties } from './collection';
+
+if (Meteor.isServer) {
+  Meteor.publish('parties', function() {
+    const selector = {
+      $or: [{
+        // the public parties
+        $and: [{
+          public: true
+        }, {
+          public: {
+            $exists: true
+          }
+        }]
+      }, {
+        // when logged in user is the owner
+        $and: [{
+          owner: this.userId
+        }, {
+          owner: {
+            $exists: true
+          }
+        }]
+      }]
+    };
+
+    return Parties.find(selector);
+  });
+}
-- 
2.5.0


From 43732be1629e5f63eba15e3b7848607954908fa7 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:15:16 +0200
Subject: [PATCH 095/204] Step 9.3: Move Parties to collection.js

---
 imports/api/parties/collection.js | 15 +++++++++++++++
 1 file changed, 15 insertions(+)
 create mode 100644 imports/api/parties/collection.js

diff --git a/imports/api/parties/collection.js b/imports/api/parties/collection.js
new file mode 100644
index 0000000..3e283c1
--- /dev/null
+++ b/imports/api/parties/collection.js
@@ -0,0 +1,15 @@
+import { Mongo } from 'meteor/mongo';
+
+export const Parties = new Mongo.Collection('parties');
+
+Parties.allow({
+  insert(userId, party) {
+    return userId && party.owner === userId;
+  },
+  update(userId, party, fields, modifier) {
+    return userId && party.owner === userId;
+  },
+  remove(userId, party) {
+    return userId && party.owner === userId;
+  }
+});
-- 
2.5.0


From 5d428de6ec6d8402e66cc512b88c03c516d3baba Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:15:55 +0200
Subject: [PATCH 096/204] Step 9.4: Create entry point for Parties

---
 imports/api/parties/index.js | 3 +++
 1 file changed, 3 insertions(+)
 create mode 100644 imports/api/parties/index.js

diff --git a/imports/api/parties/index.js b/imports/api/parties/index.js
new file mode 100644
index 0000000..5f7ae00
--- /dev/null
+++ b/imports/api/parties/index.js
@@ -0,0 +1,3 @@
+import './publish';
+
+export * from './collection';
-- 
2.5.0


From a94e53b2d487178d0d4b9010c69e1c42051a7eec Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:16:11 +0200
Subject: [PATCH 097/204] Step 9.5: Remove old parties.js

---
 imports/api/parties.js | 15 ---------------
 1 file changed, 15 deletions(-)
 delete mode 100644 imports/api/parties.js

diff --git a/imports/api/parties.js b/imports/api/parties.js
deleted file mode 100644
index 3e283c1..0000000
--- a/imports/api/parties.js
+++ /dev/null
@@ -1,15 +0,0 @@
-import { Mongo } from 'meteor/mongo';
-
-export const Parties = new Mongo.Collection('parties');
-
-Parties.allow({
-  insert(userId, party) {
-    return userId && party.owner === userId;
-  },
-  update(userId, party, fields, modifier) {
-    return userId && party.owner === userId;
-  },
-  remove(userId, party) {
-    return userId && party.owner === userId;
-  }
-});
-- 
2.5.0


From 966218f340bc23fd95456a1ed85ef992870ae523 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:18:56 +0200
Subject: [PATCH 098/204] Step 9.6: Add the `parties` subscription

---
 imports/ui/components/partiesList/partiesList.js | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/imports/ui/components/partiesList/partiesList.js b/imports/ui/components/partiesList/partiesList.js
index bc00317..9f51859 100644
--- a/imports/ui/components/partiesList/partiesList.js
+++ b/imports/ui/components/partiesList/partiesList.js
@@ -13,6 +13,8 @@ class PartiesList {
 
     $reactive(this).attach($scope);
 
+    this.subscribe('parties');
+
     this.helpers({
       parties() {
         return Parties.find({});
-- 
2.5.0


From a54da563e16d005b12d4e865a2d7844d119d3f05 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:20:20 +0200
Subject: [PATCH 099/204] Step 9.7: Add public party checkbox to the add new
 party form

---
 imports/ui/components/partyAdd/partyAdd.html | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/imports/ui/components/partyAdd/partyAdd.html b/imports/ui/components/partyAdd/partyAdd.html
index 3508bef..4db1888 100644
--- a/imports/ui/components/partyAdd/partyAdd.html
+++ b/imports/ui/components/partyAdd/partyAdd.html
@@ -7,5 +7,9 @@
     Description:
   </label>
   <input type="text" ng-model="partyAdd.party.description" />
+  <label>
+    Public Party?
+  </label>
+  <input type="checkbox" ng-model="partyAdd.party.public">
   <button ng-click="partyAdd.submit()">Add Party!</button>
 </form>
-- 
2.5.0


From 6b23c0ee3a46b512e07c7a7b77612ec90851e93c Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:20:49 +0200
Subject: [PATCH 100/204] Step 9.8: Add is public checkbox to the party details
 view

---
 imports/ui/components/partyDetails/partyDetails.html | 1 +
 1 file changed, 1 insertion(+)

diff --git a/imports/ui/components/partyDetails/partyDetails.html b/imports/ui/components/partyDetails/partyDetails.html
index b5c939b..4e0cc68 100644
--- a/imports/ui/components/partyDetails/partyDetails.html
+++ b/imports/ui/components/partyDetails/partyDetails.html
@@ -2,6 +2,7 @@ The party your selected is:
 <form>
   Party name: <input type="text" ng-model="partyDetails.party.name" />
   Description: <input type="text" ng-model="partyDetails.party.description" />
+  Public Party? <input type="checkbox" ng-model="partyDetails.party.public">
   <button ng-click="partyDetails.save()">Save</button>
 </form>
 
-- 
2.5.0


From 3f66739d4d6154ef13eeef71d1f544ef7b4726d9 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:21:31 +0200
Subject: [PATCH 101/204] Step 9.9: Add is public checkbox to the party details
 component

---
 imports/ui/components/partyDetails/partyDetails.js | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/partyDetails/partyDetails.js b/imports/ui/components/partyDetails/partyDetails.js
index 12c05aa..678df71 100644
--- a/imports/ui/components/partyDetails/partyDetails.js
+++ b/imports/ui/components/partyDetails/partyDetails.js
@@ -30,7 +30,8 @@ class PartyDetails {
     }, {
       $set: {
         name: this.party.name,
-        description: this.party.description
+        description: this.party.description,
+        public: this.party.public
       }
     }, (error) => {
       if (error) {
-- 
2.5.0


From 941e24d1986b2a11c5991120f32a71f9d5237864 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:22:34 +0200
Subject: [PATCH 102/204] Step 9.10: Add `parties` subscription to the
 PartyDetails

---
 imports/ui/components/partyDetails/partyDetails.js | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/imports/ui/components/partyDetails/partyDetails.js b/imports/ui/components/partyDetails/partyDetails.js
index 678df71..c11b395 100644
--- a/imports/ui/components/partyDetails/partyDetails.js
+++ b/imports/ui/components/partyDetails/partyDetails.js
@@ -15,6 +15,8 @@ class PartyDetails {
 
     this.partyId = $stateParams.partyId;
 
+    this.subscribe('parties');
+
     this.helpers({
       party() {
         return Parties.findOne({
-- 
2.5.0


From c49ae4abc65785fd73e51b90c65287894db308db Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:24:09 +0200
Subject: [PATCH 103/204] Step 9.11: Create the users publication

---
 imports/api/users.js | 12 ++++++++++++
 1 file changed, 12 insertions(+)
 create mode 100644 imports/api/users.js

diff --git a/imports/api/users.js b/imports/api/users.js
new file mode 100644
index 0000000..4c9fee9
--- /dev/null
+++ b/imports/api/users.js
@@ -0,0 +1,12 @@
+import { Meteor } from 'meteor/meteor';
+
+if (Meteor.isServer) {
+  Meteor.publish('users', function() {
+    return Meteor.users.find({}, {
+      fields: {
+        emails: 1,
+        profile: 1
+      }
+    });
+  });
+}
-- 
2.5.0


From 986feb4f3c3866714d53377e629fb2e061924e98 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:24:32 +0200
Subject: [PATCH 104/204] Step 9.12: Add `users` publication to the server-side

---
 server/main.js | 1 +
 1 file changed, 1 insertion(+)

diff --git a/server/main.js b/server/main.js
index d4c97f0..1acdc6c 100644
--- a/server/main.js
+++ b/server/main.js
@@ -1,2 +1,3 @@
 import '../imports/startup/fixtures';
 import '../imports/api/parties';
+import '../imports/api/users';
-- 
2.5.0


From dbf1bad5ee2b9adfdb7848c61f4e2ca7bf513727 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:26:29 +0200
Subject: [PATCH 105/204] Step 9.13: Add `users` subscription and helper

---
 imports/ui/components/partyDetails/partyDetails.js | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/imports/ui/components/partyDetails/partyDetails.js b/imports/ui/components/partyDetails/partyDetails.js
index c11b395..bbaa7d7 100644
--- a/imports/ui/components/partyDetails/partyDetails.js
+++ b/imports/ui/components/partyDetails/partyDetails.js
@@ -16,12 +16,16 @@ class PartyDetails {
     this.partyId = $stateParams.partyId;
 
     this.subscribe('parties');
+    this.subscribe('users');
 
     this.helpers({
       party() {
         return Parties.findOne({
           _id: $stateParams.partyId
         });
+      },
+      users() {
+        return Meteor.users.find({});
       }
     });
   }
-- 
2.5.0


From 72bf829d9d6b09b18af7f7337b6fafad9f3dc129 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:27:20 +0200
Subject: [PATCH 106/204] Step 9.14: Add the users list to the party details
 view

---
 imports/ui/components/partyDetails/partyDetails.html | 7 +++++++
 1 file changed, 7 insertions(+)

diff --git a/imports/ui/components/partyDetails/partyDetails.html b/imports/ui/components/partyDetails/partyDetails.html
index 4e0cc68..99de077 100644
--- a/imports/ui/components/partyDetails/partyDetails.html
+++ b/imports/ui/components/partyDetails/partyDetails.html
@@ -7,3 +7,10 @@ The party your selected is:
 </form>
 
 <button ui-sref="parties">Back</button>
+
+<ul>
+  Users:
+  <li ng-repeat="user in partyDetails.users">
+    <div>{{ user.emails[0].address }}</div>
+  </li>
+</ul>
-- 
2.5.0


From f74eed7565882ecbf8b3919dc492cb2b0e4c4d76 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 15:44:26 +0200
Subject: [PATCH 107/204] Step 9.15: Update tests of PartyAdd

---
 imports/ui/components/partyAdd/client/partyAdd.tests.js | 16 ++++++++++++++--
 1 file changed, 14 insertions(+), 2 deletions(-)

diff --git a/imports/ui/components/partyAdd/client/partyAdd.tests.js b/imports/ui/components/partyAdd/client/partyAdd.tests.js
index cc1d35e..3d27875 100644
--- a/imports/ui/components/partyAdd/client/partyAdd.tests.js
+++ b/imports/ui/components/partyAdd/client/partyAdd.tests.js
@@ -1,3 +1,4 @@
+import { Meteor } from 'meteor/meteor';
 import { name as PartyAdd } from '../partyAdd';
 import { Parties } from '../../../../api/parties';
 import 'angular-mocks';
@@ -11,7 +12,11 @@ describe('PartyAdd', () => {
     let controller;
     const party = {
       name: 'Foo',
-      description: 'Birthday of Foo'
+      description: 'Birthday of Foo',
+      public: true
+    };
+    const user = {
+      _id: 'userId'
     };
 
     beforeEach(() => {
@@ -20,6 +25,8 @@ describe('PartyAdd', () => {
           $scope: $rootScope.$new(true)
         });
       });
+
+      spyOn(Meteor, 'user').and.returnValue(user);
     });
 
     describe('reset()', () => {
@@ -42,7 +49,12 @@ describe('PartyAdd', () => {
       });
 
       it('should insert a new party', () => {
-        expect(Parties.insert).toHaveBeenCalledWith(party);
+        expect(Parties.insert).toHaveBeenCalledWith({
+          name: party.name,
+          description: party.description,
+          public: party.public,
+          owner: user._id
+        });
       });
 
       it('should call reset()', () => {
-- 
2.5.0


From f66e2fd7e3412daa1ce5159cea4dcf1bc81106e2 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 15:45:37 +0200
Subject: [PATCH 108/204] Step 9.16: Update tests of PartyDetails

---
 imports/ui/components/partyDetails/client/partyDetails.tests.js | 6 ++++--
 1 file changed, 4 insertions(+), 2 deletions(-)

diff --git a/imports/ui/components/partyDetails/client/partyDetails.tests.js b/imports/ui/components/partyDetails/client/partyDetails.tests.js
index 997304e..0f3aa3b 100644
--- a/imports/ui/components/partyDetails/client/partyDetails.tests.js
+++ b/imports/ui/components/partyDetails/client/partyDetails.tests.js
@@ -12,7 +12,8 @@ describe('PartyDetails', () => {
     const party = {
       _id: 'partyId',
       name: 'Foo',
-      description: 'Birthday of Foo'
+      description: 'Birthday of Foo',
+      public: true
     };
 
     beforeEach(() => {
@@ -40,7 +41,8 @@ describe('PartyDetails', () => {
         expect(Parties.update.calls.mostRecent().args[1]).toEqual({
           $set: {
             name: party.name,
-            description: party.description
+            description: party.description,
+            public: party.public
           }
         });
       });
-- 
2.5.0


From 36de6067af814b8a92a2925af54341b61562ce96 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:29:01 +0200
Subject: [PATCH 109/204] Step 11.1: Update the module initialization

---
 client/main.js | 17 ++++++++++++++++-
 1 file changed, 16 insertions(+), 1 deletion(-)

diff --git a/client/main.js b/client/main.js
index 212f992..06731e1 100644
--- a/client/main.js
+++ b/client/main.js
@@ -1,4 +1,19 @@
 import angular from 'angular';
-import angularMeteor from 'angular-meteor';
+
+import { Meteor } from 'meteor/meteor';
 
 import { name as Socially } from '../imports/ui/components/socially/socially';
+
+function onReady() {
+  angular.bootstrap(document, [
+    Socially
+  ], {
+    strictDi: true
+  });
+}
+
+if (Meteor.isCordova) {
+  angular.element(document).on('deviceready', onReady);
+} else {
+  angular.element(document).ready(onReady);
+}
-- 
2.5.0


From 89cc58d684d51c383fdb35db487224ab786077cf Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:29:45 +0200
Subject: [PATCH 110/204] Step 11.2: Remove the ngApp and ngStrictDi

---
 client/index.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/client/index.html b/client/index.html
index 806f6ab..0a26426 100644
--- a/client/index.html
+++ b/client/index.html
@@ -1,6 +1,6 @@
 <head>
   <base href="/">
 </head>
-<body ng-app="socially" ng-strict-di="">
+<body>
   <socially></socially>
 </body>
-- 
2.5.0


From 29c8e401607a67e8314e57db763aafd5cafd67fc Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:32:51 +0200
Subject: [PATCH 111/204] Step 12.1: Add options to the parties publish

---
 imports/api/parties/publish.js | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/imports/api/parties/publish.js b/imports/api/parties/publish.js
index 590f23b..65b8f38 100644
--- a/imports/api/parties/publish.js
+++ b/imports/api/parties/publish.js
@@ -3,7 +3,7 @@ import { Meteor } from 'meteor/meteor';
 import { Parties } from './collection';
 
 if (Meteor.isServer) {
-  Meteor.publish('parties', function() {
+  Meteor.publish('parties', function(options) {
     const selector = {
       $or: [{
         // the public parties
@@ -26,6 +26,6 @@ if (Meteor.isServer) {
       }]
     };
 
-    return Parties.find(selector);
+    return Parties.find(selector, options);
   });
 }
-- 
2.5.0


From 297f0732b0897c531510dcd890cbc0253f123e45 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:33:40 +0200
Subject: [PATCH 112/204] Step 12.2: Add the pagination default params

---
 imports/ui/components/partiesList/partiesList.js | 6 ++++++
 1 file changed, 6 insertions(+)

diff --git a/imports/ui/components/partiesList/partiesList.js b/imports/ui/components/partiesList/partiesList.js
index 9f51859..a7a24ef 100644
--- a/imports/ui/components/partiesList/partiesList.js
+++ b/imports/ui/components/partiesList/partiesList.js
@@ -13,6 +13,12 @@ class PartiesList {
 
     $reactive(this).attach($scope);
 
+    this.perPage = 3;
+    this.page = 1;
+    this.sort = {
+      name: 1
+    };
+
     this.subscribe('parties');
 
     this.helpers({
-- 
2.5.0


From 1a61608885b3437c2ad6db7414d197316a7137e2 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:35:13 +0200
Subject: [PATCH 113/204] Step 12.3: Add the params to the subscription

---
 imports/ui/components/partiesList/partiesList.js | 6 +++++-
 1 file changed, 5 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/partiesList/partiesList.js b/imports/ui/components/partiesList/partiesList.js
index a7a24ef..f7c9a84 100644
--- a/imports/ui/components/partiesList/partiesList.js
+++ b/imports/ui/components/partiesList/partiesList.js
@@ -19,7 +19,11 @@ class PartiesList {
       name: 1
     };
 
-    this.subscribe('parties');
+    this.subscribe('parties', () => [{
+      limit: parseInt(this.perPage),
+      skip: parseInt((this.getReactively('page') - 1) * this.perPage),
+      sort: this.getReactively('sort')}
+    ]);
 
     this.helpers({
       parties() {
-- 
2.5.0


From a56cac7531da0271a7581d4c96e44b487a02e3c4 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:36:07 +0200
Subject: [PATCH 114/204] Step 12.4: Add the sort parameter to the collection
 helper

---
 imports/ui/components/partiesList/partiesList.js | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/partiesList/partiesList.js b/imports/ui/components/partiesList/partiesList.js
index f7c9a84..8902025 100644
--- a/imports/ui/components/partiesList/partiesList.js
+++ b/imports/ui/components/partiesList/partiesList.js
@@ -27,7 +27,9 @@ class PartiesList {
 
     this.helpers({
       parties() {
-        return Parties.find({});
+        return Parties.find({}, {
+          sort : this.getReactively('sort')
+        });
       }
     });
   }
-- 
2.5.0


From a8c24054354cf5f7af978c4654499d2a8a9047c2 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:37:39 +0200
Subject: [PATCH 115/204] Step 12.5: Install `angular-utils-pagination`

---
 package.json | 1 +
 1 file changed, 1 insertion(+)

diff --git a/package.json b/package.json
index a9636f0..227b0f3 100644
--- a/package.json
+++ b/package.json
@@ -9,6 +9,7 @@
     "angular": "^1.5.3",
     "angular-meteor": "^1.3.9",
     "angular-ui-router": "^1.0.0-alpha.4",
+    "angular-utils-pagination": "^0.11.1",
     "meteor-node-stubs": "~0.2.0"
   },
   "devDependencies": {
-- 
2.5.0


From 7d48605fe554c8e0a19231dd23e5794de9eb9cf0 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:38:35 +0200
Subject: [PATCH 116/204] Step 12.6: Add new dependency

---
 imports/ui/components/partiesList/partiesList.js | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/imports/ui/components/partiesList/partiesList.js b/imports/ui/components/partiesList/partiesList.js
index 8902025..cc5358a 100644
--- a/imports/ui/components/partiesList/partiesList.js
+++ b/imports/ui/components/partiesList/partiesList.js
@@ -1,6 +1,7 @@
 import angular from 'angular';
 import angularMeteor from 'angular-meteor';
 import uiRouter from 'angular-ui-router';
+import utilsPagination from 'angular-utils-pagination';
 
 import './partiesList.html';
 import { Parties } from '../../../api/parties';
@@ -41,6 +42,7 @@ const name = 'partiesList';
 export default angular.module(name, [
   angularMeteor,
   uiRouter,
+  utilsPagination,
   PartyAdd,
   PartyRemove
 ]).component(name, {
-- 
2.5.0


From 8fda8958ebe4aa2e79b9efc8e4607648e7e63145 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:39:32 +0200
Subject: [PATCH 117/204] Step 12.7: Add usage to the dir-pagination directive

---
 imports/ui/components/partiesList/partiesList.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/imports/ui/components/partiesList/partiesList.html b/imports/ui/components/partiesList/partiesList.html
index c1b07e2..71b36ae 100644
--- a/imports/ui/components/partiesList/partiesList.html
+++ b/imports/ui/components/partiesList/partiesList.html
@@ -1,7 +1,7 @@
 <party-add></party-add>
 
 <ul>
-  <li ng-repeat="party in partiesList.parties">
+  <li dir-paginate="party in partiesList.parties | itemsPerPage: partiesList.perPage" total-items="partiesList.partiesCount">
     <a ui-sref="partyDetails({ partyId: party._id })">
       {{party.name}}
     </a>
-- 
2.5.0


From 2646dbb8dea8e464f4a8d86701ec86aaf1362ad4 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:39:54 +0200
Subject: [PATCH 118/204] Step 12.8: Add the pagination controls to the view

---
 imports/ui/components/partiesList/partiesList.html | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/imports/ui/components/partiesList/partiesList.html b/imports/ui/components/partiesList/partiesList.html
index 71b36ae..d4206d6 100644
--- a/imports/ui/components/partiesList/partiesList.html
+++ b/imports/ui/components/partiesList/partiesList.html
@@ -9,3 +9,5 @@
     <party-remove party="party"></party-remove>
   </li>
 </ul>
+
+<dir-pagination-controls on-page-change="partiesList.pageChanged(newPageNumber)"></dir-pagination-controls>
-- 
2.5.0


From 9fd7c292c7ee84a388422aa0499efec8309bba3e Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:40:29 +0200
Subject: [PATCH 119/204] Step 12.9: Add the pageChanged method to the
 component

---
 imports/ui/components/partiesList/partiesList.js | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/imports/ui/components/partiesList/partiesList.js b/imports/ui/components/partiesList/partiesList.js
index cc5358a..588727e 100644
--- a/imports/ui/components/partiesList/partiesList.js
+++ b/imports/ui/components/partiesList/partiesList.js
@@ -34,6 +34,10 @@ class PartiesList {
       }
     });
   }
+
+  pageChanged(newPage) {
+    this.page = newPage;
+  }
 }
 
 const name = 'partiesList';
-- 
2.5.0


From d9da14787fb7fe3fc5e38949b81846184dab63ea Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:41:20 +0200
Subject: [PATCH 120/204] Step 12.10: Add `tmeasday:publish-counts`

---
 .meteor/packages | 1 +
 .meteor/versions | 1 +
 2 files changed, 2 insertions(+)

diff --git a/.meteor/packages b/.meteor/packages
index 110dde9..2525c04 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -24,3 +24,4 @@ accounts-password
 dotansimha:accounts-ui-angular
 accounts-facebook
 accounts-twitter
+tmeasday:publish-counts
diff --git a/.meteor/versions b/.meteor/versions
index 2d7c2e7..b44d0e4 100644
--- a/.meteor/versions
+++ b/.meteor/versions
@@ -89,6 +89,7 @@ standard-minifier-js@1.0.4
 templating@1.1.7
 templating-tools@1.0.2
 tmeasday:check-npm-versions@0.1.1
+tmeasday:publish-counts@0.7.3
 tracker@1.0.11
 twitter@1.1.7
 ui@1.0.9
-- 
2.5.0


From b7448442438a7daa6843e4c20976eb95f49a69d4 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:42:27 +0200
Subject: [PATCH 121/204] Step 12.11: Add usage of Counts

---
 imports/api/parties/publish.js | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/imports/api/parties/publish.js b/imports/api/parties/publish.js
index 65b8f38..4932df2 100644
--- a/imports/api/parties/publish.js
+++ b/imports/api/parties/publish.js
@@ -1,4 +1,5 @@
 import { Meteor } from 'meteor/meteor';
+import { Counts } from 'meteor/tmeasday:publish-counts';
 
 import { Parties } from './collection';
 
@@ -26,6 +27,10 @@ if (Meteor.isServer) {
       }]
     };
 
+    Counts.publish(this, 'numberOfParties', Parties.find(selector), {
+      noReady: true
+    });
+
     return Parties.find(selector, options);
   });
 }
-- 
2.5.0


From cba3fa6386616a51da971e4be32c9da6b2fded3e Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:44:44 +0200
Subject: [PATCH 122/204] Step 12.12: Add the Count usage in the component

---
 imports/ui/components/partiesList/partiesList.js | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/imports/ui/components/partiesList/partiesList.js b/imports/ui/components/partiesList/partiesList.js
index 588727e..f0e20e8 100644
--- a/imports/ui/components/partiesList/partiesList.js
+++ b/imports/ui/components/partiesList/partiesList.js
@@ -3,6 +3,8 @@ import angularMeteor from 'angular-meteor';
 import uiRouter from 'angular-ui-router';
 import utilsPagination from 'angular-utils-pagination';
 
+import { Counts } from 'meteor/tmeasday:publish-counts';
+
 import './partiesList.html';
 import { Parties } from '../../../api/parties';
 import { name as PartyAdd } from '../partyAdd/partyAdd';
@@ -31,6 +33,9 @@ class PartiesList {
         return Parties.find({}, {
           sort : this.getReactively('sort')
         });
+      },
+      partiesCount() {
+        return Counts.get('numberOfParties');
       }
     });
   }
-- 
2.5.0


From ca035b777f22e3ace1b8ac4d471b1d4d86cf98f3 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:47:04 +0200
Subject: [PATCH 123/204] Step 12.13: Create view for PartiesSort component

---
 imports/ui/components/partiesSort/partiesSort.html | 6 ++++++
 1 file changed, 6 insertions(+)
 create mode 100644 imports/ui/components/partiesSort/partiesSort.html

diff --git a/imports/ui/components/partiesSort/partiesSort.html b/imports/ui/components/partiesSort/partiesSort.html
new file mode 100644
index 0000000..cf2102b
--- /dev/null
+++ b/imports/ui/components/partiesSort/partiesSort.html
@@ -0,0 +1,6 @@
+<div>
+  <select ng-model="partiesSort.order" ng-change="partiesSort.changed()">
+    <option value="1">Ascending</option>
+    <option value="-1">Descending</option>
+  </select>
+</div>
-- 
2.5.0


From ee1a29518510378eea95215286cb73ddc346584a Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:48:25 +0200
Subject: [PATCH 124/204] Step 12.14: Create PartiesSort component

---
 imports/ui/components/partiesSort/partiesSort.js | 34 ++++++++++++++++++++++++
 1 file changed, 34 insertions(+)
 create mode 100644 imports/ui/components/partiesSort/partiesSort.js

diff --git a/imports/ui/components/partiesSort/partiesSort.js b/imports/ui/components/partiesSort/partiesSort.js
new file mode 100644
index 0000000..f18b84d
--- /dev/null
+++ b/imports/ui/components/partiesSort/partiesSort.js
@@ -0,0 +1,34 @@
+import angular from 'angular';
+import angularMeteor from 'angular-meteor';
+
+import './partiesSort.html';
+
+class PartiesSort {
+  constructor() {
+    this.changed();
+  }
+
+  changed() {
+    this.onChange({
+      sort: {
+        [this.property]: parseInt(this.order)
+      }
+    });
+  }
+}
+
+const name = 'partiesSort';
+
+// create a module
+export default angular.module(name, [
+  angularMeteor
+]).component(name, {
+  templateUrl: `imports/ui/components/${name}/${name}.html`,
+  bindings: {
+    onChange: '&',
+    property: '@',
+    order: '@'
+  },
+  controllerAs: name,
+  controller: PartiesSort
+});
-- 
2.5.0


From 751ca90293d429ed792771ca1fd73b297b28f85b Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:49:26 +0200
Subject: [PATCH 125/204] Step 12.15: Add as a dependency

---
 imports/ui/components/partiesList/partiesList.js | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/imports/ui/components/partiesList/partiesList.js b/imports/ui/components/partiesList/partiesList.js
index f0e20e8..9d9f1bf 100644
--- a/imports/ui/components/partiesList/partiesList.js
+++ b/imports/ui/components/partiesList/partiesList.js
@@ -7,6 +7,7 @@ import { Counts } from 'meteor/tmeasday:publish-counts';
 
 import './partiesList.html';
 import { Parties } from '../../../api/parties';
+import { name as PartiesSort } from '../partiesSort/partiesSort';
 import { name as PartyAdd } from '../partyAdd/partyAdd';
 import { name as PartyRemove } from '../partyRemove/partyRemove';
 
@@ -52,6 +53,7 @@ export default angular.module(name, [
   angularMeteor,
   uiRouter,
   utilsPagination,
+  PartiesSort,
   PartyAdd,
   PartyRemove
 ]).component(name, {
-- 
2.5.0


From e4930469dce23486da3bfd729a22c6818864e7fe Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:50:20 +0200
Subject: [PATCH 126/204] Step 12.16: Implement component

---
 imports/ui/components/partiesList/partiesList.html | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/imports/ui/components/partiesList/partiesList.html b/imports/ui/components/partiesList/partiesList.html
index d4206d6..0fe847e 100644
--- a/imports/ui/components/partiesList/partiesList.html
+++ b/imports/ui/components/partiesList/partiesList.html
@@ -1,5 +1,7 @@
 <party-add></party-add>
 
+<parties-sort on-change="partiesList.sortChanged(sort)" property="name" order="1"></parties-sort>
+
 <ul>
   <li dir-paginate="party in partiesList.parties | itemsPerPage: partiesList.perPage" total-items="partiesList.partiesCount">
     <a ui-sref="partyDetails({ partyId: party._id })">
-- 
2.5.0


From 037255254fcaf7cfb0e480299a60e888abd9be46 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 12:51:09 +0200
Subject: [PATCH 127/204] Step 12.17: Handle sort changes

---
 imports/ui/components/partiesList/partiesList.js | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/imports/ui/components/partiesList/partiesList.js b/imports/ui/components/partiesList/partiesList.js
index 9d9f1bf..b222c3a 100644
--- a/imports/ui/components/partiesList/partiesList.js
+++ b/imports/ui/components/partiesList/partiesList.js
@@ -44,6 +44,10 @@ class PartiesList {
   pageChanged(newPage) {
     this.page = newPage;
   }
+
+  sortChanged(sort) {
+    this.sort = sort;
+  }
 }
 
 const name = 'partiesList';
-- 
2.5.0


From a8f8c472572972c7f2e547b3308ab9d2d780526a Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 16:12:35 +0200
Subject: [PATCH 128/204] Step 12.18: Add searchString to `parties` publication

---
 imports/api/parties/publish.js | 9 ++++++++-
 1 file changed, 8 insertions(+), 1 deletion(-)

diff --git a/imports/api/parties/publish.js b/imports/api/parties/publish.js
index 4932df2..67c9bdb 100644
--- a/imports/api/parties/publish.js
+++ b/imports/api/parties/publish.js
@@ -4,7 +4,7 @@ import { Counts } from 'meteor/tmeasday:publish-counts';
 import { Parties } from './collection';
 
 if (Meteor.isServer) {
-  Meteor.publish('parties', function(options) {
+  Meteor.publish('parties', function(options, searchString) {
     const selector = {
       $or: [{
         // the public parties
@@ -27,6 +27,13 @@ if (Meteor.isServer) {
       }]
     };
 
+    if (typeof searchString === 'string' && searchString.length) {
+      selector.name = {
+        $regex: `.*${searchString}.*`,
+        $options : 'i'
+      };
+    }
+
     Counts.publish(this, 'numberOfParties', Parties.find(selector), {
       noReady: true
     });
-- 
2.5.0


From 503f3d25de3aba4d5c9d4bd07d599cc2c2f39e0b Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 16:15:46 +0200
Subject: [PATCH 129/204] Step 12.19: Add searchText to subscription

---
 imports/ui/components/partiesList/partiesList.js | 8 +++++---
 1 file changed, 5 insertions(+), 3 deletions(-)

diff --git a/imports/ui/components/partiesList/partiesList.js b/imports/ui/components/partiesList/partiesList.js
index b222c3a..ee2dc70 100644
--- a/imports/ui/components/partiesList/partiesList.js
+++ b/imports/ui/components/partiesList/partiesList.js
@@ -22,11 +22,13 @@ class PartiesList {
     this.sort = {
       name: 1
     };
+    this.searchText = '';
 
     this.subscribe('parties', () => [{
-      limit: parseInt(this.perPage),
-      skip: parseInt((this.getReactively('page') - 1) * this.perPage),
-      sort: this.getReactively('sort')}
+        limit: parseInt(this.perPage),
+        skip: parseInt((this.getReactively('page') - 1) * this.perPage),
+        sort: this.getReactively('sort')
+      }, this.getReactively('searchText')
     ]);
 
     this.helpers({
-- 
2.5.0


From 91d8e76f444437bef0b9880c1f82eb7b01fc7317 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 16:16:30 +0200
Subject: [PATCH 130/204] Step 12.20: Add input with searchText as ngModel

---
 imports/ui/components/partiesList/partiesList.html | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/imports/ui/components/partiesList/partiesList.html b/imports/ui/components/partiesList/partiesList.html
index 0fe847e..3c411fe 100644
--- a/imports/ui/components/partiesList/partiesList.html
+++ b/imports/ui/components/partiesList/partiesList.html
@@ -1,5 +1,7 @@
 <party-add></party-add>
 
+<input type="search" ng-model="partiesList.searchText" placeholder="Search" />
+
 <parties-sort on-change="partiesList.sortChanged(sort)" property="name" order="1"></parties-sort>
 
 <ul>
-- 
2.5.0


From 13390ac2612f03e5e44811d7e2568353558aefb2 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 15:59:07 +0200
Subject: [PATCH 131/204] Step 12.21: Tests of PartiesSort

---
 .../partiesSort/client/partiesSort.tests.js        | 54 ++++++++++++++++++++++
 1 file changed, 54 insertions(+)
 create mode 100644 imports/ui/components/partiesSort/client/partiesSort.tests.js

diff --git a/imports/ui/components/partiesSort/client/partiesSort.tests.js b/imports/ui/components/partiesSort/client/partiesSort.tests.js
new file mode 100644
index 0000000..09d81b4
--- /dev/null
+++ b/imports/ui/components/partiesSort/client/partiesSort.tests.js
@@ -0,0 +1,54 @@
+import { name as PartiesSort } from '../partiesSort';
+import 'angular-mocks';
+
+describe('PartiesSort', () => {
+  beforeEach(() => {
+    window.module(PartiesSort);
+  });
+
+  describe('controller', () => {
+    let controller;
+    const onChange = function() {};
+    const property = 'name';
+    const order = -1;
+
+
+    beforeEach(() => {
+      inject(($rootScope, $componentController) => {
+        controller = $componentController(PartiesSort, {
+          $scope: $rootScope.$new(true)
+        }, {
+          onChange,
+          property,
+          order
+        });
+      });
+    });
+
+    it('should set property', () => {
+      expect(controller.property).toEqual(property);
+    });
+
+    it('should set order', () => {
+      expect(controller.order).toEqual(order);
+    });
+
+    it('should set onChange', () => {
+      expect(controller.onChange).toBe(onChange);
+    });
+
+    describe('changed()', () => {
+      it('should call onChange expression', () => {
+        spyOn(controller, 'onChange');
+
+        controller.changed();
+
+        expect(controller.onChange).toHaveBeenCalledWith({
+          sort: {
+            [property]: order
+          }
+        });
+      });
+    });
+  });
+});
-- 
2.5.0


From 627ee55917d01d6d9342e1c395abf951020291fd Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 16:07:14 +0200
Subject: [PATCH 132/204] Step 12.22: Tests of PartiesList

---
 .../partiesList/client/partiesList.tests.js        | 50 ++++++++++++++++++++++
 1 file changed, 50 insertions(+)
 create mode 100644 imports/ui/components/partiesList/client/partiesList.tests.js

diff --git a/imports/ui/components/partiesList/client/partiesList.tests.js b/imports/ui/components/partiesList/client/partiesList.tests.js
new file mode 100644
index 0000000..176da85
--- /dev/null
+++ b/imports/ui/components/partiesList/client/partiesList.tests.js
@@ -0,0 +1,50 @@
+import { name as PartiesList } from '../partiesList';
+import 'angular-mocks';
+
+describe('PartiesList', () => {
+  beforeEach(() => {
+    window.module(PartiesList);
+  });
+
+  describe('controller', () => {
+    let controller;
+
+    beforeEach(() => {
+      inject(($rootScope, $componentController) => {
+        controller = $componentController(PartiesList, {
+          $scope: $rootScope.$new(true)
+        });
+      });
+    });
+
+    it('should have perPage that equals 3 by default', () => {
+      expect(controller.perPage).toEqual(3);
+    });
+
+    it('should have page that equals 1 by default', () => {
+      expect(controller.page).toEqual(1);
+    });
+
+    it('should sort by name - ASC', () => {
+      expect(controller.sort).toEqual({
+        name: 1
+      });
+    });
+
+    it('should be able to change sorting', () => {
+      controller.sortChanged({
+        name: -1
+      });
+
+      expect(controller.sort).toEqual({
+        name: -1
+      });
+    });
+
+    it('should be able to change page', () => {
+      controller.pageChanged(2);
+
+      expect(controller.page).toEqual(2);
+    });
+  });
+});
-- 
2.5.0


From b1cfef941d13aa4edb99ef7b05b56a94b9713742 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 16:23:07 +0200
Subject: [PATCH 133/204] Step 13.1: Create UninvitedFilter

---
 imports/ui/filters/uninvitedFilter.js | 20 ++++++++++++++++++++
 1 file changed, 20 insertions(+)
 create mode 100644 imports/ui/filters/uninvitedFilter.js

diff --git a/imports/ui/filters/uninvitedFilter.js b/imports/ui/filters/uninvitedFilter.js
new file mode 100644
index 0000000..77528fc
--- /dev/null
+++ b/imports/ui/filters/uninvitedFilter.js
@@ -0,0 +1,20 @@
+import angular from 'angular';
+
+const name = 'uninvitedFilter';
+
+function UninvitedFilter(users, party) {
+  if (!party) {
+    return false;
+  }
+
+  return users.filter((user) => {
+    // if not the owner and not invited
+    return user._id !== party.owner && (party.invited || []).indexOf(user._id) === -1;
+  });
+}
+
+// create a module
+export default angular.module(name, [])
+  .filter(name, () => {
+    return UninvitedFilter;
+  });
-- 
2.5.0


From afdf8a63d2f3e0ab0d392fa681dbdd973d41b5d6 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 16:24:04 +0200
Subject: [PATCH 134/204] Step 13.2: Install `underscore`

---
 package.json | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/package.json b/package.json
index 227b0f3..6d220f0 100644
--- a/package.json
+++ b/package.json
@@ -10,7 +10,8 @@
     "angular-meteor": "^1.3.9",
     "angular-ui-router": "^1.0.0-alpha.4",
     "angular-utils-pagination": "^0.11.1",
-    "meteor-node-stubs": "~0.2.0"
+    "meteor-node-stubs": "~0.2.0",
+    "underscore": "^1.8.3"
   },
   "devDependencies": {
     "angular-mocks": "^1.5.3"
-- 
2.5.0


From 07c91efc1b6565cb8ddf8f4b4c79995424c87d12 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 16:24:21 +0200
Subject: [PATCH 135/204] Step 13.3: Use underscore

---
 imports/ui/filters/uninvitedFilter.js | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/imports/ui/filters/uninvitedFilter.js b/imports/ui/filters/uninvitedFilter.js
index 77528fc..cfe8d2d 100644
--- a/imports/ui/filters/uninvitedFilter.js
+++ b/imports/ui/filters/uninvitedFilter.js
@@ -1,4 +1,5 @@
 import angular from 'angular';
+import _ from 'underscore';
 
 const name = 'uninvitedFilter';
 
@@ -9,7 +10,7 @@ function UninvitedFilter(users, party) {
 
   return users.filter((user) => {
     // if not the owner and not invited
-    return user._id !== party.owner && (party.invited || []).indexOf(user._id) === -1;
+    return user._id !== party.owner && !_.contains(party.invited, user._id);
   });
 }
 
-- 
2.5.0


From fd350ff7552fc51d889ac2adb52319de80b518a2 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 16:26:20 +0200
Subject: [PATCH 136/204] Step 13.4: Move list of users to separate component

---
 imports/ui/components/partyUninvited/partyUninvited.html | 6 ++++++
 1 file changed, 6 insertions(+)
 create mode 100644 imports/ui/components/partyUninvited/partyUninvited.html

diff --git a/imports/ui/components/partyUninvited/partyUninvited.html b/imports/ui/components/partyUninvited/partyUninvited.html
new file mode 100644
index 0000000..ac0bbc7
--- /dev/null
+++ b/imports/ui/components/partyUninvited/partyUninvited.html
@@ -0,0 +1,6 @@
+<ul>
+  Users:
+  <li ng-repeat="user in partyUninvited.users">
+    <div>{{ user.emails[0].address }}</div>
+  </li>
+</ul>
-- 
2.5.0


From f1d9980cf81a3145086f6c693a66eee96ba12fad Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 16:30:02 +0200
Subject: [PATCH 137/204] Step 13.5: Create PartyUninvited component

---
 .../ui/components/partyUninvited/partyUninvited.js | 34 ++++++++++++++++++++++
 1 file changed, 34 insertions(+)
 create mode 100644 imports/ui/components/partyUninvited/partyUninvited.js

diff --git a/imports/ui/components/partyUninvited/partyUninvited.js b/imports/ui/components/partyUninvited/partyUninvited.js
new file mode 100644
index 0000000..36c99df
--- /dev/null
+++ b/imports/ui/components/partyUninvited/partyUninvited.js
@@ -0,0 +1,34 @@
+import angular from 'angular';
+import angularMeteor from 'angular-meteor';
+
+import { Meteor } from 'meteor/meteor';
+
+import './partyUninvited.html';
+
+class PartyUninvited {
+  constructor($scope) {
+    'ngInject';
+
+    $scope.viewModel(this);
+
+    this.helpers({
+      users() {
+        return Meteor.users.find({});
+      }
+    });
+  }
+}
+
+const name = 'partyUninvited';
+
+// create a module
+export default angular.module(name, [
+  angularMeteor
+]).component(name, {
+  templateUrl: `imports/ui/components/${name}/${name}.html`,
+  controllerAs: name,
+  bindings: {
+    party: '<'
+  },
+  controller: PartyUninvited
+});
-- 
2.5.0


From c8218a25bf5269bc4fc58c78ac869ee3b4bbe7a4 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 16:30:46 +0200
Subject: [PATCH 138/204] Step 13.6: Add UninvitedFilter

---
 imports/ui/components/partyUninvited/partyUninvited.js | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/partyUninvited/partyUninvited.js b/imports/ui/components/partyUninvited/partyUninvited.js
index 36c99df..caba948 100644
--- a/imports/ui/components/partyUninvited/partyUninvited.js
+++ b/imports/ui/components/partyUninvited/partyUninvited.js
@@ -4,6 +4,7 @@ import angularMeteor from 'angular-meteor';
 import { Meteor } from 'meteor/meteor';
 
 import './partyUninvited.html';
+import { name as UninvitedFilter } from '../../filters/uninvitedFilter';
 
 class PartyUninvited {
   constructor($scope) {
@@ -23,7 +24,8 @@ const name = 'partyUninvited';
 
 // create a module
 export default angular.module(name, [
-  angularMeteor
+  angularMeteor,
+  UninvitedFilter
 ]).component(name, {
   templateUrl: `imports/ui/components/${name}/${name}.html`,
   controllerAs: name,
-- 
2.5.0


From a940b20fc969ccded0f75faca470fb71a52979ab Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 16:31:26 +0200
Subject: [PATCH 139/204] Step 13.7: Implement filter

---
 imports/ui/components/partyUninvited/partyUninvited.html | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/imports/ui/components/partyUninvited/partyUninvited.html b/imports/ui/components/partyUninvited/partyUninvited.html
index ac0bbc7..c1ccda5 100644
--- a/imports/ui/components/partyUninvited/partyUninvited.html
+++ b/imports/ui/components/partyUninvited/partyUninvited.html
@@ -1,6 +1,6 @@
 <ul>
-  Users:
-  <li ng-repeat="user in partyUninvited.users">
+  Users to invite:
+  <li ng-repeat="user in partyUninvited.users | uninvitedFilter:partyUninvited.party">
     <div>{{ user.emails[0].address }}</div>
   </li>
 </ul>
-- 
2.5.0


From a0e0676d0842d7417af1cbbad959e4fc2d257863 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 16:32:22 +0200
Subject: [PATCH 140/204] Step 13.8: Implement component in PartyDetails view

---
 imports/ui/components/partyDetails/partyDetails.html | 7 +------
 1 file changed, 1 insertion(+), 6 deletions(-)

diff --git a/imports/ui/components/partyDetails/partyDetails.html b/imports/ui/components/partyDetails/partyDetails.html
index 99de077..916f23e 100644
--- a/imports/ui/components/partyDetails/partyDetails.html
+++ b/imports/ui/components/partyDetails/partyDetails.html
@@ -8,9 +8,4 @@ The party your selected is:
 
 <button ui-sref="parties">Back</button>
 
-<ul>
-  Users:
-  <li ng-repeat="user in partyDetails.users">
-    <div>{{ user.emails[0].address }}</div>
-  </li>
-</ul>
+<party-uninvited party="partyDetails.party"></party-uninvited>
-- 
2.5.0


From 4e0ff7fa58368947c996b560562a087dfdfcf362 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 16:33:20 +0200
Subject: [PATCH 141/204] Step 13.9: Add to dependencies

---
 imports/ui/components/partyDetails/partyDetails.js | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/partyDetails/partyDetails.js b/imports/ui/components/partyDetails/partyDetails.js
index bbaa7d7..21bf1a3 100644
--- a/imports/ui/components/partyDetails/partyDetails.js
+++ b/imports/ui/components/partyDetails/partyDetails.js
@@ -6,6 +6,7 @@ import { Meteor } from 'meteor/meteor';
 
 import './partyDetails.html';
 import { Parties } from '../../../api/parties';
+import { name as PartyUninvited } from '../partyUninvited/partyUninvited';
 
 class PartyDetails {
   constructor($stateParams, $scope, $reactive) {
@@ -54,7 +55,8 @@ const name = 'partyDetails';
 // create a module
 export default angular.module(name, [
   angularMeteor,
-  uiRouter
+  uiRouter,
+  PartyUninvited
 ]).component(name, {
   templateUrl: `imports/ui/components/${name}/${name}.html`,
   controllerAs: name,
-- 
2.5.0


From 69e3b7fd3a9ae7478e53a5430a75be823de49b12 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 16:40:30 +0200
Subject: [PATCH 142/204] Step 13.10: Create DisplayNameFilter

---
 imports/ui/filters/displayNameFilter.js | 25 +++++++++++++++++++++++++
 1 file changed, 25 insertions(+)
 create mode 100644 imports/ui/filters/displayNameFilter.js

diff --git a/imports/ui/filters/displayNameFilter.js b/imports/ui/filters/displayNameFilter.js
new file mode 100644
index 0000000..57d9250
--- /dev/null
+++ b/imports/ui/filters/displayNameFilter.js
@@ -0,0 +1,25 @@
+import angular from 'angular';
+
+const name = 'displayNameFilter';
+
+function DisplayNameFilter(user) {
+  if (!user) {
+    return '';
+  }
+
+  if (user.profile && user.profile.name) {
+    return user.profile.name;
+  }
+
+  if (user.emails) {
+    return user.emails[0].address;
+  }
+
+  return user;
+}
+
+// create a module
+export default angular.module(name, [])
+  .filter(name, () => {
+    return DisplayNameFilter;
+  });
-- 
2.5.0


From efff4b4ac1567cd5f47a73fad8435d75dd9108eb Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 16:41:15 +0200
Subject: [PATCH 143/204] Step 13.11: Add as a dependency

---
 imports/ui/components/partyUninvited/partyUninvited.js | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/partyUninvited/partyUninvited.js b/imports/ui/components/partyUninvited/partyUninvited.js
index caba948..4ec5ade 100644
--- a/imports/ui/components/partyUninvited/partyUninvited.js
+++ b/imports/ui/components/partyUninvited/partyUninvited.js
@@ -5,6 +5,7 @@ import { Meteor } from 'meteor/meteor';
 
 import './partyUninvited.html';
 import { name as UninvitedFilter } from '../../filters/uninvitedFilter';
+import { name as DisplayNameFilter } from '../../filters/displayNameFilter';
 
 class PartyUninvited {
   constructor($scope) {
@@ -25,7 +26,8 @@ const name = 'partyUninvited';
 // create a module
 export default angular.module(name, [
   angularMeteor,
-  UninvitedFilter
+  UninvitedFilter,
+  DisplayNameFilter
 ]).component(name, {
   templateUrl: `imports/ui/components/${name}/${name}.html`,
   controllerAs: name,
-- 
2.5.0


From be315fec5ca5bfd7ce9cb21c1558fbd6dec3c4af Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 16:41:54 +0200
Subject: [PATCH 144/204] Step 13.12: Use filter

---
 imports/ui/components/partyUninvited/partyUninvited.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/imports/ui/components/partyUninvited/partyUninvited.html b/imports/ui/components/partyUninvited/partyUninvited.html
index c1ccda5..9603f3a 100644
--- a/imports/ui/components/partyUninvited/partyUninvited.html
+++ b/imports/ui/components/partyUninvited/partyUninvited.html
@@ -1,6 +1,6 @@
 <ul>
   Users to invite:
   <li ng-repeat="user in partyUninvited.users | uninvitedFilter:partyUninvited.party">
-    <div>{{ user.emails[0].address }}</div>
+    <div>{{ user | displayNameFilter }}</div>
   </li>
 </ul>
-- 
2.5.0


From 3a74fa0ee065037f5846c8610917d684ccc4af4b Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 16:45:34 +0200
Subject: [PATCH 145/204] Step 13.13: Create template for PartyCreator
 component

---
 imports/ui/components/partyCreator/partyCreator.html | 5 +++++
 1 file changed, 5 insertions(+)
 create mode 100644 imports/ui/components/partyCreator/partyCreator.html

diff --git a/imports/ui/components/partyCreator/partyCreator.html b/imports/ui/components/partyCreator/partyCreator.html
new file mode 100644
index 0000000..de986fb
--- /dev/null
+++ b/imports/ui/components/partyCreator/partyCreator.html
@@ -0,0 +1,5 @@
+<p>
+  <small>
+    Posted by {{ partyCreator.creator | displayNameFilter }}
+  </small>
+</p>
-- 
2.5.0


From 85b9dbb5c3039567186a66df4339961fe7e720e0 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 16:45:54 +0200
Subject: [PATCH 146/204] Step 13.14: Create PartyCreator component

---
 imports/ui/components/partyCreator/partyCreator.js | 49 ++++++++++++++++++++++
 1 file changed, 49 insertions(+)
 create mode 100644 imports/ui/components/partyCreator/partyCreator.js

diff --git a/imports/ui/components/partyCreator/partyCreator.js b/imports/ui/components/partyCreator/partyCreator.js
new file mode 100644
index 0000000..4f764b0
--- /dev/null
+++ b/imports/ui/components/partyCreator/partyCreator.js
@@ -0,0 +1,49 @@
+import angular from 'angular';
+import angularMeteor from 'angular-meteor';
+
+import { Meteor } from 'meteor/meteor';
+
+import './partyCreator.html';
+import { name as DisplayNameFilter } from '../../filters/displayNameFilter';
+
+/**
+ * PartyCreator component
+ */
+class PartyCreator {
+  constructor($scope) {
+    'ngInject';
+
+    $scope.viewModel(this);
+
+    this.helpers({
+      creator() {
+        if (!this.party) {
+          return '';
+        }
+
+        const owner = this.party.owner;
+
+        if (Meteor.userId() !== null && owner === Meteor.userId()) {
+          return 'me';
+        }
+
+        return Meteor.users.findOne(owner) || 'nobody';
+      }
+    });
+  }
+}
+
+const name = 'partyCreator';
+
+// create a module
+export default angular.module(name, [
+  angularMeteor,
+  DisplayNameFilter
+]).component(name, {
+  templateUrl: `imports/ui/components/${name}/${name}.html`,
+  controllerAs: name,
+  bindings: {
+    party: '<'
+  },
+  controller: PartyCreator
+});
-- 
2.5.0


From 55e111f079257090eef106a8ffebb653022b618e Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 16:46:14 +0200
Subject: [PATCH 147/204] Step 13.15: Implement component

---
 imports/ui/components/partiesList/partiesList.html | 1 +
 1 file changed, 1 insertion(+)

diff --git a/imports/ui/components/partiesList/partiesList.html b/imports/ui/components/partiesList/partiesList.html
index 3c411fe..2b18723 100644
--- a/imports/ui/components/partiesList/partiesList.html
+++ b/imports/ui/components/partiesList/partiesList.html
@@ -11,6 +11,7 @@
     </a>
     <p>{{party.description}}</p>
     <party-remove party="party"></party-remove>
+    <party-creator party="party"></party-creator>
   </li>
 </ul>
 
-- 
2.5.0


From a13fd8586c8aa184b1579c8baaab7888e80f9387 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 16:46:39 +0200
Subject: [PATCH 148/204] Step 13.16: Add as a dependency

---
 imports/ui/components/partiesList/partiesList.js | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/partiesList/partiesList.js b/imports/ui/components/partiesList/partiesList.js
index ee2dc70..b84a560 100644
--- a/imports/ui/components/partiesList/partiesList.js
+++ b/imports/ui/components/partiesList/partiesList.js
@@ -10,6 +10,7 @@ import { Parties } from '../../../api/parties';
 import { name as PartiesSort } from '../partiesSort/partiesSort';
 import { name as PartyAdd } from '../partyAdd/partyAdd';
 import { name as PartyRemove } from '../partyRemove/partyRemove';
+import { name as PartyCreator } from '../partyCreator/partyCreator';
 
 class PartiesList {
   constructor($scope, $reactive) {
@@ -61,7 +62,8 @@ export default angular.module(name, [
   utilsPagination,
   PartiesSort,
   PartyAdd,
-  PartyRemove
+  PartyRemove,
+  PartyCreator
 ]).component(name, {
   templateUrl: `imports/ui/components/${name}/${name}.html`,
   controllerAs: name,
-- 
2.5.0


From 577c444a4dfc48c761800da110f990a2a3a2de3b Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 17:06:21 +0200
Subject: [PATCH 149/204] Step 13.17: Tests of PartyCreator

---
 .../partyCreator/client/partyCreator.tests.js      | 81 ++++++++++++++++++++++
 1 file changed, 81 insertions(+)
 create mode 100644 imports/ui/components/partyCreator/client/partyCreator.tests.js

diff --git a/imports/ui/components/partyCreator/client/partyCreator.tests.js b/imports/ui/components/partyCreator/client/partyCreator.tests.js
new file mode 100644
index 0000000..dabb0b5
--- /dev/null
+++ b/imports/ui/components/partyCreator/client/partyCreator.tests.js
@@ -0,0 +1,81 @@
+import { name as PartyCreator } from '../partyCreator';
+import { Meteor } from 'meteor/meteor';
+import 'angular-mocks';
+
+describe('PartyCreator', () => {
+  beforeEach(() => {
+    window.module(PartyCreator);
+  });
+
+  describe('controller', () => {
+    let $rootScope;
+    let $componentController;
+    const party = {
+      _id: 'partyId'
+    };
+
+    beforeEach(() => {
+      inject((_$rootScope_, _$componentController_) => {
+        $rootScope = _$rootScope_;
+        $componentController = _$componentController_;
+      });
+    });
+
+    function component(bindings) {
+      return $componentController(PartyCreator, {
+        $scope: $rootScope.$new(true)
+      }, bindings);
+    }
+
+    it('should return an empty string if there is no party', () => {
+      const controller = component({
+        party: undefined
+      });
+
+      expect(controller.creator).toEqual('');
+    });
+
+    it('should say `me` if logged in is the owner', () => {
+      const owner = 'userId';
+      // logged in
+      spyOn(Meteor, 'userId').and.returnValue(owner);
+      const controller = component({
+        party: {
+          owner
+        }
+      });
+
+      expect(controller.creator).toEqual('me');
+    });
+
+    it('should say `nobody` if user does not exist', () => {
+      const owner = 'userId';
+      // not logged in
+      spyOn(Meteor, 'userId').and.returnValue(null);
+      // no user found
+      spyOn(Meteor.users, 'findOne').and.returnValue(undefined);
+      const controller = component({
+        party: {
+          owner
+        }
+      });
+
+      expect(controller.creator).toEqual('nobody');
+    });
+
+    it('should return user data if user exists and it is not logged one', () => {
+      const owner = 'userId';
+      // not logged in
+      spyOn(Meteor, 'userId').and.returnValue(null);
+      // user found
+      spyOn(Meteor.users, 'findOne').and.returnValue('found');
+      const controller = component({
+        party: {
+          owner
+        }
+      });
+
+      expect(controller.creator).toEqual('found');
+    });
+  });
+});
-- 
2.5.0


From a8b1558c6410426d67fce01c8f8dbf3872a59191 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 17:18:32 +0200
Subject: [PATCH 150/204] Step 14.1: Add `check` package

---
 .meteor/packages | 1 +
 1 file changed, 1 insertion(+)

diff --git a/.meteor/packages b/.meteor/packages
index 2525c04..3545268 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -25,3 +25,4 @@ dotansimha:accounts-ui-angular
 accounts-facebook
 accounts-twitter
 tmeasday:publish-counts
+check
-- 
2.5.0


From 7826efffa2616d46e690e93a8740cd7971db8a72 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 17:21:04 +0200
Subject: [PATCH 151/204] Step 14.2: Create invite method

---
 imports/api/parties/methods.js | 66 ++++++++++++++++++++++++++++++++++++++++++
 1 file changed, 66 insertions(+)
 create mode 100644 imports/api/parties/methods.js

diff --git a/imports/api/parties/methods.js b/imports/api/parties/methods.js
new file mode 100644
index 0000000..dd75692
--- /dev/null
+++ b/imports/api/parties/methods.js
@@ -0,0 +1,66 @@
+import _ from 'underscore';
+import { Meteor } from 'meteor/meteor';
+import { check } from 'meteor/check';
+
+import { Parties } from './collection';
+
+function getContactEmail(user) {
+  if (user.emails && user.emails.length)
+    return user.emails[0].address;
+
+  if (user.services && user.services.facebook && user.services.facebook.email)
+    return user.services.facebook.email;
+
+  return null;
+}
+
+export function invite(partyId, userId) {
+  check(partyId, String);
+  check(userId, String);
+
+  if (!this.userId) {
+    throw new Meteor.Error(400, 'You have to be logged in!');
+  }
+
+  const party = Parties.findOne(partyId);
+
+  if (!party) {
+    throw new Meteor.Error(404, 'No such party!');
+  }
+
+  if (party.owner !== this.userId) {
+    throw new Meteor.Error(404, 'No permissions!');
+  }
+
+  if (party.public) {
+    throw new Meteor.Error(400, 'That party is public. No need to invite people.');
+  }
+
+  if (userId !== party.owner && ! _.contains(party.invited, userId)) {
+    Parties.update(partyId, {
+      $addToSet: {
+        invited: userId
+      }
+    });
+
+    const replyTo = getContactEmail(Meteor.users.findOne(this.userId));
+    const to = getContactEmail(Meteor.users.findOne(userId));
+
+    if (Meteor.isServer && to) {
+      Email.send({
+        to,
+        replyTo,
+        from: 'noreply@socially.com',
+        subject: `PARTY: ${party.title}`,
+        text: `
+          Hey, I just invited you to ${party.title} on Socially.
+          Come check it out: ${Meteor.absoluteUrl()}
+        `
+      });
+    }
+  }
+}
+
+Meteor.methods({
+  invite
+});
-- 
2.5.0


From 241431ad06227c08f26087380a4749c85c7d2e27 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 17:21:28 +0200
Subject: [PATCH 152/204] Step 14.3: Import methods

---
 imports/api/parties/index.js | 1 +
 1 file changed, 1 insertion(+)

diff --git a/imports/api/parties/index.js b/imports/api/parties/index.js
index 5f7ae00..96b72b2 100644
--- a/imports/api/parties/index.js
+++ b/imports/api/parties/index.js
@@ -1,3 +1,4 @@
 import './publish';
+import './methods';
 
 export * from './collection';
-- 
2.5.0


From c44154216aaeb691d6ee4fa6e6324f335bfaab8c Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 17:23:05 +0200
Subject: [PATCH 153/204] Step 14.4: Add `email` package

---
 .meteor/packages | 1 +
 1 file changed, 1 insertion(+)

diff --git a/.meteor/packages b/.meteor/packages
index 3545268..53045cd 100644
--- a/.meteor/packages
+++ b/.meteor/packages
@@ -26,3 +26,4 @@ accounts-facebook
 accounts-twitter
 tmeasday:publish-counts
 check
+email
-- 
2.5.0


From 2eff3d6b13ac1663acc3d102d36b35b4c0c710be Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 17:23:49 +0200
Subject: [PATCH 154/204] Step 14.5: Import email from module

---
 imports/api/parties/methods.js | 1 +
 1 file changed, 1 insertion(+)

diff --git a/imports/api/parties/methods.js b/imports/api/parties/methods.js
index dd75692..054b42a 100644
--- a/imports/api/parties/methods.js
+++ b/imports/api/parties/methods.js
@@ -1,6 +1,7 @@
 import _ from 'underscore';
 import { Meteor } from 'meteor/meteor';
 import { check } from 'meteor/check';
+import { Email } from 'meteor/email';
 
 import { Parties } from './collection';
 
-- 
2.5.0


From 9f0da4b8976a6bd99afe2ecc94d9d1901849334e Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 17:25:59 +0200
Subject: [PATCH 155/204] Step 14.6: Add invite method to PartyUninvited

---
 imports/ui/components/partyUninvited/partyUninvited.js | 12 ++++++++++++
 1 file changed, 12 insertions(+)

diff --git a/imports/ui/components/partyUninvited/partyUninvited.js b/imports/ui/components/partyUninvited/partyUninvited.js
index 4ec5ade..d941e40 100644
--- a/imports/ui/components/partyUninvited/partyUninvited.js
+++ b/imports/ui/components/partyUninvited/partyUninvited.js
@@ -19,6 +19,18 @@ class PartyUninvited {
       }
     });
   }
+
+  invite(user) {
+    Meteor.call('invite', this.party._id, user._id,
+      (error) => {
+        if (error) {
+          console.log('Oops, unable to invite!');
+        } else {
+          console.log('Invited!');
+        }
+      }
+    );
+  }
 }
 
 const name = 'partyUninvited';
-- 
2.5.0


From da1c799fa96cede4df1dc95654a5534fe4300b8c Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 17:26:36 +0200
Subject: [PATCH 156/204] Step 14.7: Add invite button

---
 imports/ui/components/partyUninvited/partyUninvited.html | 1 +
 1 file changed, 1 insertion(+)

diff --git a/imports/ui/components/partyUninvited/partyUninvited.html b/imports/ui/components/partyUninvited/partyUninvited.html
index 9603f3a..0cbb435 100644
--- a/imports/ui/components/partyUninvited/partyUninvited.html
+++ b/imports/ui/components/partyUninvited/partyUninvited.html
@@ -2,5 +2,6 @@
   Users to invite:
   <li ng-repeat="user in partyUninvited.users | uninvitedFilter:partyUninvited.party">
     <div>{{ user | displayNameFilter }}</div>
+    <button ng-click="partyUninvited.invite(user)">Invite</button>
   </li>
 </ul>
-- 
2.5.0


From ef22143a96ffb72fd087f3d6b2b8fd0ae9138f15 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 17:28:47 +0200
Subject: [PATCH 157/204] Step 14.8: Update the parties subscription to include
 invited

---
 imports/api/parties/publish.js | 9 +++++++++
 1 file changed, 9 insertions(+)

diff --git a/imports/api/parties/publish.js b/imports/api/parties/publish.js
index 67c9bdb..0d4d340 100644
--- a/imports/api/parties/publish.js
+++ b/imports/api/parties/publish.js
@@ -24,6 +24,15 @@ if (Meteor.isServer) {
             $exists: true
           }
         }]
+      }, {
+        // when logged in user is one of invited
+        $and: [{
+          invited: this.userId
+        }, {
+          invited: {
+            $exists: true
+          }
+        }]
       }]
     };
 
-- 
2.5.0


From bd5bebdf24daa5c0a2fa544ae6091378db2903dd Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 17:42:35 +0200
Subject: [PATCH 158/204] Step 14.9: Add rsvp method

---
 imports/api/parties/methods.js | 79 +++++++++++++++++++++++++++++++++++++++++-
 1 file changed, 78 insertions(+), 1 deletion(-)

diff --git a/imports/api/parties/methods.js b/imports/api/parties/methods.js
index 054b42a..e8aa1ad 100644
--- a/imports/api/parties/methods.js
+++ b/imports/api/parties/methods.js
@@ -62,6 +62,83 @@ export function invite(partyId, userId) {
   }
 }
 
+export function rsvp(partyId, rsvp) {
+  check(partyId, String);
+  check(rsvp, String);
+
+  if (!this.userId) {
+    throw new Meteor.Error(403, 'You must be logged in to RSVP');
+  }
+
+  if (!_.contains(['yes', 'no', 'maybe'], rsvp)) {
+    throw new Meteor.Error(400, 'Invalid RSVP');
+  }
+
+  const party = Parties.findOne({
+    _id: partyId,
+    $or: [{
+      // is public
+      $and: [{
+        public: true
+      }, {
+        public: {
+          $exists: true
+        }
+      }]
+    },{
+      // is owner
+      $and: [{
+        owner: this.userId
+      }, {
+        owner: {
+          $exists: true
+        }
+      }]
+    }, {
+      // is invited
+      $and: [{
+        invited: this.userId
+      }, {
+        invited: {
+          $exists: true
+        }
+      }]
+    }]
+  });
+
+  if (!party) {
+    throw new Meteor.Error(404, 'No such party');
+  }
+
+  const hasUserRsvp = _.findWhere(party.rsvps, {
+    user: this.userId
+  });
+
+  if (!hasUserRsvp) {
+    // add new rsvp entry
+    Parties.update(partyId, {
+      $push: {
+        rsvps: {
+          rsvp,
+          user: this.userId
+        }
+      }
+    });
+  } else {
+    // update rsvp entry
+    const userId = this.userId;
+    Parties.update({
+      _id: partyId,
+      'rsvps.user': userId
+    }, {
+      $set: {
+        'rsvps.$.rsvp': rsvp
+      }
+    });
+  }
+}
+
 Meteor.methods({
-  invite
+  invite,
+  rsvp
 });
-- 
2.5.0


From 12783931ff7287a7072c6cd3bb0a25824427e779 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 17:45:36 +0200
Subject: [PATCH 159/204] Step 14.10: Create PartyRsvp component

---
 imports/ui/components/partyRsvp/partyRsvp.js | 44 ++++++++++++++++++++++++++++
 1 file changed, 44 insertions(+)
 create mode 100644 imports/ui/components/partyRsvp/partyRsvp.js

diff --git a/imports/ui/components/partyRsvp/partyRsvp.js b/imports/ui/components/partyRsvp/partyRsvp.js
new file mode 100644
index 0000000..e5907b2
--- /dev/null
+++ b/imports/ui/components/partyRsvp/partyRsvp.js
@@ -0,0 +1,44 @@
+import angular from 'angular';
+import angularMeteor from 'angular-meteor';
+
+import { Meteor } from 'meteor/meteor';
+
+import './partyRsvp.html';
+
+class PartyRsvp {
+  yes() {
+    this.answer('yes');
+  }
+
+  maybe() {
+    this.answer('maybe');
+  }
+
+  no() {
+    this.answer('no');
+  }
+
+  answer(answer) {
+    Meteor.call('rsvp', this.party._id, answer, (error) => {
+      if (error) {
+        console.error('Oops, unable to rsvp!');
+      } else {
+        console.log('RSVP done!')
+      }
+    });
+  }
+}
+
+const name = 'partyRsvp';
+
+// create a module
+export default angular.module(name, [
+  angularMeteor
+]).component(name, {
+  templateUrl: `imports/ui/components/${name}/${name}.html`,
+  controllerAs: name,
+  bindings: {
+    party: '<'
+  },
+  controller: PartyRsvp
+});
-- 
2.5.0


From 1d957b0ab6ac99ac5fa3007293121aebc7d06743 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 17:46:38 +0200
Subject: [PATCH 160/204] Step 14.11: Create template

---
 imports/ui/components/partyRsvp/partyRsvp.html | 3 +++
 1 file changed, 3 insertions(+)
 create mode 100644 imports/ui/components/partyRsvp/partyRsvp.html

diff --git a/imports/ui/components/partyRsvp/partyRsvp.html b/imports/ui/components/partyRsvp/partyRsvp.html
new file mode 100644
index 0000000..ca15260
--- /dev/null
+++ b/imports/ui/components/partyRsvp/partyRsvp.html
@@ -0,0 +1,3 @@
+<input type="button" value="I'm going!" ng-click="partyRsvp.yes()"/>
+<input type="button" value="Maybe" ng-click="partyRsvp.maybe()"/>
+<input type="button" value="No" ng-click="partyRsvp.no()"/>
-- 
2.5.0


From 329db0d1535777dfc3f4553cfb4408048635d8b0 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 17:48:22 +0200
Subject: [PATCH 161/204] Step 14.12: Add component to the view

---
 imports/ui/components/partiesList/partiesList.html | 1 +
 1 file changed, 1 insertion(+)

diff --git a/imports/ui/components/partiesList/partiesList.html b/imports/ui/components/partiesList/partiesList.html
index 2b18723..bced521 100644
--- a/imports/ui/components/partiesList/partiesList.html
+++ b/imports/ui/components/partiesList/partiesList.html
@@ -11,6 +11,7 @@
     </a>
     <p>{{party.description}}</p>
     <party-remove party="party"></party-remove>
+    <party-rsvp party="party"></party-rsvp>
     <party-creator party="party"></party-creator>
   </li>
 </ul>
-- 
2.5.0


From 821d30033228fd193dac56715521dfd7b238a585 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 17:48:36 +0200
Subject: [PATCH 162/204] Step 14.13: Add as a dependency

---
 imports/ui/components/partiesList/partiesList.js | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/partiesList/partiesList.js b/imports/ui/components/partiesList/partiesList.js
index b84a560..3ef39cd 100644
--- a/imports/ui/components/partiesList/partiesList.js
+++ b/imports/ui/components/partiesList/partiesList.js
@@ -11,6 +11,7 @@ import { name as PartiesSort } from '../partiesSort/partiesSort';
 import { name as PartyAdd } from '../partyAdd/partyAdd';
 import { name as PartyRemove } from '../partyRemove/partyRemove';
 import { name as PartyCreator } from '../partyCreator/partyCreator';
+import { name as PartyRsvp } from '../partyRsvp/partyRsvp';
 
 class PartiesList {
   constructor($scope, $reactive) {
@@ -63,7 +64,8 @@ export default angular.module(name, [
   PartiesSort,
   PartyAdd,
   PartyRemove,
-  PartyCreator
+  PartyCreator,
+  PartyRsvp
 ]).component(name, {
   templateUrl: `imports/ui/components/${name}/${name}.html`,
   controllerAs: name,
-- 
2.5.0


From 479e2e1cac71c7eb2dcfa6984b46925083166642 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 17:53:02 +0200
Subject: [PATCH 163/204] Step 14.14: Create view for PartyRsvpsList component

---
 imports/ui/components/partyRsvpsList/partyRsvpsList.html | 6 ++++++
 1 file changed, 6 insertions(+)
 create mode 100644 imports/ui/components/partyRsvpsList/partyRsvpsList.html

diff --git a/imports/ui/components/partyRsvpsList/partyRsvpsList.html b/imports/ui/components/partyRsvpsList/partyRsvpsList.html
new file mode 100644
index 0000000..efc38ed
--- /dev/null
+++ b/imports/ui/components/partyRsvpsList/partyRsvpsList.html
@@ -0,0 +1,6 @@
+Who is coming: Yes -
+{{ (partyRsvpsList.rsvps | filter:{rsvp:'yes'}).length }}
+Maybe -
+{{ (partyRsvpsList.rsvps | filter:{rsvp:'maybe'}).length }}
+No -
+{{ (partyRsvpsList.rsvps | filter:{rsvp:'no'}).length }}
-- 
2.5.0


From 99049a96d791b3fb197afac8fa837b3e6e0ea9bd Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 17:53:16 +0200
Subject: [PATCH 164/204] Step 14.15: Create component

---
 .../ui/components/partyRsvpsList/partyRsvpsList.js   | 20 ++++++++++++++++++++
 1 file changed, 20 insertions(+)
 create mode 100644 imports/ui/components/partyRsvpsList/partyRsvpsList.js

diff --git a/imports/ui/components/partyRsvpsList/partyRsvpsList.js b/imports/ui/components/partyRsvpsList/partyRsvpsList.js
new file mode 100644
index 0000000..4e6e752
--- /dev/null
+++ b/imports/ui/components/partyRsvpsList/partyRsvpsList.js
@@ -0,0 +1,20 @@
+import angular from 'angular';
+import angularMeteor from 'angular-meteor';
+
+import './partyRsvpsList.html';
+
+class PartyRsvpsList { }
+
+const name = 'partyRsvpsList';
+
+// create a module
+export default angular.module(name, [
+  angularMeteor
+]).component(name, {
+  templateUrl: `imports/ui/components/${name}/${name}.html`,
+  controllerAs: name,
+  bindings: {
+    rsvps: '<'
+  },
+  controller: PartyRsvpsList
+});
-- 
2.5.0


From 48a00a44d41dd8b75a6f5fdcb4631a1617a3c1ac Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 17:53:32 +0200
Subject: [PATCH 165/204] Step 14.16: Add to the view

---
 imports/ui/components/partiesList/partiesList.html | 1 +
 1 file changed, 1 insertion(+)

diff --git a/imports/ui/components/partiesList/partiesList.html b/imports/ui/components/partiesList/partiesList.html
index bced521..60dbea3 100644
--- a/imports/ui/components/partiesList/partiesList.html
+++ b/imports/ui/components/partiesList/partiesList.html
@@ -12,6 +12,7 @@
     <p>{{party.description}}</p>
     <party-remove party="party"></party-remove>
     <party-rsvp party="party"></party-rsvp>
+    <party-rsvps-list rsvps="party.rsvps"></party-rsvps-list>
     <party-creator party="party"></party-creator>
   </li>
 </ul>
-- 
2.5.0


From cd2cfdc5bc5c2830934a08b85a8baf6239556c54 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 17:53:47 +0200
Subject: [PATCH 166/204] Step 14.17: Also as a dependency

---
 imports/ui/components/partiesList/partiesList.js | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/partiesList/partiesList.js b/imports/ui/components/partiesList/partiesList.js
index 3ef39cd..2d27cfd 100644
--- a/imports/ui/components/partiesList/partiesList.js
+++ b/imports/ui/components/partiesList/partiesList.js
@@ -12,6 +12,7 @@ import { name as PartyAdd } from '../partyAdd/partyAdd';
 import { name as PartyRemove } from '../partyRemove/partyRemove';
 import { name as PartyCreator } from '../partyCreator/partyCreator';
 import { name as PartyRsvp } from '../partyRsvp/partyRsvp';
+import { name as PartyRsvpsList } from '../partyRsvpsList/partyRsvpsList';
 
 class PartiesList {
   constructor($scope, $reactive) {
@@ -65,7 +66,8 @@ export default angular.module(name, [
   PartyAdd,
   PartyRemove,
   PartyCreator,
-  PartyRsvp
+  PartyRsvp,
+  PartyRsvpsList
 ]).component(name, {
   templateUrl: `imports/ui/components/${name}/${name}.html`,
   controllerAs: name,
-- 
2.5.0


From 26cb7893177b9d981f2087b8ec46f6e0cb50a70d Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 17:57:13 +0200
Subject: [PATCH 167/204] Step 14.18: Create view for PartyRsvpUsers component

---
 imports/ui/components/partyRsvpUsers/partyRsvpUsers.html | 5 +++++
 1 file changed, 5 insertions(+)
 create mode 100644 imports/ui/components/partyRsvpUsers/partyRsvpUsers.html

diff --git a/imports/ui/components/partyRsvpUsers/partyRsvpUsers.html b/imports/ui/components/partyRsvpUsers/partyRsvpUsers.html
new file mode 100644
index 0000000..445d426
--- /dev/null
+++ b/imports/ui/components/partyRsvpUsers/partyRsvpUsers.html
@@ -0,0 +1,5 @@
+<div ng-repeat="rsvp in partyRsvpUsers.rsvps | filter:{ rsvp: partyRsvpUsers.type }">
+  {{ partyRsvpUsers.getUserById(rsvp.user) | displayNameFilter }}
+  -
+  {{ partyRsvpUsers.type }}
+</div>
-- 
2.5.0


From bd311149cf4f3a46eaeabd13b95ab339deeb3ebd Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 17:57:30 +0200
Subject: [PATCH 168/204] Step 14.19: Create component

---
 .../ui/components/partyRsvpUsers/partyRsvpUsers.js | 29 ++++++++++++++++++++++
 1 file changed, 29 insertions(+)
 create mode 100644 imports/ui/components/partyRsvpUsers/partyRsvpUsers.js

diff --git a/imports/ui/components/partyRsvpUsers/partyRsvpUsers.js b/imports/ui/components/partyRsvpUsers/partyRsvpUsers.js
new file mode 100644
index 0000000..f94eb18
--- /dev/null
+++ b/imports/ui/components/partyRsvpUsers/partyRsvpUsers.js
@@ -0,0 +1,29 @@
+import angular from 'angular';
+import angularMeteor from 'angular-meteor';
+
+import { Meteor } from 'meteor/meteor';
+
+import './partyRsvpUsers.html';
+import { name as DisplayNameFilter } from '../../filters/displayNameFilter';
+
+class PartyRsvpUsers {
+  getUserById(userId) {
+    return Meteor.users.findOne(userId);
+  }
+}
+
+const name = 'partyRsvpUsers';
+
+// create a module
+export default angular.module(name, [
+  angularMeteor,
+  DisplayNameFilter
+]).component(name, {
+  templateUrl: `imports/ui/components/${name}/${name}.html`,
+  controllerAs: name,
+  bindings: {
+    rsvps: '<',
+    type: '@'
+  },
+  controller: PartyRsvpUsers
+});
-- 
2.5.0


From 842c145dd20e328a05004782ea64f95c5f9b67e3 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 17:57:56 +0200
Subject: [PATCH 169/204] Step 14.20: Use recently created component

---
 imports/ui/components/partyRsvpsList/partyRsvpsList.html | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/imports/ui/components/partyRsvpsList/partyRsvpsList.html b/imports/ui/components/partyRsvpsList/partyRsvpsList.html
index efc38ed..2e1749d 100644
--- a/imports/ui/components/partyRsvpsList/partyRsvpsList.html
+++ b/imports/ui/components/partyRsvpsList/partyRsvpsList.html
@@ -4,3 +4,7 @@ Maybe -
 {{ (partyRsvpsList.rsvps | filter:{rsvp:'maybe'}).length }}
 No -
 {{ (partyRsvpsList.rsvps | filter:{rsvp:'no'}).length }}
+
+<party-rsvp-users rsvps="partyRsvpsList.rsvps" type="yes"></party-rsvp-users>
+<party-rsvp-users rsvps="partyRsvpsList.rsvps" type="maybe"></party-rsvp-users>
+<party-rsvp-users rsvps="partyRsvpsList.rsvps" type="no"></party-rsvp-users>
-- 
2.5.0


From 75a3c21f99e2f7210394628a8cfd898bae24ba0a Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 17:58:15 +0200
Subject: [PATCH 170/204] Step 14.21: Add as a dependency

---
 imports/ui/components/partyRsvpsList/partyRsvpsList.js | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/partyRsvpsList/partyRsvpsList.js b/imports/ui/components/partyRsvpsList/partyRsvpsList.js
index 4e6e752..1150a47 100644
--- a/imports/ui/components/partyRsvpsList/partyRsvpsList.js
+++ b/imports/ui/components/partyRsvpsList/partyRsvpsList.js
@@ -2,6 +2,7 @@ import angular from 'angular';
 import angularMeteor from 'angular-meteor';
 
 import './partyRsvpsList.html';
+import { name as PartyRsvpUsers } from '../partyRsvpUsers/partyRsvpUsers';
 
 class PartyRsvpsList { }
 
@@ -9,7 +10,8 @@ const name = 'partyRsvpsList';
 
 // create a module
 export default angular.module(name, [
-  angularMeteor
+  angularMeteor,
+  PartyRsvpUsers
 ]).component(name, {
   templateUrl: `imports/ui/components/${name}/${name}.html`,
   controllerAs: name,
-- 
2.5.0


From d74a1345d8cdca660e6f719227972c70f3d0a6dc Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 17:59:25 +0200
Subject: [PATCH 171/204] Step 14.22: Create view for PartyUnanswered

---
 imports/ui/components/partyUnanswered/partyUnanswered.html | 5 +++++
 1 file changed, 5 insertions(+)
 create mode 100644 imports/ui/components/partyUnanswered/partyUnanswered.html

diff --git a/imports/ui/components/partyUnanswered/partyUnanswered.html b/imports/ui/components/partyUnanswered/partyUnanswered.html
new file mode 100644
index 0000000..ecc1b45
--- /dev/null
+++ b/imports/ui/components/partyUnanswered/partyUnanswered.html
@@ -0,0 +1,5 @@
+<ul>
+  <li ng-repeat="invitedUser in partyUnanswered.getUnanswered()">
+    {{ partyUnanswered.getUserById(invitedUser) | displayNameFilter }}
+  </li>
+</ul>
-- 
2.5.0


From 2795ea155c63db16de56ddbc2931bde4d4a762a8 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 18:02:22 +0200
Subject: [PATCH 172/204] Step 14.23: Create component

---
 .../components/partyUnanswered/partyUnanswered.js  | 39 ++++++++++++++++++++++
 1 file changed, 39 insertions(+)
 create mode 100644 imports/ui/components/partyUnanswered/partyUnanswered.js

diff --git a/imports/ui/components/partyUnanswered/partyUnanswered.js b/imports/ui/components/partyUnanswered/partyUnanswered.js
new file mode 100644
index 0000000..d6eaf46
--- /dev/null
+++ b/imports/ui/components/partyUnanswered/partyUnanswered.js
@@ -0,0 +1,39 @@
+import angular from 'angular';
+import angularMeteor from 'angular-meteor';
+import _ from 'underscore';
+
+import { Meteor } from 'meteor/meteor';
+
+import './partyUnanswered.html';
+import { name as DisplayNameFilter } from '../../filters/displayNameFilter';
+
+class PartyUnanswered {
+  getUnanswered() {
+    if (!this.party || !this.party.invited) {
+      return;
+    }
+
+    return this.party.invited.filter((user) => {
+      return !_.findWhere(this.party.rsvps, { user });
+    });
+  }
+
+  getUserById(userId) {
+    return Meteor.users.findOne(userId)
+  }
+}
+
+const name = 'partyUnanswered';
+
+// create a module
+export default angular.module(name, [
+  angularMeteor,
+  DisplayNameFilter
+]).component(name, {
+  templateUrl: `imports/ui/components/${name}/${name}.html`,
+  controllerAs: name,
+  bindings: {
+    party: '<'
+  },
+  controller: PartyUnanswered
+});
-- 
2.5.0


From b03386bab1e7d157e51fb079c6f79e10a8dffd46 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 18:02:52 +0200
Subject: [PATCH 173/204] Step 14.24: Use recently created component

---
 imports/ui/components/partiesList/partiesList.html | 1 +
 1 file changed, 1 insertion(+)

diff --git a/imports/ui/components/partiesList/partiesList.html b/imports/ui/components/partiesList/partiesList.html
index 60dbea3..4881e5c 100644
--- a/imports/ui/components/partiesList/partiesList.html
+++ b/imports/ui/components/partiesList/partiesList.html
@@ -13,6 +13,7 @@
     <party-remove party="party"></party-remove>
     <party-rsvp party="party"></party-rsvp>
     <party-rsvps-list rsvps="party.rsvps"></party-rsvps-list>
+    <party-unanswered party="party"></party-unanswered>
     <party-creator party="party"></party-creator>
   </li>
 </ul>
-- 
2.5.0


From 25314c3e3d50ce68ab65c0feb11d1b2db687bd50 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 18:03:12 +0200
Subject: [PATCH 174/204] Step 14.25: Add as a dependency

---
 imports/ui/components/partiesList/partiesList.js | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/partiesList/partiesList.js b/imports/ui/components/partiesList/partiesList.js
index 2d27cfd..bc983e5 100644
--- a/imports/ui/components/partiesList/partiesList.js
+++ b/imports/ui/components/partiesList/partiesList.js
@@ -13,6 +13,7 @@ import { name as PartyRemove } from '../partyRemove/partyRemove';
 import { name as PartyCreator } from '../partyCreator/partyCreator';
 import { name as PartyRsvp } from '../partyRsvp/partyRsvp';
 import { name as PartyRsvpsList } from '../partyRsvpsList/partyRsvpsList';
+import { name as PartyUnanswered } from '../partyUnanswered/partyUnanswered';
 
 class PartiesList {
   constructor($scope, $reactive) {
@@ -67,7 +68,8 @@ export default angular.module(name, [
   PartyRemove,
   PartyCreator,
   PartyRsvp,
-  PartyRsvpsList
+  PartyRsvpsList,
+  PartyUnanswered
 ]).component(name, {
   templateUrl: `imports/ui/components/${name}/${name}.html`,
   controllerAs: name,
-- 
2.5.0


From fc18794185866c56d92f5154b7e935ada4ea1d1f Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 18:03:38 +0200
Subject: [PATCH 175/204] Step 14.26: Subscribe `users`

---
 imports/ui/components/partiesList/partiesList.js | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/imports/ui/components/partiesList/partiesList.js b/imports/ui/components/partiesList/partiesList.js
index bc983e5..5a10136 100644
--- a/imports/ui/components/partiesList/partiesList.js
+++ b/imports/ui/components/partiesList/partiesList.js
@@ -35,6 +35,8 @@ class PartiesList {
       }, this.getReactively('searchText')
     ]);
 
+    this.subscribe('users');
+
     this.helpers({
       parties() {
         return Parties.find({}, {
-- 
2.5.0


From 966de79f567691b1af4684ab5c09f7670262e610 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 19:50:23 +0200
Subject: [PATCH 176/204] Step 14.27: Tests of invite method

---
 imports/api/parties/methods.tests.js | 126 +++++++++++++++++++++++++++++++++++
 1 file changed, 126 insertions(+)
 create mode 100644 imports/api/parties/methods.tests.js

diff --git a/imports/api/parties/methods.tests.js b/imports/api/parties/methods.tests.js
new file mode 100644
index 0000000..56e770c
--- /dev/null
+++ b/imports/api/parties/methods.tests.js
@@ -0,0 +1,126 @@
+import { invite } from './methods';
+import { Parties } from './collection';
+
+import { Meteor } from 'meteor/meteor';
+
+if (Meteor.isServer) {
+  describe('Parties / Methods', () => {
+    describe('invite', () => {
+      function loggedIn(userId = 'userId') {
+        return {
+          userId
+        };
+      }
+
+      it('should be called from Method', () => {
+        spyOn(invite, 'apply');
+
+        try {
+          Meteor.call('invite');
+        } catch (e) {}
+
+        expect(invite.apply).toHaveBeenCalled();
+      });
+
+      it('should fail on missing partyId', () => {
+        expect(() => {
+          invite.call({});
+        }).toThrowError();
+      });
+
+      it('should fail on missing userId', () => {
+        expect(() => {
+          invite.call({}, 'partyId');
+        }).toThrowError();
+      });
+
+      it('should fail on not logged in', () => {
+        expect(() => {
+          invite.call({}, 'partyId', 'userId');
+        }).toThrowError(/logged in/i);
+      });
+
+      it('should look for a party', () => {
+        const partyId = 'partyId';
+        spyOn(Parties, 'findOne');
+
+        try {
+          invite.call(loggedIn(), partyId, 'userId');
+        } catch (e) {}
+
+        expect(Parties.findOne).toHaveBeenCalledWith(partyId);
+      });
+
+      it('should fail if party does not exist', () => {
+        spyOn(Parties, 'findOne').and.returnValue(undefined);
+
+        expect(() => {
+          invite.call(loggedIn(), 'partyId', 'userId');
+        }).toThrowError(/404/);
+      });
+
+      it('should fail if logged in user is not the owner', () => {
+        spyOn(Parties, 'findOne').and.returnValue({
+          owner: 'notUserId'
+        });
+
+        expect(() => {
+          invite.call(loggedIn(), 'partyId', 'userId');
+        }).toThrowError(/404/);
+      });
+
+      it('should fail on public party', () => {
+        spyOn(Parties, 'findOne').and.returnValue({
+          owner: 'userId',
+          public: true
+        });
+
+        expect(() => {
+          invite.call(loggedIn(), 'partyId', 'userId');
+        }).toThrowError(/400/);
+      });
+
+      it('should NOT invite user who is the owner', () => {
+        spyOn(Parties, 'findOne').and.returnValue({
+          owner: 'userId'
+        });
+        spyOn(Parties, 'update');
+
+        invite.call(loggedIn(), 'partyId', 'userId');
+
+        expect(Parties.update).not.toHaveBeenCalled();
+      });
+
+      it('should NOT invite user who has been already invited', () => {
+        spyOn(Parties, 'findOne').and.returnValue({
+          owner: 'userId',
+          invited: ['invitedId']
+        });
+        spyOn(Parties, 'update');
+
+        invite.call(loggedIn(), 'partyId', 'invitedId');
+
+        expect(Parties.update).not.toHaveBeenCalled();
+      });
+
+      it('should invite user who has not been invited and is not the owner', () => {
+        const partyId = 'partyId';
+        const userId = 'notInvitedId';
+        spyOn(Parties, 'findOne').and.returnValue({
+          owner: 'userId',
+          invited: ['invitedId']
+        });
+        spyOn(Parties, 'update');
+        spyOn(Meteor.users, 'findOne').and.returnValue({});
+
+        invite.call(loggedIn(), partyId, userId);
+
+        expect(Parties.update).toHaveBeenCalledWith(partyId, {
+          $addToSet: {
+            invited: userId
+          }
+        });
+      });
+    });
+  });
+}
-- 
2.5.0


From bc0c062ee147b30231527116cb7147f042becc8b Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 20:00:03 +0200
Subject: [PATCH 177/204] Step 14.28: Tests of rsvp Method

---
 imports/api/parties/methods.tests.js | 54 +++++++++++++++++++++++++++++++++++-
 1 file changed, 53 insertions(+), 1 deletion(-)

diff --git a/imports/api/parties/methods.tests.js b/imports/api/parties/methods.tests.js
index 56e770c..536a2b0 100644
--- a/imports/api/parties/methods.tests.js
+++ b/imports/api/parties/methods.tests.js
@@ -1,4 +1,4 @@
-import { invite } from './methods';
+import { invite, rsvp } from './methods';
 import { Parties } from './collection';
 
 import { Meteor } from 'meteor/meteor';
@@ -122,5 +122,57 @@ if (Meteor.isServer) {
         });
       });
     });
+
+    describe('rsvp', () => {
+      function loggedIn(userId = 'userId') {
+        return {
+          userId
+        };
+      }
+
+      it('should be called from Method', () => {
+        spyOn(rsvp, 'apply');
+
+        try {
+          Meteor.call('rsvp');
+        } catch (e) {}
+
+        expect(rsvp.apply).toHaveBeenCalled();
+      });
+
+      it('should fail on missing partyId', () => {
+        expect(() => {
+          rsvp.call({});
+        }).toThrowError();
+      });
+
+      it('should fail on missing rsvp', () => {
+        expect(() => {
+          rsvp.call({}, 'partyId');
+        }).toThrowError();
+      });
+
+      it('should fail if not logged in', () => {
+        expect(() => {
+          rsvp.call({}, 'partyId', 'rsvp');
+        }).toThrowError(/403/);
+      });
+
+      it('should fail on wrong answer', () => {
+        expect(() => {
+          rsvp.call(loggedIn(), 'partyId', 'wrong');
+        }).toThrowError(/400/);
+      });
+
+      ['yes', 'maybe', 'no'].forEach((answer) => {
+        it(`should pass on '${answer}'`, () => {
+          expect(() => {
+            rsvp.call(loggedIn(), 'partyId', answer);
+          }).not.toThrowError(/400/);
+        });
+      });
+
+      // TODO: more tests  
+    });
   });
 }
-- 
2.5.0


From 574da9cb5e7b3ff08734370c661c17d40227e021 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 20:07:36 +0200
Subject: [PATCH 178/204] Step 15.1: Add ngShow to PartyAdd

---
 imports/ui/components/partiesList/partiesList.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/imports/ui/components/partiesList/partiesList.html b/imports/ui/components/partiesList/partiesList.html
index 4881e5c..d6d4c83 100644
--- a/imports/ui/components/partiesList/partiesList.html
+++ b/imports/ui/components/partiesList/partiesList.html
@@ -1,4 +1,4 @@
-<party-add></party-add>
+<party-add ng-show="partiesList.isLoggedIn"></party-add>
 
 <input type="search" ng-model="partiesList.searchText" placeholder="Search" />
 
-- 
2.5.0


From 0adcaba8c2f33c999d4bc6197c8f2e9fcd7ffe3f Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 20:09:16 +0200
Subject: [PATCH 179/204] Step 15.2: Add isLoggedIn helper

---
 imports/ui/components/partiesList/partiesList.js | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/imports/ui/components/partiesList/partiesList.js b/imports/ui/components/partiesList/partiesList.js
index 5a10136..5f779e0 100644
--- a/imports/ui/components/partiesList/partiesList.js
+++ b/imports/ui/components/partiesList/partiesList.js
@@ -45,6 +45,9 @@ class PartiesList {
       },
       partiesCount() {
         return Counts.get('numberOfParties');
+      },
+      isLoggedIn() {
+        return !!Meteor.userId();
       }
     });
   }
-- 
2.5.0


From 9f2b6e607f09f997dc5a49e321631832fc97d2dd Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 20:09:45 +0200
Subject: [PATCH 180/204] Step 15.3: Add usage for ng-hide

---
 imports/ui/components/partiesList/partiesList.html | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/imports/ui/components/partiesList/partiesList.html b/imports/ui/components/partiesList/partiesList.html
index d6d4c83..c3006d3 100644
--- a/imports/ui/components/partiesList/partiesList.html
+++ b/imports/ui/components/partiesList/partiesList.html
@@ -1,4 +1,7 @@
 <party-add ng-show="partiesList.isLoggedIn"></party-add>
+<div ng-hide="partiesList.isLoggedIn">
+  Log in to create a party!
+</div>
 
 <input type="search" ng-model="partiesList.searchText" placeholder="Search" />
 
-- 
2.5.0


From 9299c235eb0deeef25f8df2ccc0d9d00772a32c1 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 20:10:23 +0200
Subject: [PATCH 181/204] Step 15.4: Add ngShow to PartyRsvp

---
 imports/ui/components/partiesList/partiesList.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/imports/ui/components/partiesList/partiesList.html b/imports/ui/components/partiesList/partiesList.html
index c3006d3..07d331f 100644
--- a/imports/ui/components/partiesList/partiesList.html
+++ b/imports/ui/components/partiesList/partiesList.html
@@ -14,7 +14,7 @@
     </a>
     <p>{{party.description}}</p>
     <party-remove party="party"></party-remove>
-    <party-rsvp party="party"></party-rsvp>
+    <party-rsvp party="party" ng-show="partiesList.isLoggedIn"></party-rsvp>
     <party-rsvps-list rsvps="party.rsvps"></party-rsvps-list>
     <party-unanswered party="party"></party-unanswered>
     <party-creator party="party"></party-creator>
-- 
2.5.0


From e0bdc7cf007c05cb98681be24cdda68c7b420962 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 20:10:48 +0200
Subject: [PATCH 182/204] Step 15.5: Add message for not-logged in users on the
 RSVP buttons

---
 imports/ui/components/partiesList/partiesList.html | 4 ++++
 1 file changed, 4 insertions(+)

diff --git a/imports/ui/components/partiesList/partiesList.html b/imports/ui/components/partiesList/partiesList.html
index 07d331f..3b4a085 100644
--- a/imports/ui/components/partiesList/partiesList.html
+++ b/imports/ui/components/partiesList/partiesList.html
@@ -15,6 +15,10 @@
     <p>{{party.description}}</p>
     <party-remove party="party"></party-remove>
     <party-rsvp party="party" ng-show="partiesList.isLoggedIn"></party-rsvp>
+    <div ng-hide="partiesList.isLoggedIn">
+      <i>Sign in to RSVP for this party.</i>
+    </div>
+    
     <party-rsvps-list rsvps="party.rsvps"></party-rsvps-list>
     <party-unanswered party="party"></party-unanswered>
     <party-creator party="party"></party-creator>
-- 
2.5.0


From a660bc6be91ab88a9f99d6152cdcd549ae7ec013 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 20:12:56 +0200
Subject: [PATCH 183/204] Step 15.6: Add isOwner method

---
 imports/ui/components/partiesList/partiesList.js | 7 +++++++
 1 file changed, 7 insertions(+)

diff --git a/imports/ui/components/partiesList/partiesList.js b/imports/ui/components/partiesList/partiesList.js
index 5f779e0..f139a7a 100644
--- a/imports/ui/components/partiesList/partiesList.js
+++ b/imports/ui/components/partiesList/partiesList.js
@@ -48,10 +48,17 @@ class PartiesList {
       },
       isLoggedIn() {
         return !!Meteor.userId();
+      },
+      currentUserId() {
+        return Meteor.userId();
       }
     });
   }
 
+  isOwner(party) {
+    return this.isLoggedIn && party.owner === this.currentUserId;
+  }
+
   pageChanged(newPage) {
     this.page = newPage;
   }
-- 
2.5.0


From 1bec74ede65d55fd984f19e3173a1f814946d2f3 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 20:13:51 +0200
Subject: [PATCH 184/204] Step 15.7: Add ngShow to PartyRemove

---
 imports/ui/components/partiesList/partiesList.html | 4 ++--
 1 file changed, 2 insertions(+), 2 deletions(-)

diff --git a/imports/ui/components/partiesList/partiesList.html b/imports/ui/components/partiesList/partiesList.html
index 3b4a085..fbc61a9 100644
--- a/imports/ui/components/partiesList/partiesList.html
+++ b/imports/ui/components/partiesList/partiesList.html
@@ -13,12 +13,12 @@
       {{party.name}}
     </a>
     <p>{{party.description}}</p>
-    <party-remove party="party"></party-remove>
+    <party-remove party="party" ng-show="partiesList.isOwner(party)"></party-remove>
     <party-rsvp party="party" ng-show="partiesList.isLoggedIn"></party-rsvp>
     <div ng-hide="partiesList.isLoggedIn">
       <i>Sign in to RSVP for this party.</i>
     </div>
-    
+
     <party-rsvps-list rsvps="party.rsvps"></party-rsvps-list>
     <party-unanswered party="party"></party-unanswered>
     <party-creator party="party"></party-creator>
-- 
2.5.0


From 9aee2d912a524541b8557de7cde7eab93f1f3eca Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 20:15:08 +0200
Subject: [PATCH 185/204] Step 15.8: Add ngIf to PartyUnanswered

---
 imports/ui/components/partiesList/partiesList.html | 7 ++++++-
 1 file changed, 6 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/partiesList/partiesList.html b/imports/ui/components/partiesList/partiesList.html
index fbc61a9..c4cc2c1 100644
--- a/imports/ui/components/partiesList/partiesList.html
+++ b/imports/ui/components/partiesList/partiesList.html
@@ -20,7 +20,12 @@
     </div>
 
     <party-rsvps-list rsvps="party.rsvps"></party-rsvps-list>
-    <party-unanswered party="party"></party-unanswered>
+
+    <party-unanswered party="party" ng-if="!party.public"></party-unanswered>
+    <div ng-if="party.public">
+      Everyone is invited
+    </div>
+
     <party-creator party="party"></party-creator>
   </li>
 </ul>
-- 
2.5.0


From 909a4bc5e61717aac2820dd68f6bdcfeb08c9e01 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 20:16:17 +0200
Subject: [PATCH 186/204] Step 15.9: Add canInvite method to the component

---
 imports/ui/components/partyDetails/partyDetails.js | 8 ++++++++
 1 file changed, 8 insertions(+)

diff --git a/imports/ui/components/partyDetails/partyDetails.js b/imports/ui/components/partyDetails/partyDetails.js
index 21bf1a3..db84949 100644
--- a/imports/ui/components/partyDetails/partyDetails.js
+++ b/imports/ui/components/partyDetails/partyDetails.js
@@ -31,6 +31,14 @@ class PartyDetails {
     });
   }
 
+  canInvite() {
+    if (!this.party) {
+      return false;
+    }
+
+    return !this.party.public && this.party.owner === Meteor.userId();
+  }
+
   save() {
     Parties.update({
       _id: this.party._id
-- 
2.5.0


From a1a8ea480dba4418bbd7976c297e5cbee1a60d65 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 20:18:07 +0200
Subject: [PATCH 187/204] Step 15.10: Add ngShow to PartyUninvited

---
 imports/ui/components/partyDetails/partyDetails.html | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/imports/ui/components/partyDetails/partyDetails.html b/imports/ui/components/partyDetails/partyDetails.html
index 916f23e..ab7abd9 100644
--- a/imports/ui/components/partyDetails/partyDetails.html
+++ b/imports/ui/components/partyDetails/partyDetails.html
@@ -8,4 +8,4 @@ The party your selected is:
 
 <button ui-sref="parties">Back</button>
 
-<party-uninvited party="partyDetails.party"></party-uninvited>
+<party-uninvited party="partyDetails.party" ng-show="partyDetails.canInvite()"></party-uninvited>
-- 
2.5.0


From 4e02fb7a5840def2c08d8fcbe06a301f560da03b Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 20:18:54 +0200
Subject: [PATCH 188/204] Step 15.11: Add info that everyone are already
 invited

---
 imports/ui/components/partyUninvited/partyUninvited.html | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/imports/ui/components/partyUninvited/partyUninvited.html b/imports/ui/components/partyUninvited/partyUninvited.html
index 0cbb435..86d2519 100644
--- a/imports/ui/components/partyUninvited/partyUninvited.html
+++ b/imports/ui/components/partyUninvited/partyUninvited.html
@@ -4,4 +4,7 @@
     <div>{{ user | displayNameFilter }}</div>
     <button ng-click="partyUninvited.invite(user)">Invite</button>
   </li>
+  <li ng-if="(partyUninvited.users | uninvitedFilter:partyUninvited.party).length <= 0">
+    Everyone are already invited.
+  </li>
 </ul>
-- 
2.5.0


From 2277ba9836865925f7b23168c67d38a32f6fc1c9 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 20:19:54 +0200
Subject: [PATCH 189/204] Step 15.12: Add isLoggedIn helper to the party
 details component

---
 imports/ui/components/partyDetails/partyDetails.js | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/imports/ui/components/partyDetails/partyDetails.js b/imports/ui/components/partyDetails/partyDetails.js
index db84949..b922b82 100644
--- a/imports/ui/components/partyDetails/partyDetails.js
+++ b/imports/ui/components/partyDetails/partyDetails.js
@@ -27,6 +27,9 @@ class PartyDetails {
       },
       users() {
         return Meteor.users.find({});
+      },
+      isLoggedIn() {
+        return !!Meteor.userId();
       }
     });
   }
-- 
2.5.0


From a2c63b375ad74d11023a335782462e14e33f94e2 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 20:20:39 +0200
Subject: [PATCH 190/204] Step 15.13: Add usage for ng-disabled

---
 imports/ui/components/partyDetails/partyDetails.html | 6 +++---
 1 file changed, 3 insertions(+), 3 deletions(-)

diff --git a/imports/ui/components/partyDetails/partyDetails.html b/imports/ui/components/partyDetails/partyDetails.html
index ab7abd9..e53812d 100644
--- a/imports/ui/components/partyDetails/partyDetails.html
+++ b/imports/ui/components/partyDetails/partyDetails.html
@@ -1,8 +1,8 @@
 The party your selected is:
 <form>
-  Party name: <input type="text" ng-model="partyDetails.party.name" />
-  Description: <input type="text" ng-model="partyDetails.party.description" />
-  Public Party? <input type="checkbox" ng-model="partyDetails.party.public">
+  Party name: <input type="text" ng-model="partyDetails.party.name" ng-disabled="!partyDetails.isLoggedIn"/>
+  Description: <input type="text" ng-model="partyDetails.party.description" ng-disabled="!partyDetails.isLoggedIn"/>
+  Public Party? <input type="checkbox" ng-model="partyDetails.party.public" ng-disabled="!partyDetails.isLoggedIn"/>
   <button ng-click="partyDetails.save()">Save</button>
 </form>
 
-- 
2.5.0


From 5edce667343bbbb961b605ad3d71be34306514cb Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 20:22:55 +0200
Subject: [PATCH 191/204] Step 16.1: Install `angular-google-maps`

---
 package.json | 1 +
 1 file changed, 1 insertion(+)

diff --git a/package.json b/package.json
index 6d220f0..2a644d9 100644
--- a/package.json
+++ b/package.json
@@ -7,6 +7,7 @@
   },
   "dependencies": {
     "angular": "^1.5.3",
+    "angular-google-maps": "^2.3.2",
     "angular-meteor": "^1.3.9",
     "angular-ui-router": "^1.0.0-alpha.4",
     "angular-utils-pagination": "^0.11.1",
-- 
2.5.0


From 948de91bd1f747dda8b4326fa29af839c5c0f2f6 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 20:23:36 +0200
Subject: [PATCH 192/204] Step 16.2: Install `angular-simple-logger`

---
 package.json | 1 +
 1 file changed, 1 insertion(+)

diff --git a/package.json b/package.json
index 2a644d9..1bb773a 100644
--- a/package.json
+++ b/package.json
@@ -9,6 +9,7 @@
     "angular": "^1.5.3",
     "angular-google-maps": "^2.3.2",
     "angular-meteor": "^1.3.9",
+    "angular-simple-logger": "^0.1.7",
     "angular-ui-router": "^1.0.0-alpha.4",
     "angular-utils-pagination": "^0.11.1",
     "meteor-node-stubs": "~0.2.0",
-- 
2.5.0


From 8975e2a24a4128f0ad8af90ce527f738b5d6692f Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 20:24:57 +0200
Subject: [PATCH 193/204] Step 16.3: Create template for PartyMap

---
 imports/ui/components/partyMap/partyMap.html | 5 +++++
 1 file changed, 5 insertions(+)
 create mode 100644 imports/ui/components/partyMap/partyMap.html

diff --git a/imports/ui/components/partyMap/partyMap.html b/imports/ui/components/partyMap/partyMap.html
new file mode 100644
index 0000000..e590420
--- /dev/null
+++ b/imports/ui/components/partyMap/partyMap.html
@@ -0,0 +1,5 @@
+<div class="angular-google-map-container">
+  <ui-gmap-google-map center="partyMap.location || partyMap.map.center" events="partyMap.map.events" zoom="partyMap.map.zoom">
+    <ui-gmap-marker coords="partyMap.location" options="partyMap.marker.options" events="partyMapmarker.events" idKey="party-location"></ui-gmap-marker>
+  </ui-gmap-google-map>
+</div>
-- 
2.5.0


From d9d1a1e40fb21e4f39a3d4b2ae615a217b2e93aa Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 20:25:56 +0200
Subject: [PATCH 194/204] Step 16.4: Create component

---
 imports/ui/components/partyMap/partyMap.js | 44 ++++++++++++++++++++++++++++++
 1 file changed, 44 insertions(+)
 create mode 100644 imports/ui/components/partyMap/partyMap.js

diff --git a/imports/ui/components/partyMap/partyMap.js b/imports/ui/components/partyMap/partyMap.js
new file mode 100644
index 0000000..73c6163
--- /dev/null
+++ b/imports/ui/components/partyMap/partyMap.js
@@ -0,0 +1,44 @@
+import angular from 'angular';
+import angularMeteor from 'angular-meteor';
+import 'angular-simple-logger';
+import 'angular-google-maps';
+
+import './partyMap.html';
+
+class PartyMap {
+  constructor($scope) {
+    'ngInject';
+
+    this.map = {
+      center: {
+        latitude: 45,
+        longitude: -73
+      },
+      zoom: 8,
+      events: {}
+    };
+
+    this.marker = {
+      options: {
+        draggable: true
+      },
+      events: {}
+    };
+  }
+}
+
+const name = 'partyMap';
+
+// create a module
+export default angular.module(name, [
+  angularMeteor,
+  'nemLogging', // https://github.com/angular-ui/angular-google-maps/issues/1633
+  'uiGmapgoogle-maps'
+]).component(name, {
+  templateUrl: `imports/ui/components/${name}/${name}.html`,
+  controllerAs: name,
+  bindings: {
+    location: '='
+  },
+  controller: PartyMap
+});
-- 
2.5.0


From 15ecb00e621a2857e0e30b5e2e5a5b6d7e8d43d6 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 20:27:32 +0200
Subject: [PATCH 195/204] Step 16.5: Add some class

---
 imports/ui/components/partyMap/partyMap.css | 4 ++++
 1 file changed, 4 insertions(+)
 create mode 100644 imports/ui/components/partyMap/partyMap.css

diff --git a/imports/ui/components/partyMap/partyMap.css b/imports/ui/components/partyMap/partyMap.css
new file mode 100644
index 0000000..f4b49f5
--- /dev/null
+++ b/imports/ui/components/partyMap/partyMap.css
@@ -0,0 +1,4 @@
+.angular-google-map-container {
+  height: 400px;
+  width: 400px;
+}
-- 
2.5.0


From 26bd919f15b273587a98bc12567666622d3a3d48 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 20:28:08 +0200
Subject: [PATCH 196/204] Step 16.6: Import styles

---
 imports/ui/components/partyMap/partyMap.js | 1 +
 1 file changed, 1 insertion(+)

diff --git a/imports/ui/components/partyMap/partyMap.js b/imports/ui/components/partyMap/partyMap.js
index 73c6163..393fc10 100644
--- a/imports/ui/components/partyMap/partyMap.js
+++ b/imports/ui/components/partyMap/partyMap.js
@@ -3,6 +3,7 @@ import angularMeteor from 'angular-meteor';
 import 'angular-simple-logger';
 import 'angular-google-maps';
 
+import './partyMap.css';
 import './partyMap.html';
 
 class PartyMap {
-- 
2.5.0


From a03cfc7b41b7a16d163477eba97d4aae8fc5f596 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 20:29:34 +0200
Subject: [PATCH 197/204] Step 16.7: Add as a dependency to PartyDetails

---
 imports/ui/components/partyDetails/partyDetails.js | 4 +++-
 1 file changed, 3 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/partyDetails/partyDetails.js b/imports/ui/components/partyDetails/partyDetails.js
index b922b82..0d125cc 100644
--- a/imports/ui/components/partyDetails/partyDetails.js
+++ b/imports/ui/components/partyDetails/partyDetails.js
@@ -7,6 +7,7 @@ import { Meteor } from 'meteor/meteor';
 import './partyDetails.html';
 import { Parties } from '../../../api/parties';
 import { name as PartyUninvited } from '../partyUninvited/partyUninvited';
+import { name as PartyMap } from '../partyMap/partyMap';
 
 class PartyDetails {
   constructor($stateParams, $scope, $reactive) {
@@ -67,7 +68,8 @@ const name = 'partyDetails';
 export default angular.module(name, [
   angularMeteor,
   uiRouter,
-  PartyUninvited
+  PartyUninvited,
+  PartyMap
 ]).component(name, {
   templateUrl: `imports/ui/components/${name}/${name}.html`,
   controllerAs: name,
-- 
2.5.0


From ef65699ad919b750a4dfbd198607463997fe4191 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 20:42:54 +0200
Subject: [PATCH 198/204] Step 16.8: Use in the view

---
 imports/ui/components/partyDetails/partyDetails.html | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/imports/ui/components/partyDetails/partyDetails.html b/imports/ui/components/partyDetails/partyDetails.html
index e53812d..7354dd6 100644
--- a/imports/ui/components/partyDetails/partyDetails.html
+++ b/imports/ui/components/partyDetails/partyDetails.html
@@ -9,3 +9,5 @@ The party your selected is:
 <button ui-sref="parties">Back</button>
 
 <party-uninvited party="partyDetails.party" ng-show="partyDetails.canInvite()"></party-uninvited>
+
+<party-map location="partyDetails.party.location"></party-map>
-- 
2.5.0


From 517c093ba9d0789a89b2e9b99e5870740be2e204 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 20:44:36 +0200
Subject: [PATCH 199/204] Step 16.9: Add actions

---
 imports/ui/components/partyMap/partyMap.js | 21 +++++++++++++++++++--
 1 file changed, 19 insertions(+), 2 deletions(-)

diff --git a/imports/ui/components/partyMap/partyMap.js b/imports/ui/components/partyMap/partyMap.js
index 393fc10..5fe2dfa 100644
--- a/imports/ui/components/partyMap/partyMap.js
+++ b/imports/ui/components/partyMap/partyMap.js
@@ -16,14 +16,31 @@ class PartyMap {
         longitude: -73
       },
       zoom: 8,
-      events: {}
+      events: {
+        click: (mapModel, eventName, originalEventArgs) => {
+          this.setLocation(originalEventArgs[0].latLng.lat(), originalEventArgs[0].latLng.lng());
+          $scope.$apply();
+        }
+      }
     };
 
     this.marker = {
       options: {
         draggable: true
       },
-      events: {}
+      events: {
+        dragend: (marker, eventName, args) => {
+          this.setLocation(marker.getPosition().lat(), marker.getPosition().lng());
+          $scope.$apply();
+        }
+      }
+    };
+  }
+
+  setLocation(latitude, longitude) {
+    this.location = {
+      latitude,
+      longitude
     };
   }
 }
-- 
2.5.0


From 3799247052709a68db3f68c5eebeae7dd371ca6b Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 20:45:34 +0200
Subject: [PATCH 200/204] Step 16.10: Add location to be updated with a party

---
 imports/ui/components/partyDetails/partyDetails.js | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/imports/ui/components/partyDetails/partyDetails.js b/imports/ui/components/partyDetails/partyDetails.js
index 0d125cc..259012b 100644
--- a/imports/ui/components/partyDetails/partyDetails.js
+++ b/imports/ui/components/partyDetails/partyDetails.js
@@ -50,7 +50,8 @@ class PartyDetails {
       $set: {
         name: this.party.name,
         description: this.party.description,
-        public: this.party.public
+        public: this.party.public,
+        location: this.party.location
       }
     }, (error) => {
       if (error) {
-- 
2.5.0


From 3bce797a11dc264d13b9193aed2ed8d18b235cfd Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 20:49:27 +0200
Subject: [PATCH 201/204] Step 16.11: Create view for PartiesMap

---
 imports/ui/components/partiesMap/partiesMap.html | 5 +++++
 1 file changed, 5 insertions(+)
 create mode 100644 imports/ui/components/partiesMap/partiesMap.html

diff --git a/imports/ui/components/partiesMap/partiesMap.html b/imports/ui/components/partiesMap/partiesMap.html
new file mode 100644
index 0000000..a488738
--- /dev/null
+++ b/imports/ui/components/partiesMap/partiesMap.html
@@ -0,0 +1,5 @@
+<div class="angular-google-map-container">
+  <ui-gmap-google-map center="partiesMap.map.center" zoom="partiesMap.map.zoom">
+    <ui-gmap-markers models="partiesMap.parties" coords="'location'" fit="true" idkey="'_id'" doRebuildAll="true"></ui-gmap-markers>
+  </ui-gmap-google-map>
+</div>
-- 
2.5.0


From 21c74e4b9c18bd159a4e114227cf48e7d72821d8 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 20:49:42 +0200
Subject: [PATCH 202/204] Step 16.12: Create component

---
 imports/ui/components/partiesMap/partiesMap.js | 37 ++++++++++++++++++++++++++
 1 file changed, 37 insertions(+)
 create mode 100644 imports/ui/components/partiesMap/partiesMap.js

diff --git a/imports/ui/components/partiesMap/partiesMap.js b/imports/ui/components/partiesMap/partiesMap.js
new file mode 100644
index 0000000..6759672
--- /dev/null
+++ b/imports/ui/components/partiesMap/partiesMap.js
@@ -0,0 +1,37 @@
+import angular from 'angular';
+import angularMeteor from 'angular-meteor';
+import 'angular-simple-logger';
+import 'angular-google-maps';
+
+import './partiesMap.html';
+
+/**
+ * PartiesMap component
+ */
+class PartiesMap {
+  constructor() {
+    this.map = {
+      center: {
+        latitude: 45,
+        longitude: -73
+      },
+      zoom: 8
+    };
+  }
+}
+
+const name = 'partiesMap';
+
+// create a module
+export default angular.module(name, [
+  angularMeteor,
+  'nemLogging', // https://github.com/angular-ui/angular-google-maps/issues/1633
+  'uiGmapgoogle-maps'
+]).component(name, {
+  templateUrl: `imports/ui/components/${name}/${name}.html`,
+  controllerAs: name,
+  bindings: {
+    parties: '='
+  },
+  controller: PartiesMap
+});
-- 
2.5.0


From 5ad1c4176b0ae0fa3d98ffa1a56da058e75a2971 Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 20:49:56 +0200
Subject: [PATCH 203/204] Step 16.13: Add as a dependency

---
 imports/ui/components/partiesList/partiesList.js | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/imports/ui/components/partiesList/partiesList.js b/imports/ui/components/partiesList/partiesList.js
index f139a7a..9a1811b 100644
--- a/imports/ui/components/partiesList/partiesList.js
+++ b/imports/ui/components/partiesList/partiesList.js
@@ -8,6 +8,7 @@ import { Counts } from 'meteor/tmeasday:publish-counts';
 import './partiesList.html';
 import { Parties } from '../../../api/parties';
 import { name as PartiesSort } from '../partiesSort/partiesSort';
+import { name as PartiesMap } from '../partiesMap/partiesMap';
 import { name as PartyAdd } from '../partyAdd/partyAdd';
 import { name as PartyRemove } from '../partyRemove/partyRemove';
 import { name as PartyCreator } from '../partyCreator/partyCreator';
@@ -76,6 +77,7 @@ export default angular.module(name, [
   uiRouter,
   utilsPagination,
   PartiesSort,
+  PartiesMap,
   PartyAdd,
   PartyRemove,
   PartyCreator,
-- 
2.5.0


From 66ce9d67d3db32f3d4dfaefea485b455462c360e Mon Sep 17 00:00:00 2001
From: Kamil Kisiela <kamil.kisiela@ster-project.pl>
Date: Thu, 7 Apr 2016 20:50:10 +0200
Subject: [PATCH 204/204] Step 16.14: Implement in the view

---
 imports/ui/components/partiesList/partiesList.html | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/imports/ui/components/partiesList/partiesList.html b/imports/ui/components/partiesList/partiesList.html
index c4cc2c1..a7984f6 100644
--- a/imports/ui/components/partiesList/partiesList.html
+++ b/imports/ui/components/partiesList/partiesList.html
@@ -31,3 +31,6 @@
 </ul>
 
 <dir-pagination-controls on-page-change="partiesList.pageChanged(newPageNumber)"></dir-pagination-controls>
+
+
+<parties-map parties="partiesList.parties"></parties-map>
-- 
2.5.0

